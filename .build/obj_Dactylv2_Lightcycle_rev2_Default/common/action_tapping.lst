   1               		.file	"action_tapping.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__tmp_reg__ = 0
   6               	__zero_reg__ = 1
   7               		.text
   8               	.Ltext0:
   9               		.cfi_sections	.debug_frame
  10               		.section	.text.debug_waiting_buffer,"ax",@progbits
  12               	debug_waiting_buffer:
  13               	.LFB12:
  14               		.file 1 "./tmk_core/common/action_tapping.c"
   1:./tmk_core/common/action_tapping.c **** #include <stdint.h>
   2:./tmk_core/common/action_tapping.c **** #include <stdbool.h>
   3:./tmk_core/common/action_tapping.c **** #include "action.h"
   4:./tmk_core/common/action_tapping.c **** #include "action_layer.h"
   5:./tmk_core/common/action_tapping.c **** #include "action_tapping.h"
   6:./tmk_core/common/action_tapping.c **** #include "keycode.h"
   7:./tmk_core/common/action_tapping.c **** #include "timer.h"
   8:./tmk_core/common/action_tapping.c **** 
   9:./tmk_core/common/action_tapping.c **** #ifdef DEBUG_ACTION
  10:./tmk_core/common/action_tapping.c **** #include "debug.h"
  11:./tmk_core/common/action_tapping.c **** #else
  12:./tmk_core/common/action_tapping.c **** #include "nodebug.h"
  13:./tmk_core/common/action_tapping.c **** #endif
  14:./tmk_core/common/action_tapping.c **** 
  15:./tmk_core/common/action_tapping.c **** #ifndef NO_ACTION_TAPPING
  16:./tmk_core/common/action_tapping.c **** 
  17:./tmk_core/common/action_tapping.c **** #define IS_TAPPING()            !IS_NOEVENT(tapping_key.event)
  18:./tmk_core/common/action_tapping.c **** #define IS_TAPPING_PRESSED()    (IS_TAPPING() && tapping_key.event.pressed)
  19:./tmk_core/common/action_tapping.c **** #define IS_TAPPING_RELEASED()   (IS_TAPPING() && !tapping_key.event.pressed)
  20:./tmk_core/common/action_tapping.c **** #define IS_TAPPING_KEY(k)       (IS_TAPPING() && KEYEQ(tapping_key.event.key, (k)))
  21:./tmk_core/common/action_tapping.c **** #define WITHIN_TAPPING_TERM(e)  (TIMER_DIFF_16(e.time, tapping_key.event.time) < TAPPING_TERM)
  22:./tmk_core/common/action_tapping.c **** 
  23:./tmk_core/common/action_tapping.c **** 
  24:./tmk_core/common/action_tapping.c **** static keyrecord_t tapping_key = {};
  25:./tmk_core/common/action_tapping.c **** static keyrecord_t waiting_buffer[WAITING_BUFFER_SIZE] = {};
  26:./tmk_core/common/action_tapping.c **** static uint8_t waiting_buffer_head = 0;
  27:./tmk_core/common/action_tapping.c **** static uint8_t waiting_buffer_tail = 0;
  28:./tmk_core/common/action_tapping.c **** 
  29:./tmk_core/common/action_tapping.c **** static bool process_tapping(keyrecord_t *record);
  30:./tmk_core/common/action_tapping.c **** static bool waiting_buffer_enq(keyrecord_t record);
  31:./tmk_core/common/action_tapping.c **** static void waiting_buffer_clear(void);
  32:./tmk_core/common/action_tapping.c **** static bool waiting_buffer_typed(keyevent_t event);
  33:./tmk_core/common/action_tapping.c **** static bool waiting_buffer_has_anykey_pressed(void);
  34:./tmk_core/common/action_tapping.c **** static void waiting_buffer_scan_tap(void);
  35:./tmk_core/common/action_tapping.c **** static void debug_tapping_key(void);
  36:./tmk_core/common/action_tapping.c **** static void debug_waiting_buffer(void);
  37:./tmk_core/common/action_tapping.c **** 
  38:./tmk_core/common/action_tapping.c **** 
  39:./tmk_core/common/action_tapping.c **** /** \brief Action Tapping Process
  40:./tmk_core/common/action_tapping.c ****  *
  41:./tmk_core/common/action_tapping.c ****  * FIXME: Needs doc
  42:./tmk_core/common/action_tapping.c ****  */
  43:./tmk_core/common/action_tapping.c **** void action_tapping_process(keyrecord_t record)
  44:./tmk_core/common/action_tapping.c **** {
  45:./tmk_core/common/action_tapping.c ****     if (process_tapping(&record)) {
  46:./tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
  47:./tmk_core/common/action_tapping.c ****             debug("processed: "); debug_record(record); debug("\n");
  48:./tmk_core/common/action_tapping.c ****         }
  49:./tmk_core/common/action_tapping.c ****     } else {
  50:./tmk_core/common/action_tapping.c ****         if (!waiting_buffer_enq(record)) {
  51:./tmk_core/common/action_tapping.c ****             // clear all in case of overflow.
  52:./tmk_core/common/action_tapping.c ****             debug("OVERFLOW: CLEAR ALL STATES\n");
  53:./tmk_core/common/action_tapping.c ****             clear_keyboard();
  54:./tmk_core/common/action_tapping.c ****             waiting_buffer_clear();
  55:./tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
  56:./tmk_core/common/action_tapping.c ****         }
  57:./tmk_core/common/action_tapping.c ****     }
  58:./tmk_core/common/action_tapping.c **** 
  59:./tmk_core/common/action_tapping.c ****     // process waiting_buffer
  60:./tmk_core/common/action_tapping.c ****     if (!IS_NOEVENT(record.event) && waiting_buffer_head != waiting_buffer_tail) {
  61:./tmk_core/common/action_tapping.c ****         debug("---- action_exec: process waiting_buffer -----\n");
  62:./tmk_core/common/action_tapping.c ****     }
  63:./tmk_core/common/action_tapping.c ****     for (; waiting_buffer_tail != waiting_buffer_head; waiting_buffer_tail = (waiting_buffer_tail +
  64:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
  65:./tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
  66:./tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
  67:./tmk_core/common/action_tapping.c ****         } else {
  68:./tmk_core/common/action_tapping.c ****             break;
  69:./tmk_core/common/action_tapping.c ****         }
  70:./tmk_core/common/action_tapping.c ****     }
  71:./tmk_core/common/action_tapping.c ****     if (!IS_NOEVENT(record.event)) {
  72:./tmk_core/common/action_tapping.c ****         debug("\n");
  73:./tmk_core/common/action_tapping.c ****     }
  74:./tmk_core/common/action_tapping.c **** }
  75:./tmk_core/common/action_tapping.c **** 
  76:./tmk_core/common/action_tapping.c **** 
  77:./tmk_core/common/action_tapping.c **** /** \brief Tapping
  78:./tmk_core/common/action_tapping.c ****  *
  79:./tmk_core/common/action_tapping.c ****  * Rule: Tap key is typed(pressed and released) within TAPPING_TERM.
  80:./tmk_core/common/action_tapping.c ****  *       (without interfering by typing other key)
  81:./tmk_core/common/action_tapping.c ****  */
  82:./tmk_core/common/action_tapping.c **** /* return true when key event is processed or consumed. */
  83:./tmk_core/common/action_tapping.c **** bool process_tapping(keyrecord_t *keyp)
  84:./tmk_core/common/action_tapping.c **** {
  85:./tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
  86:./tmk_core/common/action_tapping.c **** 
  87:./tmk_core/common/action_tapping.c ****     // if tapping
  88:./tmk_core/common/action_tapping.c ****     if (IS_TAPPING_PRESSED()) {
  89:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
  90:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
  91:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
  92:./tmk_core/common/action_tapping.c ****                     // first tap!
  93:./tmk_core/common/action_tapping.c ****                     debug("Tapping: First tap(0->1).\n");
  94:./tmk_core/common/action_tapping.c ****                     tapping_key.tap.count = 1;
  95:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
  96:./tmk_core/common/action_tapping.c ****                     process_record(&tapping_key);
  97:./tmk_core/common/action_tapping.c **** 
  98:./tmk_core/common/action_tapping.c ****                     // copy tapping state
  99:./tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 100:./tmk_core/common/action_tapping.c ****                     // enqueue
 101:./tmk_core/common/action_tapping.c ****                     return false;
 102:./tmk_core/common/action_tapping.c ****                 }
 103:./tmk_core/common/action_tapping.c **** #if TAPPING_TERM >= 500 || defined PERMISSIVE_HOLD
 104:./tmk_core/common/action_tapping.c ****                 /* Process a key typed within TAPPING_TERM
 105:./tmk_core/common/action_tapping.c ****                  * This can register the key before settlement of tapping,
 106:./tmk_core/common/action_tapping.c ****                  * useful for long TAPPING_TERM but may prevent fast typing.
 107:./tmk_core/common/action_tapping.c ****                  */
 108:./tmk_core/common/action_tapping.c ****                 else if (IS_RELEASED(event) && waiting_buffer_typed(event)) {
 109:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. No tap. Interfered by typing key\n");
 110:./tmk_core/common/action_tapping.c ****                     process_record(&tapping_key);
 111:./tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 112:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 113:./tmk_core/common/action_tapping.c ****                     // enqueue
 114:./tmk_core/common/action_tapping.c ****                     return false;
 115:./tmk_core/common/action_tapping.c ****                 }
 116:./tmk_core/common/action_tapping.c **** #endif
 117:./tmk_core/common/action_tapping.c ****                 /* Process release event of a key pressed before tapping starts
 118:./tmk_core/common/action_tapping.c ****                  * Without this unexpected repeating will occur with having fast repeating setting
 119:./tmk_core/common/action_tapping.c ****                  * https://github.com/tmk/tmk_keyboard/issues/60
 120:./tmk_core/common/action_tapping.c ****                  */
 121:./tmk_core/common/action_tapping.c ****                 else if (IS_RELEASED(event) && !waiting_buffer_typed(event)) {
 122:./tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 123:./tmk_core/common/action_tapping.c ****                     action_t action = layer_switch_get_action(event.key);
 124:./tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 125:./tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 126:./tmk_core/common/action_tapping.c ****                         case ACT_RMODS:
 127:./tmk_core/common/action_tapping.c ****                             if (action.key.mods && !action.key.code) return false;
 128:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 129:./tmk_core/common/action_tapping.c ****                             break;
 130:./tmk_core/common/action_tapping.c ****                         case ACT_LMODS_TAP:
 131:./tmk_core/common/action_tapping.c ****                         case ACT_RMODS_TAP:
 132:./tmk_core/common/action_tapping.c ****                             if (action.key.mods && keyp->tap.count == 0) return false;
 133:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 134:./tmk_core/common/action_tapping.c ****                             break;
 135:./tmk_core/common/action_tapping.c ****                     }
 136:./tmk_core/common/action_tapping.c ****                     // Release of key should be process immediately.
 137:./tmk_core/common/action_tapping.c ****                     debug("Tapping: release event of a key pressed before tapping\n");
 138:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 139:./tmk_core/common/action_tapping.c ****                     return true;
 140:./tmk_core/common/action_tapping.c ****                 }
 141:./tmk_core/common/action_tapping.c ****                 else {
 142:./tmk_core/common/action_tapping.c ****                     // set interrupted flag when other key preesed during tapping
 143:./tmk_core/common/action_tapping.c ****                     if (event.pressed) {
 144:./tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 145:./tmk_core/common/action_tapping.c ****                     }
 146:./tmk_core/common/action_tapping.c ****                     // enqueue
 147:./tmk_core/common/action_tapping.c ****                     return false;
 148:./tmk_core/common/action_tapping.c ****                 }
 149:./tmk_core/common/action_tapping.c ****             }
 150:./tmk_core/common/action_tapping.c ****             // tap_count > 0
 151:./tmk_core/common/action_tapping.c ****             else {
 152:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 153:./tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 154:./tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 155:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 156:./tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 157:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 158:./tmk_core/common/action_tapping.c ****                     return true;
 159:./tmk_core/common/action_tapping.c ****                 }
 160:./tmk_core/common/action_tapping.c ****                 else if (is_tap_key(event.key) && event.pressed) {
 161:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 162:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 163:./tmk_core/common/action_tapping.c ****                         // unregister key
 164:./tmk_core/common/action_tapping.c ****                         process_record(&(keyrecord_t){
 165:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 166:./tmk_core/common/action_tapping.c ****                                 .event.key = tapping_key.event.key,
 167:./tmk_core/common/action_tapping.c ****                                 .event.time = event.time,
 168:./tmk_core/common/action_tapping.c ****                                 .event.pressed = false
 169:./tmk_core/common/action_tapping.c ****                         });
 170:./tmk_core/common/action_tapping.c ****                     } else {
 171:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start while last tap(1).\n");
 172:./tmk_core/common/action_tapping.c ****                     }
 173:./tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 174:./tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 175:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 176:./tmk_core/common/action_tapping.c ****                     return true;
 177:./tmk_core/common/action_tapping.c ****                 }
 178:./tmk_core/common/action_tapping.c ****                 else {
 179:./tmk_core/common/action_tapping.c ****                     if (!IS_NOEVENT(event)) {
 180:./tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last tap(>0).\n");
 181:./tmk_core/common/action_tapping.c ****                     }
 182:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 183:./tmk_core/common/action_tapping.c ****                     return true;
 184:./tmk_core/common/action_tapping.c ****                 }
 185:./tmk_core/common/action_tapping.c ****             }
 186:./tmk_core/common/action_tapping.c ****         }
 187:./tmk_core/common/action_tapping.c ****         // after TAPPING_TERM
 188:./tmk_core/common/action_tapping.c ****         else {
 189:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 190:./tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 191:./tmk_core/common/action_tapping.c ****                 debug_event(event); debug("\n");
 192:./tmk_core/common/action_tapping.c ****                 process_record(&tapping_key);
 193:./tmk_core/common/action_tapping.c ****                 tapping_key = (keyrecord_t){};
 194:./tmk_core/common/action_tapping.c ****                 debug_tapping_key();
 195:./tmk_core/common/action_tapping.c ****                 return false;
 196:./tmk_core/common/action_tapping.c ****             }  else {
 197:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 198:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 199:./tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 200:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 201:./tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 202:./tmk_core/common/action_tapping.c ****                     return true;
 203:./tmk_core/common/action_tapping.c ****                 }
 204:./tmk_core/common/action_tapping.c ****                 else if (is_tap_key(event.key) && event.pressed) {
 205:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 206:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last timeout tap(>1).\n");
 207:./tmk_core/common/action_tapping.c ****                         // unregister key
 208:./tmk_core/common/action_tapping.c ****                         process_record(&(keyrecord_t){
 209:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 210:./tmk_core/common/action_tapping.c ****                                 .event.key = tapping_key.event.key,
 211:./tmk_core/common/action_tapping.c ****                                 .event.time = event.time,
 212:./tmk_core/common/action_tapping.c ****                                 .event.pressed = false
 213:./tmk_core/common/action_tapping.c ****                         });
 214:./tmk_core/common/action_tapping.c ****                     } else {
 215:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start while last timeout tap(1).\n");
 216:./tmk_core/common/action_tapping.c ****                     }
 217:./tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 218:./tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 219:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 220:./tmk_core/common/action_tapping.c ****                     return true;
 221:./tmk_core/common/action_tapping.c ****                 }
 222:./tmk_core/common/action_tapping.c ****                 else {
 223:./tmk_core/common/action_tapping.c ****                     if (!IS_NOEVENT(event)) {
 224:./tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last timeout tap(>0).\n");
 225:./tmk_core/common/action_tapping.c ****                     }
 226:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 227:./tmk_core/common/action_tapping.c ****                     return true;
 228:./tmk_core/common/action_tapping.c ****                 }
 229:./tmk_core/common/action_tapping.c ****             }
 230:./tmk_core/common/action_tapping.c ****         }
 231:./tmk_core/common/action_tapping.c ****     } else if (IS_TAPPING_RELEASED()) {
 232:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 233:./tmk_core/common/action_tapping.c ****             if (event.pressed) {
 234:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 235:./tmk_core/common/action_tapping.c **** #ifndef TAPPING_FORCE_HOLD
 236:./tmk_core/common/action_tapping.c ****                     if (!tapping_key.tap.interrupted && tapping_key.tap.count > 0) {
 237:./tmk_core/common/action_tapping.c ****                         // sequential tap.
 238:./tmk_core/common/action_tapping.c ****                         keyp->tap = tapping_key.tap;
 239:./tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 240:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 241:./tmk_core/common/action_tapping.c ****                         process_record(keyp);
 242:./tmk_core/common/action_tapping.c ****                         tapping_key = *keyp;
 243:./tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 244:./tmk_core/common/action_tapping.c ****                         return true;
 245:./tmk_core/common/action_tapping.c ****                     }
 246:./tmk_core/common/action_tapping.c **** #endif
 247:./tmk_core/common/action_tapping.c ****                     // FIX: start new tap again
 248:./tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 249:./tmk_core/common/action_tapping.c ****                     return true;
 250:./tmk_core/common/action_tapping.c ****                 } else if (is_tap_key(event.key)) {
 251:./tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 252:./tmk_core/common/action_tapping.c ****                     debug("Tapping: Start with interfering other tap.\n");
 253:./tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 254:./tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 255:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 256:./tmk_core/common/action_tapping.c ****                     return true;
 257:./tmk_core/common/action_tapping.c ****                 } else {
 258:./tmk_core/common/action_tapping.c ****                     // should none in buffer
 259:./tmk_core/common/action_tapping.c ****                     // FIX: interrupted when other key is pressed
 260:./tmk_core/common/action_tapping.c ****                     tapping_key.tap.interrupted = true;
 261:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 262:./tmk_core/common/action_tapping.c ****                     return true;
 263:./tmk_core/common/action_tapping.c ****                 }
 264:./tmk_core/common/action_tapping.c ****             } else {
 265:./tmk_core/common/action_tapping.c ****                 if (!IS_NOEVENT(event)) debug("Tapping: other key just after tap.\n");
 266:./tmk_core/common/action_tapping.c ****                 process_record(keyp);
 267:./tmk_core/common/action_tapping.c ****                 return true;
 268:./tmk_core/common/action_tapping.c ****             }
 269:./tmk_core/common/action_tapping.c ****         } else {
 270:./tmk_core/common/action_tapping.c ****             // FIX: process_action here?
 271:./tmk_core/common/action_tapping.c ****             // timeout. no sequential tap.
 272:./tmk_core/common/action_tapping.c ****             debug("Tapping: End(Timeout after releasing last tap): ");
 273:./tmk_core/common/action_tapping.c ****             debug_event(event); debug("\n");
 274:./tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 275:./tmk_core/common/action_tapping.c ****             debug_tapping_key();
 276:./tmk_core/common/action_tapping.c ****             return false;
 277:./tmk_core/common/action_tapping.c ****         }
 278:./tmk_core/common/action_tapping.c ****     }
 279:./tmk_core/common/action_tapping.c ****     // not tapping state
 280:./tmk_core/common/action_tapping.c ****     else {
 281:./tmk_core/common/action_tapping.c ****         if (event.pressed && is_tap_key(event.key)) {
 282:./tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 283:./tmk_core/common/action_tapping.c ****             tapping_key = *keyp;
 284:./tmk_core/common/action_tapping.c ****             process_record_tap_hint(&tapping_key);
 285:./tmk_core/common/action_tapping.c ****             waiting_buffer_scan_tap();
 286:./tmk_core/common/action_tapping.c ****             debug_tapping_key();
 287:./tmk_core/common/action_tapping.c ****             return true;
 288:./tmk_core/common/action_tapping.c ****         } else {
 289:./tmk_core/common/action_tapping.c ****             process_record(keyp);
 290:./tmk_core/common/action_tapping.c ****             return true;
 291:./tmk_core/common/action_tapping.c ****         }
 292:./tmk_core/common/action_tapping.c ****     }
 293:./tmk_core/common/action_tapping.c **** }
 294:./tmk_core/common/action_tapping.c **** 
 295:./tmk_core/common/action_tapping.c **** 
 296:./tmk_core/common/action_tapping.c **** /** \brief Waiting buffer enq
 297:./tmk_core/common/action_tapping.c ****  *
 298:./tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 299:./tmk_core/common/action_tapping.c ****  */
 300:./tmk_core/common/action_tapping.c **** bool waiting_buffer_enq(keyrecord_t record)
 301:./tmk_core/common/action_tapping.c **** {
 302:./tmk_core/common/action_tapping.c ****     if (IS_NOEVENT(record.event)) {
 303:./tmk_core/common/action_tapping.c ****         return true;
 304:./tmk_core/common/action_tapping.c ****     }
 305:./tmk_core/common/action_tapping.c **** 
 306:./tmk_core/common/action_tapping.c ****     if ((waiting_buffer_head + 1) % WAITING_BUFFER_SIZE == waiting_buffer_tail) {
 307:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 308:./tmk_core/common/action_tapping.c ****         return false;
 309:./tmk_core/common/action_tapping.c ****     }
 310:./tmk_core/common/action_tapping.c **** 
 311:./tmk_core/common/action_tapping.c ****     waiting_buffer[waiting_buffer_head] = record;
 312:./tmk_core/common/action_tapping.c ****     waiting_buffer_head = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 313:./tmk_core/common/action_tapping.c **** 
 314:./tmk_core/common/action_tapping.c ****     debug("waiting_buffer_enq: "); debug_waiting_buffer();
 315:./tmk_core/common/action_tapping.c ****     return true;
 316:./tmk_core/common/action_tapping.c **** }
 317:./tmk_core/common/action_tapping.c **** 
 318:./tmk_core/common/action_tapping.c **** /** \brief Waiting buffer clear
 319:./tmk_core/common/action_tapping.c ****  *
 320:./tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 321:./tmk_core/common/action_tapping.c ****  */
 322:./tmk_core/common/action_tapping.c **** void waiting_buffer_clear(void)
 323:./tmk_core/common/action_tapping.c **** {
 324:./tmk_core/common/action_tapping.c ****     waiting_buffer_head = 0;
 325:./tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 326:./tmk_core/common/action_tapping.c **** }
 327:./tmk_core/common/action_tapping.c **** 
 328:./tmk_core/common/action_tapping.c **** /** \brief Waiting buffer typed
 329:./tmk_core/common/action_tapping.c ****  *
 330:./tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 331:./tmk_core/common/action_tapping.c ****  */
 332:./tmk_core/common/action_tapping.c **** bool waiting_buffer_typed(keyevent_t event)
 333:./tmk_core/common/action_tapping.c **** {
 334:./tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 335:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 336:./tmk_core/common/action_tapping.c ****             return true;
 337:./tmk_core/common/action_tapping.c ****         }
 338:./tmk_core/common/action_tapping.c ****     }
 339:./tmk_core/common/action_tapping.c ****     return false;
 340:./tmk_core/common/action_tapping.c **** }
 341:./tmk_core/common/action_tapping.c **** 
 342:./tmk_core/common/action_tapping.c **** /** \brief Waiting buffer has anykey pressed
 343:./tmk_core/common/action_tapping.c ****  *
 344:./tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 345:./tmk_core/common/action_tapping.c ****  */
 346:./tmk_core/common/action_tapping.c **** __attribute__((unused))
 347:./tmk_core/common/action_tapping.c **** bool waiting_buffer_has_anykey_pressed(void)
 348:./tmk_core/common/action_tapping.c **** {
 349:./tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 350:./tmk_core/common/action_tapping.c ****         if (waiting_buffer[i].event.pressed) return true;
 351:./tmk_core/common/action_tapping.c ****     }
 352:./tmk_core/common/action_tapping.c ****     return false;
 353:./tmk_core/common/action_tapping.c **** }
 354:./tmk_core/common/action_tapping.c **** 
 355:./tmk_core/common/action_tapping.c **** /** \brief Scan buffer for tapping
 356:./tmk_core/common/action_tapping.c ****  *
 357:./tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 358:./tmk_core/common/action_tapping.c ****  */
 359:./tmk_core/common/action_tapping.c **** void waiting_buffer_scan_tap(void)
 360:./tmk_core/common/action_tapping.c **** {
 361:./tmk_core/common/action_tapping.c ****     // tapping already is settled
 362:./tmk_core/common/action_tapping.c ****     if (tapping_key.tap.count > 0) return;
 363:./tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 364:./tmk_core/common/action_tapping.c ****     if (!tapping_key.event.pressed) return;
 365:./tmk_core/common/action_tapping.c **** 
 366:./tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 367:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 368:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 369:./tmk_core/common/action_tapping.c ****                 WITHIN_TAPPING_TERM(waiting_buffer[i].event)) {
 370:./tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 371:./tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 372:./tmk_core/common/action_tapping.c ****             process_record(&tapping_key);
 373:./tmk_core/common/action_tapping.c **** 
 374:./tmk_core/common/action_tapping.c ****             debug("waiting_buffer_scan_tap: found at ["); debug_dec(i); debug("]\n");
 375:./tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 376:./tmk_core/common/action_tapping.c ****             return;
 377:./tmk_core/common/action_tapping.c ****         }
 378:./tmk_core/common/action_tapping.c ****     }
 379:./tmk_core/common/action_tapping.c **** }
 380:./tmk_core/common/action_tapping.c **** 
 381:./tmk_core/common/action_tapping.c **** 
 382:./tmk_core/common/action_tapping.c **** /** \brief Tapping key debug print
 383:./tmk_core/common/action_tapping.c ****  *
 384:./tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 385:./tmk_core/common/action_tapping.c ****  */
 386:./tmk_core/common/action_tapping.c **** static void debug_tapping_key(void)
 387:./tmk_core/common/action_tapping.c **** {
 388:./tmk_core/common/action_tapping.c ****     debug("TAPPING_KEY="); debug_record(tapping_key); debug("\n");
 389:./tmk_core/common/action_tapping.c **** }
 390:./tmk_core/common/action_tapping.c **** 
 391:./tmk_core/common/action_tapping.c **** /** \brief Waiting buffer debug print
 392:./tmk_core/common/action_tapping.c ****  *
 393:./tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 394:./tmk_core/common/action_tapping.c ****  */
 395:./tmk_core/common/action_tapping.c **** static void debug_waiting_buffer(void)
 396:./tmk_core/common/action_tapping.c **** {
  15               		.loc 1 396 1 view -0
  16               		.cfi_startproc
  17 0000 1F93      		push r17
  18               	.LCFI0:
  19               		.cfi_def_cfa_offset 3
  20               		.cfi_offset 17, -2
  21 0002 CF93      		push r28
  22               	.LCFI1:
  23               		.cfi_def_cfa_offset 4
  24               		.cfi_offset 28, -3
  25 0004 DF93      		push r29
  26               	.LCFI2:
  27               		.cfi_def_cfa_offset 5
  28               		.cfi_offset 29, -4
  29               	/* prologue: function */
  30               	/* frame size = 0 */
  31               	/* stack size = 3 */
  32               	.L__stack_usage = 3
 397:./tmk_core/common/action_tapping.c ****     debug("{ ");
  33               		.loc 1 397 16 view .LVU1
 398:./tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
  34               		.loc 1 398 5 view .LVU2
  35               	.LBB3:
  36               		.loc 1 398 10 view .LVU3
  37               		.loc 1 398 18 is_stmt 0 view .LVU4
  38 0006 C091 0000 		lds r28,waiting_buffer_tail
  39               	.LVL0:
 399:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  40               		.loc 1 399 48 view .LVU5
  41 000a 16E0      		ldi r17,lo8(6)
  42               	.LVL1:
  43               	.L2:
 398:./tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
  44               		.loc 1 398 5 discriminator 1 view .LVU6
  45 000c 8091 0000 		lds r24,waiting_buffer_head
  46 0010 8C13      		cpse r24,r28
  47 0012 00C0      		rjmp .L3
  48               	/* epilogue start */
  49               	.LBE3:
 400:./tmk_core/common/action_tapping.c ****     }
 401:./tmk_core/common/action_tapping.c ****     debug("}\n");
 402:./tmk_core/common/action_tapping.c **** }
  50               		.loc 1 402 1 view .LVU7
  51 0014 DF91      		pop r29
  52 0016 CF91      		pop r28
  53               	.LVL2:
  54               		.loc 1 402 1 view .LVU8
  55 0018 1F91      		pop r17
  56 001a 0895      		ret
  57               	.LVL3:
  58               	.L3:
  59               	.LBB4:
 399:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  60               		.loc 1 399 19 is_stmt 1 discriminator 3 view .LVU9
 399:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  61               		.loc 1 399 33 discriminator 3 view .LVU10
 399:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  62               		.loc 1 399 46 discriminator 3 view .LVU11
 399:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  63               		.loc 1 399 48 discriminator 3 view .LVU12
  64 001c D0E0      		ldi r29,0
  65 001e 1C9F      		mul r17,r28
  66 0020 F001      		movw r30,r0
  67 0022 1D9F      		mul r17,r29
  68 0024 F00D      		add r31,r0
  69 0026 1124      		clr __zero_reg__
  70 0028 E050      		subi r30,lo8(-(waiting_buffer))
  71 002a F040      		sbci r31,hi8(-(waiting_buffer))
  72 002c 4081      		ld r20,Z
  73 002e 5181      		ldd r21,Z+1
  74 0030 6281      		ldd r22,Z+2
  75 0032 7381      		ldd r23,Z+3
  76 0034 8481      		ldd r24,Z+4
  77 0036 9581      		ldd r25,Z+5
  78 0038 0E94 0000 		call debug_record
  79               	.LVL4:
 399:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  80               		.loc 1 399 91 discriminator 3 view .LVU13
 398:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  81               		.loc 1 398 76 is_stmt 0 discriminator 3 view .LVU14
  82 003c 2196      		adiw r28,1
  83               	.LVL5:
 398:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  84               		.loc 1 398 71 discriminator 3 view .LVU15
  85 003e C770      		andi r28,lo8(7)
 398:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  86               		.loc 1 398 71 discriminator 3 view .LVU16
  87 0040 00C0      		rjmp .L2
  88               	.LBE4:
  89               		.cfi_endproc
  90               	.LFE12:
  92               		.section	.text.debug_tapping_key,"ax",@progbits
  94               	debug_tapping_key:
  95               	.LFB11:
 387:./tmk_core/common/action_tapping.c ****     debug("TAPPING_KEY="); debug_record(tapping_key); debug("\n");
  96               		.loc 1 387 1 is_stmt 1 view -0
  97               		.cfi_startproc
  98               	/* prologue: function */
  99               	/* frame size = 0 */
 100               	/* stack size = 0 */
 101               	.L__stack_usage = 0
 388:./tmk_core/common/action_tapping.c **** }
 102               		.loc 1 388 26 view .LVU18
 388:./tmk_core/common/action_tapping.c **** }
 103               		.loc 1 388 28 view .LVU19
 104 0000 4091 0000 		lds r20,tapping_key
 105 0004 5091 0000 		lds r21,tapping_key+1
 106 0008 6091 0000 		lds r22,tapping_key+2
 107 000c 7091 0000 		lds r23,tapping_key+3
 108 0010 8091 0000 		lds r24,tapping_key+4
 109 0014 9091 0000 		lds r25,tapping_key+5
 110 0018 0C94 0000 		jmp debug_record
 111               	.LVL6:
 112               		.cfi_endproc
 113               	.LFE11:
 115               		.section	.text.waiting_buffer_typed.isra.1,"ax",@progbits
 117               	waiting_buffer_typed.isra.1:
 118               	.LFB14:
 332:./tmk_core/common/action_tapping.c **** {
 119               		.loc 1 332 6 view -0
 120               		.cfi_startproc
 121               	/* prologue: function */
 122               	/* frame size = 0 */
 123               	/* stack size = 0 */
 124               	.L__stack_usage = 0
 334:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 125               		.loc 1 334 5 view .LVU21
 126               	.LBB5:
 334:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 127               		.loc 1 334 10 view .LVU22
 334:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 128               		.loc 1 334 18 is_stmt 0 view .LVU23
 129 0000 2091 0000 		lds r18,waiting_buffer_tail
 130               	.LVL7:
 334:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 131               		.loc 1 334 45 view .LVU24
 132 0004 9091 0000 		lds r25,waiting_buffer_head
 335:./tmk_core/common/action_tapping.c ****             return true;
 133               		.loc 1 335 13 view .LVU25
 134 0008 56E0      		ldi r21,lo8(6)
 135               	.LVL8:
 136               	.L6:
 334:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 137               		.loc 1 334 5 view .LVU26
 138 000a 2913      		cpse r18,r25
 139 000c 00C0      		rjmp .L9
 140               	.LBE5:
 339:./tmk_core/common/action_tapping.c **** }
 141               		.loc 1 339 12 view .LVU27
 142 000e 80E0      		ldi r24,0
 143 0010 0895      		ret
 144               	.L9:
 145               	.LBB6:
 335:./tmk_core/common/action_tapping.c ****             return true;
 146               		.loc 1 335 9 is_stmt 1 view .LVU28
 335:./tmk_core/common/action_tapping.c ****             return true;
 147               		.loc 1 335 13 is_stmt 0 view .LVU29
 148 0012 30E0      		ldi r19,0
 149 0014 529F      		mul r21,r18
 150 0016 F001      		movw r30,r0
 151 0018 539F      		mul r21,r19
 152 001a F00D      		add r31,r0
 153 001c 1124      		clr __zero_reg__
 154 001e E050      		subi r30,lo8(-(waiting_buffer))
 155 0020 F040      		sbci r31,hi8(-(waiting_buffer))
 335:./tmk_core/common/action_tapping.c ****             return true;
 156               		.loc 1 335 12 view .LVU30
 157 0022 7181      		ldd r23,Z+1
 158 0024 7613      		cpse r23,r22
 159 0026 00C0      		rjmp .L7
 335:./tmk_core/common/action_tapping.c ****             return true;
 160               		.loc 1 335 13 view .LVU31
 161 0028 7081      		ld r23,Z
 162 002a 7813      		cpse r23,r24
 163 002c 00C0      		rjmp .L7
 335:./tmk_core/common/action_tapping.c ****             return true;
 164               		.loc 1 335 59 view .LVU32
 165 002e 7281      		ldd r23,Z+2
 166 0030 7413      		cpse r23,r20
 167 0032 00C0      		rjmp .L10
 168               	.L7:
 334:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 169               		.loc 1 334 76 view .LVU33
 170 0034 2F5F      		subi r18,-1
 171 0036 3F4F      		sbci r19,-1
 172               	.LVL9:
 334:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 173               		.loc 1 334 71 view .LVU34
 174 0038 2770      		andi r18,lo8(7)
 334:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 175               		.loc 1 334 71 view .LVU35
 176 003a 00C0      		rjmp .L6
 177               	.LVL10:
 178               	.L10:
 336:./tmk_core/common/action_tapping.c ****         }
 179               		.loc 1 336 20 view .LVU36
 180 003c 81E0      		ldi r24,lo8(1)
 181               	/* epilogue start */
 182               	.LBE6:
 340:./tmk_core/common/action_tapping.c **** 
 183               		.loc 1 340 1 view .LVU37
 184 003e 0895      		ret
 185               		.cfi_endproc
 186               	.LFE14:
 188               		.section	.text.waiting_buffer_scan_tap,"ax",@progbits
 190               	waiting_buffer_scan_tap:
 191               	.LFB10:
 360:./tmk_core/common/action_tapping.c ****     // tapping already is settled
 192               		.loc 1 360 1 is_stmt 1 view -0
 193               		.cfi_startproc
 194 0000 1F93      		push r17
 195               	.LCFI3:
 196               		.cfi_def_cfa_offset 3
 197               		.cfi_offset 17, -2
 198 0002 CF93      		push r28
 199               	.LCFI4:
 200               		.cfi_def_cfa_offset 4
 201               		.cfi_offset 28, -3
 202 0004 DF93      		push r29
 203               	.LCFI5:
 204               		.cfi_def_cfa_offset 5
 205               		.cfi_offset 29, -4
 206               	/* prologue: function */
 207               	/* frame size = 0 */
 208               	/* stack size = 3 */
 209               	.L__stack_usage = 3
 362:./tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 210               		.loc 1 362 5 view .LVU39
 362:./tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 211               		.loc 1 362 31 is_stmt 0 view .LVU40
 212 0006 8091 0000 		lds r24,tapping_key+5
 213 000a 807F      		andi r24,lo8(-16)
 362:./tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 214               		.loc 1 362 8 view .LVU41
 215 000c 01F4      		brne .L11
 364:./tmk_core/common/action_tapping.c **** 
 216               		.loc 1 364 5 is_stmt 1 view .LVU42
 364:./tmk_core/common/action_tapping.c **** 
 217               		.loc 1 364 8 is_stmt 0 view .LVU43
 218 000e 8091 0000 		lds r24,tapping_key+2
 219 0012 8823      		tst r24
 220 0014 01F0      		breq .L11
 366:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 221               		.loc 1 366 5 is_stmt 1 view .LVU44
 222               	.LBB10:
 366:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 223               		.loc 1 366 10 view .LVU45
 366:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 224               		.loc 1 366 18 is_stmt 0 view .LVU46
 225 0016 8091 0000 		lds r24,waiting_buffer_tail
 226               	.LVL11:
 366:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 227               		.loc 1 366 45 view .LVU47
 228 001a C091 0000 		lds r28,waiting_buffer_head
 367:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 229               		.loc 1 367 13 view .LVU48
 230 001e 6091 0000 		lds r22,tapping_key
 231 0022 7091 0000 		lds r23,tapping_key+1
 232 0026 4091 0000 		lds r20,tapping_key+3
 233 002a 5091 0000 		lds r21,tapping_key+3+1
 234 002e D62F      		mov r29,r22
 235 0030 D723      		and r29,r23
 236 0032 DA01      		movw r26,r20
 237 0034 A095      		com r26
 238 0036 B095      		com r27
 239 0038 16E0      		ldi r17,lo8(6)
 240               	.LVL12:
 241               	.L13:
 366:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 242               		.loc 1 366 5 discriminator 1 view .LVU49
 243 003a C813      		cpse r28,r24
 244 003c 00C0      		rjmp .L20
 245               	.LVL13:
 246               	.L11:
 247               	/* epilogue start */
 366:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 248               		.loc 1 366 5 discriminator 1 view .LVU50
 249               	.LBE10:
 379:./tmk_core/common/action_tapping.c **** 
 250               		.loc 1 379 1 view .LVU51
 251 003e DF91      		pop r29
 252 0040 CF91      		pop r28
 253 0042 1F91      		pop r17
 254 0044 0895      		ret
 255               	.LVL14:
 256               	.L20:
 257               	.LBB13:
 367:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 258               		.loc 1 367 9 is_stmt 1 view .LVU52
 259               	.LBB11:
 260               	.LBI11:
 261               		.file 2 "./tmk_core/common/keyboard.h"
   1:./tmk_core/common/keyboard.h **** /*
   2:./tmk_core/common/keyboard.h **** Copyright 2011,2012,2013 Jun Wako <wakojun@gmail.com>
   3:./tmk_core/common/keyboard.h **** 
   4:./tmk_core/common/keyboard.h **** This program is free software: you can redistribute it and/or modify
   5:./tmk_core/common/keyboard.h **** it under the terms of the GNU General Public License as published by
   6:./tmk_core/common/keyboard.h **** the Free Software Foundation, either version 2 of the License, or
   7:./tmk_core/common/keyboard.h **** (at your option) any later version.
   8:./tmk_core/common/keyboard.h **** 
   9:./tmk_core/common/keyboard.h **** This program is distributed in the hope that it will be useful,
  10:./tmk_core/common/keyboard.h **** but WITHOUT ANY WARRANTY; without even the implied warranty of
  11:./tmk_core/common/keyboard.h **** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  12:./tmk_core/common/keyboard.h **** GNU General Public License for more details.
  13:./tmk_core/common/keyboard.h **** 
  14:./tmk_core/common/keyboard.h **** You should have received a copy of the GNU General Public License
  15:./tmk_core/common/keyboard.h **** along with this program.  If not, see <http://www.gnu.org/licenses/>.
  16:./tmk_core/common/keyboard.h **** */
  17:./tmk_core/common/keyboard.h **** 
  18:./tmk_core/common/keyboard.h **** #ifndef KEYBOARD_H
  19:./tmk_core/common/keyboard.h **** #define KEYBOARD_H
  20:./tmk_core/common/keyboard.h **** 
  21:./tmk_core/common/keyboard.h **** #include <stdbool.h>
  22:./tmk_core/common/keyboard.h **** #include <stdint.h>
  23:./tmk_core/common/keyboard.h **** 
  24:./tmk_core/common/keyboard.h **** 
  25:./tmk_core/common/keyboard.h **** #ifdef __cplusplus
  26:./tmk_core/common/keyboard.h **** extern "C" {
  27:./tmk_core/common/keyboard.h **** #endif
  28:./tmk_core/common/keyboard.h **** 
  29:./tmk_core/common/keyboard.h **** /* key matrix position */
  30:./tmk_core/common/keyboard.h **** typedef struct {
  31:./tmk_core/common/keyboard.h ****     uint8_t col;
  32:./tmk_core/common/keyboard.h ****     uint8_t row;
  33:./tmk_core/common/keyboard.h **** } keypos_t;
  34:./tmk_core/common/keyboard.h **** 
  35:./tmk_core/common/keyboard.h **** /* key event */
  36:./tmk_core/common/keyboard.h **** typedef struct {
  37:./tmk_core/common/keyboard.h ****     keypos_t key;
  38:./tmk_core/common/keyboard.h ****     bool     pressed;
  39:./tmk_core/common/keyboard.h ****     uint16_t time;
  40:./tmk_core/common/keyboard.h **** } keyevent_t;
  41:./tmk_core/common/keyboard.h **** 
  42:./tmk_core/common/keyboard.h **** /* equivalent test of keypos_t */
  43:./tmk_core/common/keyboard.h **** #define KEYEQ(keya, keyb)       ((keya).row == (keyb).row && (keya).col == (keyb).col)
  44:./tmk_core/common/keyboard.h **** 
  45:./tmk_core/common/keyboard.h **** /* Rules for No Event:
  46:./tmk_core/common/keyboard.h ****  * 1) (time == 0) to handle (keyevent_t){} as empty event
  47:./tmk_core/common/keyboard.h ****  * 2) Matrix(255, 255) to make TICK event available
  48:./tmk_core/common/keyboard.h ****  */
  49:./tmk_core/common/keyboard.h **** static inline bool IS_NOEVENT(keyevent_t event) { return event.time == 0 || (event.key.row == 255 &
 262               		.loc 2 49 20 view .LVU53
 263               	.LBB12:
 264               		.loc 2 49 51 view .LVU54
 265 0046 90E0      		ldi r25,0
 266               		.loc 2 49 74 is_stmt 0 view .LVU55
 267 0048 4115      		cp r20,__zero_reg__
 268 004a 5105      		cpc r21,__zero_reg__
 269 004c 01F0      		breq .L14
 270 004e DF3F      		cpi r29,lo8(-1)
 271 0050 01F4      		brne .L33
 272               	.L14:
 273               	.LBE12:
 274               	.LBE11:
 366:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 275               		.loc 1 366 76 discriminator 2 view .LVU56
 276 0052 0196      		adiw r24,1
 277               	.LVL15:
 366:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 278               		.loc 1 366 71 discriminator 2 view .LVU57
 279 0054 8770      		andi r24,lo8(7)
 366:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 280               		.loc 1 366 71 discriminator 2 view .LVU58
 281 0056 00C0      		rjmp .L13
 282               	.LVL16:
 283               	.L16:
 369:./tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 284               		.loc 1 369 17 discriminator 2 view .LVU59
 285 0058 2A0F      		add r18,r26
 286 005a 3B1F      		adc r19,r27
 287 005c 00C0      		rjmp .L34
 288               	.L33:
 367:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 289               		.loc 1 367 13 view .LVU60
 290 005e 189F      		mul r17,r24
 291 0060 F001      		movw r30,r0
 292 0062 199F      		mul r17,r25
 293 0064 F00D      		add r31,r0
 294 0066 1124      		clr __zero_reg__
 295 0068 E050      		subi r30,lo8(-(waiting_buffer))
 296 006a F040      		sbci r31,hi8(-(waiting_buffer))
 297 006c 2181      		ldd r18,Z+1
 298 006e 2713      		cpse r18,r23
 299 0070 00C0      		rjmp .L14
 367:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 300               		.loc 1 367 13 discriminator 2 view .LVU61
 301 0072 2081      		ld r18,Z
 302 0074 2613      		cpse r18,r22
 303 0076 00C0      		rjmp .L14
 367:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 304               		.loc 1 367 57 discriminator 3 view .LVU62
 305 0078 2281      		ldd r18,Z+2
 306 007a 2111      		cpse r18,__zero_reg__
 307 007c 00C0      		rjmp .L14
 369:./tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 308               		.loc 1 369 17 view .LVU63
 309 007e 2381      		ldd r18,Z+3
 310 0080 3481      		ldd r19,Z+4
 311 0082 2417      		cp r18,r20
 312 0084 3507      		cpc r19,r21
 313 0086 00F0      		brlo .L16
 369:./tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 314               		.loc 1 369 17 discriminator 1 view .LVU64
 315 0088 241B      		sub r18,r20
 316 008a 350B      		sbc r19,r21
 317               	.L34:
 369:./tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 318               		.loc 1 369 17 discriminator 2 view .LVU65
 319 008c 2639      		cpi r18,-106
 320 008e 3105      		cpc r19,__zero_reg__
 321 0090 00F4      		brsh .L14
 370:./tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 322               		.loc 1 370 13 is_stmt 1 view .LVU66
 370:./tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 323               		.loc 1 370 35 is_stmt 0 view .LVU67
 324 0092 2091 0000 		lds r18,tapping_key+5
 325 0096 2F70      		andi r18,lo8(15)
 326 0098 2061      		ori r18,lo8(16)
 327 009a 2093 0000 		sts tapping_key+5,r18
 371:./tmk_core/common/action_tapping.c ****             process_record(&tapping_key);
 328               		.loc 1 371 13 is_stmt 1 view .LVU68
 371:./tmk_core/common/action_tapping.c ****             process_record(&tapping_key);
 329               		.loc 1 371 41 is_stmt 0 view .LVU69
 330 009e 26E0      		ldi r18,lo8(6)
 331 00a0 289F      		mul r18,r24
 332 00a2 F001      		movw r30,r0
 333 00a4 299F      		mul r18,r25
 334 00a6 F00D      		add r31,r0
 335 00a8 1124      		clr __zero_reg__
 336 00aa E050      		subi r30,lo8(-(waiting_buffer+5))
 337 00ac F040      		sbci r31,hi8(-(waiting_buffer+5))
 338 00ae 8081      		ld r24,Z
 339               	.LVL17:
 371:./tmk_core/common/action_tapping.c ****             process_record(&tapping_key);
 340               		.loc 1 371 41 view .LVU70
 341 00b0 8F70      		andi r24,lo8(15)
 342 00b2 8061      		ori r24,lo8(16)
 343 00b4 8083      		st Z,r24
 372:./tmk_core/common/action_tapping.c **** 
 344               		.loc 1 372 13 is_stmt 1 view .LVU71
 345 00b6 80E0      		ldi r24,lo8(tapping_key)
 346 00b8 90E0      		ldi r25,hi8(tapping_key)
 347 00ba 0E94 0000 		call process_record
 348               	.LVL18:
 374:./tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 349               		.loc 1 374 57 view .LVU72
 374:./tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 350               		.loc 1 374 71 view .LVU73
 374:./tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 351               		.loc 1 374 85 view .LVU74
 375:./tmk_core/common/action_tapping.c ****             return;
 352               		.loc 1 375 13 view .LVU75
 353               	/* epilogue start */
 354               	.LBE13:
 379:./tmk_core/common/action_tapping.c **** 
 355               		.loc 1 379 1 is_stmt 0 view .LVU76
 356 00be DF91      		pop r29
 357 00c0 CF91      		pop r28
 358 00c2 1F91      		pop r17
 359               	.LBB14:
 375:./tmk_core/common/action_tapping.c ****             return;
 360               		.loc 1 375 13 view .LVU77
 361 00c4 0C94 0000 		jmp debug_waiting_buffer
 362               	.LVL19:
 363               	.LBE14:
 364               		.cfi_endproc
 365               	.LFE10:
 367               		.section	.text.process_tapping,"ax",@progbits
 369               	process_tapping:
 370               	.LVL20:
 371               	.LFB5:
  84:./tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
 372               		.loc 1 84 1 is_stmt 1 view -0
 373               		.cfi_startproc
  84:./tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
 374               		.loc 1 84 1 is_stmt 0 view .LVU79
 375 0000 9F92      		push r9
 376               	.LCFI6:
 377               		.cfi_def_cfa_offset 3
 378               		.cfi_offset 9, -2
 379 0002 AF92      		push r10
 380               	.LCFI7:
 381               		.cfi_def_cfa_offset 4
 382               		.cfi_offset 10, -3
 383 0004 BF92      		push r11
 384               	.LCFI8:
 385               		.cfi_def_cfa_offset 5
 386               		.cfi_offset 11, -4
 387 0006 CF92      		push r12
 388               	.LCFI9:
 389               		.cfi_def_cfa_offset 6
 390               		.cfi_offset 12, -5
 391 0008 DF92      		push r13
 392               	.LCFI10:
 393               		.cfi_def_cfa_offset 7
 394               		.cfi_offset 13, -6
 395 000a EF92      		push r14
 396               	.LCFI11:
 397               		.cfi_def_cfa_offset 8
 398               		.cfi_offset 14, -7
 399 000c FF92      		push r15
 400               	.LCFI12:
 401               		.cfi_def_cfa_offset 9
 402               		.cfi_offset 15, -8
 403 000e 0F93      		push r16
 404               	.LCFI13:
 405               		.cfi_def_cfa_offset 10
 406               		.cfi_offset 16, -9
 407 0010 1F93      		push r17
 408               	.LCFI14:
 409               		.cfi_def_cfa_offset 11
 410               		.cfi_offset 17, -10
 411 0012 CF93      		push r28
 412               	.LCFI15:
 413               		.cfi_def_cfa_offset 12
 414               		.cfi_offset 28, -11
 415 0014 DF93      		push r29
 416               	.LCFI16:
 417               		.cfi_def_cfa_offset 13
 418               		.cfi_offset 29, -12
 419 0016 CDB7      		in r28,__SP_L__
 420 0018 DEB7      		in r29,__SP_H__
 421               	.LCFI17:
 422               		.cfi_def_cfa_register 28
 423 001a 6197      		sbiw r28,17
 424               	.LCFI18:
 425               		.cfi_def_cfa_offset 30
 426 001c 0FB6      		in __tmp_reg__,__SREG__
 427 001e F894      		cli
 428 0020 DEBF      		out __SP_H__,r29
 429 0022 0FBE      		out __SREG__,__tmp_reg__
 430 0024 CDBF      		out __SP_L__,r28
 431               	/* prologue: function */
 432               	/* frame size = 17 */
 433               	/* stack size = 28 */
 434               	.L__stack_usage = 28
 435 0026 8C01      		movw r16,r24
  85:./tmk_core/common/action_tapping.c **** 
 436               		.loc 1 85 5 is_stmt 1 view .LVU80
  85:./tmk_core/common/action_tapping.c **** 
 437               		.loc 1 85 16 is_stmt 0 view .LVU81
 438 0028 85E0      		ldi r24,lo8(5)
 439               	.LVL21:
  85:./tmk_core/common/action_tapping.c **** 
 440               		.loc 1 85 16 view .LVU82
 441 002a F801      		movw r30,r16
 442 002c DE01      		movw r26,r28
 443 002e 1D96      		adiw r26,13
 444               		0:
 445 0030 0190      		ld r0,Z+
 446 0032 0D92      		st X+,r0
 447 0034 8A95      		dec r24
 448 0036 01F4      		brne 0b
 449 0038 D801      		movw r26,r16
 450 003a DC90      		ld r13,X
 451               	.LVL22:
  85:./tmk_core/common/action_tapping.c **** 
 452               		.loc 1 85 16 view .LVU83
 453 003c 1196      		adiw r26,1
 454 003e EC90      		ld r14,X
 455 0040 1197      		sbiw r26,1
 456               	.LVL23:
  85:./tmk_core/common/action_tapping.c **** 
 457               		.loc 1 85 16 view .LVU84
 458 0042 1296      		adiw r26,2
 459 0044 CC90      		ld r12,X
 460 0046 1297      		sbiw r26,2
 461               	.LVL24:
  88:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 462               		.loc 1 88 5 is_stmt 1 view .LVU85
  88:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 463               		.loc 1 88 9 is_stmt 0 view .LVU86
 464 0048 8091 0000 		lds r24,tapping_key+3
 465 004c 9091 0000 		lds r25,tapping_key+3+1
 466               	.LBB26:
 467               	.LBI26:
 468               		.loc 2 49 20 is_stmt 1 view .LVU87
 469               	.LBB27:
 470               		.loc 2 49 51 view .LVU88
 471               		.loc 2 49 74 is_stmt 0 view .LVU89
 472 0050 0097      		sbiw r24,0
 473 0052 01F4      		brne .+2
 474 0054 00C0      		rjmp .L36
 475               	.LBE27:
 476               	.LBE26:
  88:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 477               		.loc 1 88 9 view .LVU90
 478 0056 2091 0000 		lds r18,tapping_key
 479 005a 3091 0000 		lds r19,tapping_key+1
 480               	.LBB29:
 481               	.LBB28:
 482               		.loc 2 49 74 view .LVU91
 483 005e 422F      		mov r20,r18
 484 0060 4323      		and r20,r19
 485 0062 4F3F      		cpi r20,lo8(-1)
 486 0064 01F4      		brne .+2
 487 0066 00C0      		rjmp .L36
 488               	.LBE28:
 489               	.LBE29:
  85:./tmk_core/common/action_tapping.c **** 
 490               		.loc 1 85 16 discriminator 1 view .LVU92
 491 0068 1396      		adiw r26,3
 492 006a AD90      		ld r10,X+
 493 006c BC90      		ld r11,X
  88:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 494               		.loc 1 88 9 discriminator 1 view .LVU93
 495 006e 9090 0000 		lds r9,tapping_key+2
 496 0072 9920      		tst r9
 497 0074 01F4      		brne .+2
 498 0076 00C0      		rjmp .L37
  89:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 499               		.loc 1 89 9 is_stmt 1 view .LVU94
  89:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 500               		.loc 1 89 13 is_stmt 0 view .LVU95
 501 0078 A816      		cp r10,r24
 502 007a B906      		cpc r11,r25
 503 007c 00F0      		brlo .L38
  89:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 504               		.loc 1 89 13 discriminator 1 view .LVU96
 505 007e F501      		movw r30,r10
 506 0080 E81B      		sub r30,r24
 507 0082 F90B      		sbc r31,r25
 508 0084 CF01      		movw r24,r30
 509               	.L136:
  89:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 510               		.loc 1 89 13 discriminator 2 view .LVU97
 511 0086 FF24      		clr r15
 512 0088 F394      		inc r15
 513 008a 8639      		cpi r24,-106
 514 008c 9105      		cpc r25,__zero_reg__
 515 008e 00F0      		brlo .L40
 516 0090 F12C      		mov r15,__zero_reg__
 517               	.L40:
 518 0092 8091 0000 		lds r24,tapping_key+5
 519 0096 982F      		mov r25,r24
 520 0098 907F      		andi r25,lo8(-16)
  89:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 521               		.loc 1 89 12 discriminator 4 view .LVU98
 522 009a FF20      		tst r15
 523 009c 01F4      		brne .+2
 524 009e 00C0      		rjmp .L42
  90:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 525               		.loc 1 90 13 is_stmt 1 view .LVU99
  90:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 526               		.loc 1 90 16 is_stmt 0 view .LVU100
 527 00a0 9111      		cpse r25,__zero_reg__
 528 00a2 00C0      		rjmp .L43
  91:./tmk_core/common/action_tapping.c ****                     // first tap!
 529               		.loc 1 91 17 is_stmt 1 discriminator 1 view .LVU101
 530 00a4 FC2C      		mov r15,r12
  91:./tmk_core/common/action_tapping.c ****                     // first tap!
 531               		.loc 1 91 21 is_stmt 0 discriminator 1 view .LVU102
 532 00a6 3E11      		cpse r19,r14
 533 00a8 00C0      		rjmp .L44
  91:./tmk_core/common/action_tapping.c ****                     // first tap!
 534               		.loc 1 91 21 discriminator 2 view .LVU103
 535 00aa 2D11      		cpse r18,r13
 536 00ac 00C0      		rjmp .L44
  91:./tmk_core/common/action_tapping.c ****                     // first tap!
 537               		.loc 1 91 47 discriminator 3 view .LVU104
 538 00ae C110      		cpse r12,__zero_reg__
 539 00b0 00C0      		rjmp .L44
  93:./tmk_core/common/action_tapping.c ****                     tapping_key.tap.count = 1;
 540               		.loc 1 93 57 is_stmt 1 view .LVU105
  94:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 541               		.loc 1 94 21 view .LVU106
  94:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 542               		.loc 1 94 43 is_stmt 0 view .LVU107
 543 00b2 8F70      		andi r24,lo8(15)
 544 00b4 8061      		ori r24,lo8(16)
 545 00b6 8093 0000 		sts tapping_key+5,r24
 546               	.LVL25:
  95:./tmk_core/common/action_tapping.c ****                     process_record(&tapping_key);
 547               		.loc 1 95 21 is_stmt 1 view .LVU108
 548 00ba 0E94 0000 		call debug_tapping_key
 549               	.LVL26:
  96:./tmk_core/common/action_tapping.c **** 
 550               		.loc 1 96 21 view .LVU109
 551 00be 80E0      		ldi r24,lo8(tapping_key)
 552 00c0 90E0      		ldi r25,hi8(tapping_key)
 553 00c2 0E94 0000 		call process_record
 554               	.LVL27:
  99:./tmk_core/common/action_tapping.c ****                     // enqueue
 555               		.loc 1 99 21 view .LVU110
  99:./tmk_core/common/action_tapping.c ****                     // enqueue
 556               		.loc 1 99 31 is_stmt 0 view .LVU111
 557 00c6 8091 0000 		lds r24,tapping_key+5
 558 00ca D801      		movw r26,r16
 559 00cc 1596      		adiw r26,5
 560 00ce 8C93      		st X,r24
 101:./tmk_core/common/action_tapping.c ****                 }
 561               		.loc 1 101 21 is_stmt 1 view .LVU112
 562               	.LVL28:
 563               	.L35:
 293:./tmk_core/common/action_tapping.c **** 
 564               		.loc 1 293 1 is_stmt 0 view .LVU113
 565 00d0 8F2D      		mov r24,r15
 566               	/* epilogue start */
 293:./tmk_core/common/action_tapping.c **** 
 567               		.loc 1 293 1 view .LVU114
 568 00d2 6196      		adiw r28,17
 569 00d4 0FB6      		in __tmp_reg__,__SREG__
 570 00d6 F894      		cli
 571 00d8 DEBF      		out __SP_H__,r29
 572 00da 0FBE      		out __SREG__,__tmp_reg__
 573 00dc CDBF      		out __SP_L__,r28
 574 00de DF91      		pop r29
 575 00e0 CF91      		pop r28
 576 00e2 1F91      		pop r17
 577 00e4 0F91      		pop r16
 578               	.LVL29:
 293:./tmk_core/common/action_tapping.c **** 
 579               		.loc 1 293 1 view .LVU115
 580 00e6 FF90      		pop r15
 581 00e8 EF90      		pop r14
 293:./tmk_core/common/action_tapping.c **** 
 582               		.loc 1 293 1 view .LVU116
 583 00ea DF90      		pop r13
 293:./tmk_core/common/action_tapping.c **** 
 584               		.loc 1 293 1 view .LVU117
 585 00ec CF90      		pop r12
 586               	.LVL30:
 293:./tmk_core/common/action_tapping.c **** 
 587               		.loc 1 293 1 view .LVU118
 588 00ee BF90      		pop r11
 589 00f0 AF90      		pop r10
 590 00f2 9F90      		pop r9
 591 00f4 0895      		ret
 592               	.LVL31:
 593               	.L38:
  89:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 594               		.loc 1 89 13 discriminator 2 view .LVU119
 595 00f6 8095      		com r24
 596 00f8 9095      		com r25
 597 00fa 8A0D      		add r24,r10
 598 00fc 9B1D      		adc r25,r11
 599 00fe 00C0      		rjmp .L136
 600               	.L44:
 108:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. No tap. Interfered by typing key\n");
 601               		.loc 1 108 22 is_stmt 1 view .LVU120
 602               	.LVL32:
 603               	.LBB30:
 604               	.LBI30:
  50:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
  51:./tmk_core/common/keyboard.h **** static inline bool IS_RELEASED(keyevent_t event) { return (!IS_NOEVENT(event) && !event.pressed); }
 605               		.loc 2 51 20 view .LVU121
 606               	.LBB31:
 607               		.loc 2 51 52 view .LVU122
 608               	.LBB32:
 609               	.LBI32:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 610               		.loc 2 49 20 view .LVU123
 611               	.LBB33:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 612               		.loc 2 49 51 view .LVU124
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 613               		.loc 2 49 74 is_stmt 0 view .LVU125
 614 0100 A114      		cp r10,__zero_reg__
 615 0102 B104      		cpc r11,__zero_reg__
 616 0104 01F0      		breq .L74
 617 0106 8E2D      		mov r24,r14
 618 0108 8D21      		and r24,r13
 619 010a 8F3F      		cpi r24,lo8(-1)
 620 010c 01F0      		breq .+2
 621 010e 00C0      		rjmp .L47
 622               	.L74:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 623               		.loc 2 49 74 view .LVU126
 624               	.LBE33:
 625               	.LBE32:
 626               		.loc 2 51 79 view .LVU127
 627 0110 80E0      		ldi r24,0
 628               	.L46:
 629               	.LVL33:
 630               		.loc 2 51 79 view .LVU128
 631               	.LBE31:
 632               	.LBE30:
 108:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. No tap. Interfered by typing key\n");
 633               		.loc 1 108 25 view .LVU129
 634 0112 80FF      		sbrs r24,0
 635 0114 00C0      		rjmp .L48
 108:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. No tap. Interfered by typing key\n");
 636               		.loc 1 108 48 discriminator 1 view .LVU130
 637 0116 4C2D      		mov r20,r12
 638 0118 6E2D      		mov r22,r14
 639 011a 8D2D      		mov r24,r13
 640 011c 0E94 0000 		call waiting_buffer_typed.isra.1
 641               	.LVL34:
 108:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. No tap. Interfered by typing key\n");
 642               		.loc 1 108 45 discriminator 1 view .LVU131
 643 0120 8823      		tst r24
 644 0122 01F0      		breq .L48
 109:./tmk_core/common/action_tapping.c ****                     process_record(&tapping_key);
 645               		.loc 1 109 78 is_stmt 1 view .LVU132
 110:./tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 646               		.loc 1 110 21 view .LVU133
 647 0124 80E0      		ldi r24,lo8(tapping_key)
 648 0126 90E0      		ldi r25,hi8(tapping_key)
 649 0128 0E94 0000 		call process_record
 650               	.LVL35:
 111:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 651               		.loc 1 111 21 view .LVU134
 111:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 652               		.loc 1 111 33 is_stmt 0 view .LVU135
 653 012c 86E0      		ldi r24,lo8(6)
 654 012e E0E0      		ldi r30,lo8(tapping_key)
 655 0130 F0E0      		ldi r31,hi8(tapping_key)
 656 0132 DF01      		movw r26,r30
 657               		0:
 658 0134 1D92      		st X+,__zero_reg__
 659 0136 8A95      		dec r24
 660 0138 01F4      		brne 0b
 112:./tmk_core/common/action_tapping.c ****                     // enqueue
 661               		.loc 1 112 21 is_stmt 1 view .LVU136
 662 013a 0E94 0000 		call debug_tapping_key
 663               	.LVL36:
 114:./tmk_core/common/action_tapping.c ****                 }
 664               		.loc 1 114 21 view .LVU137
 665               	.L141:
 147:./tmk_core/common/action_tapping.c ****                 }
 666               		.loc 1 147 28 is_stmt 0 view .LVU138
 667 013e F12C      		mov r15,__zero_reg__
 668 0140 00C0      		rjmp .L35
 669               	.LVL37:
 670               	.L48:
 121:./tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 671               		.loc 1 121 22 is_stmt 1 view .LVU139
 672               	.LBB35:
 673               	.LBI35:
 674               		.loc 2 51 20 view .LVU140
 675               	.LBB36:
 676               		.loc 2 51 52 view .LVU141
 677               	.LBB37:
 678               	.LBI37:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 679               		.loc 2 49 20 view .LVU142
 680               	.LBB38:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 681               		.loc 2 49 51 view .LVU143
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 682               		.loc 2 49 74 is_stmt 0 view .LVU144
 683 0142 AB28      		or r10,r11
 684 0144 01F0      		breq .L75
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 685               		.loc 2 49 74 view .LVU145
 686 0146 8E2D      		mov r24,r14
 687 0148 8D21      		and r24,r13
 688 014a 8F3F      		cpi r24,lo8(-1)
 689 014c 01F0      		breq .+2
 690 014e 00C0      		rjmp .L50
 691               	.L75:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 692               		.loc 2 49 74 view .LVU146
 693               	.LBE38:
 694               	.LBE37:
 695               		.loc 2 51 79 view .LVU147
 696 0150 80E0      		ldi r24,0
 697               	.L49:
 698               	.LVL38:
 699               		.loc 2 51 79 view .LVU148
 700               	.LBE36:
 701               	.LBE35:
 121:./tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 702               		.loc 1 121 25 view .LVU149
 703 0152 B82F      		mov r27,r24
 704 0154 B170      		andi r27,lo8(1)
 705 0156 AB2E      		mov r10,r27
 706               	.LVL39:
 121:./tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 707               		.loc 1 121 25 view .LVU150
 708 0158 80FF      		sbrs r24,0
 709 015a 00C0      		rjmp .L51
 121:./tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 710               		.loc 1 121 49 discriminator 1 view .LVU151
 711 015c 4C2D      		mov r20,r12
 712 015e 6E2D      		mov r22,r14
 713 0160 8D2D      		mov r24,r13
 714 0162 0E94 0000 		call waiting_buffer_typed.isra.1
 715               	.LVL40:
 716 0166 B82E      		mov r11,r24
 121:./tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 717               		.loc 1 121 45 discriminator 1 view .LVU152
 718 0168 8111      		cpse r24,__zero_reg__
 719 016a 00C0      		rjmp .L51
 720               	.LBB40:
 123:./tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 721               		.loc 1 123 21 is_stmt 1 view .LVU153
 123:./tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 722               		.loc 1 123 39 is_stmt 0 view .LVU154
 723 016c DD86      		std Y+13,r13
 724 016e EE86      		std Y+14,r14
 725 0170 8D85      		ldd r24,Y+13
 726 0172 9E85      		ldd r25,Y+14
 727 0174 0E94 0000 		call layer_switch_get_action
 728               	.LVL41:
 124:./tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 729               		.loc 1 124 21 is_stmt 1 view .LVU155
 124:./tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 730               		.loc 1 124 40 is_stmt 0 view .LVU156
 731 0178 292F      		mov r18,r25
 732 017a 2295      		swap r18
 733 017c 2F70      		andi r18,lo8(15)
 124:./tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 734               		.loc 1 124 21 view .LVU157
 735 017e 2230      		cpi r18,lo8(2)
 736 0180 00F0      		brlo .L52
 124:./tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 737               		.loc 1 124 21 view .LVU158
 738 0182 2430      		cpi r18,lo8(4)
 739 0184 00F4      		brsh .L53
 132:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 740               		.loc 1 132 29 is_stmt 1 view .LVU159
 132:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 741               		.loc 1 132 33 is_stmt 0 view .LVU160
 742 0186 9F70      		andi r25,lo8(15)
 743               	.LVL42:
 132:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 744               		.loc 1 132 32 view .LVU161
 745 0188 01F0      		breq .L57
 132:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 746               		.loc 1 132 68 discriminator 1 view .LVU162
 747 018a F801      		movw r30,r16
 748 018c 9581      		ldd r25,Z+5
 749 018e 907F      		andi r25,lo8(-16)
 132:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 750               		.loc 1 132 49 discriminator 1 view .LVU163
 751 0190 01F4      		brne .L57
 752               	.LVL43:
 753               	.L56:
 132:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 754               		.loc 1 132 49 discriminator 1 view .LVU164
 755 0192 FB2C      		mov r15,r11
 756 0194 00C0      		rjmp .L35
 757               	.LVL44:
 758               	.L52:
 127:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 759               		.loc 1 127 29 is_stmt 1 view .LVU165
 127:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 760               		.loc 1 127 33 is_stmt 0 view .LVU166
 761 0196 9F70      		andi r25,lo8(15)
 762               	.LVL45:
 127:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 763               		.loc 1 127 32 view .LVU167
 764 0198 01F0      		breq .L57
 127:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 765               		.loc 1 127 49 discriminator 1 view .LVU168
 766 019a 8823      		tst r24
 767 019c 01F0      		breq .L56
 768               	.L57:
 133:./tmk_core/common/action_tapping.c ****                             break;
 769               		.loc 1 133 29 is_stmt 1 view .LVU169
 133:./tmk_core/common/action_tapping.c ****                             break;
 770               		.loc 1 133 33 is_stmt 0 view .LVU170
 771 019e 805E      		subi r24,lo8(-(32))
 772               	.LVL46:
 133:./tmk_core/common/action_tapping.c ****                             break;
 773               		.loc 1 133 32 view .LVU171
 774 01a0 8830      		cpi r24,lo8(8)
 775 01a2 00F0      		brlo .L56
 776               	.LVL47:
 777               	.L53:
 137:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 778               		.loc 1 137 86 is_stmt 1 view .LVU172
 138:./tmk_core/common/action_tapping.c ****                     return true;
 779               		.loc 1 138 21 view .LVU173
 780 01a4 C801      		movw r24,r16
 781               	.LVL48:
 138:./tmk_core/common/action_tapping.c ****                     return true;
 782               		.loc 1 138 21 is_stmt 0 view .LVU174
 783 01a6 0E94 0000 		call process_record
 784               	.LVL49:
 139:./tmk_core/common/action_tapping.c ****                 }
 785               		.loc 1 139 21 is_stmt 1 view .LVU175
 139:./tmk_core/common/action_tapping.c ****                 }
 786               		.loc 1 139 28 is_stmt 0 view .LVU176
 787 01aa BA2C      		mov r11,r10
 788 01ac 00C0      		rjmp .L56
 789               	.LVL50:
 790               	.L51:
 139:./tmk_core/common/action_tapping.c ****                 }
 791               		.loc 1 139 28 view .LVU177
 792               	.LBE40:
 143:./tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 793               		.loc 1 143 21 is_stmt 1 view .LVU178
 143:./tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 794               		.loc 1 143 24 is_stmt 0 view .LVU179
 795 01ae CC20      		tst r12
 796 01b0 01F4      		brne .+2
 797 01b2 00C0      		rjmp .L35
 144:./tmk_core/common/action_tapping.c ****                     }
 798               		.loc 1 144 25 is_stmt 1 view .LVU180
 144:./tmk_core/common/action_tapping.c ****                     }
 799               		.loc 1 144 53 is_stmt 0 view .LVU181
 800 01b4 8091 0000 		lds r24,tapping_key+5
 801 01b8 8160      		ori r24,lo8(1<<0)
 802 01ba 8093 0000 		sts tapping_key+5,r24
 803 01be 00C0      		rjmp .L141
 804               	.LVL51:
 805               	.L43:
 152:./tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 806               		.loc 1 152 17 is_stmt 1 discriminator 1 view .LVU182
 152:./tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 807               		.loc 1 152 21 is_stmt 0 discriminator 1 view .LVU183
 808 01c0 3E11      		cpse r19,r14
 809 01c2 00C0      		rjmp .L58
 152:./tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 810               		.loc 1 152 21 discriminator 2 view .LVU184
 811 01c4 2D11      		cpse r18,r13
 812 01c6 00C0      		rjmp .L58
 154:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 813               		.loc 1 154 31 discriminator 3 view .LVU185
 814 01c8 D801      		movw r26,r16
 152:./tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 815               		.loc 1 152 47 discriminator 3 view .LVU186
 816 01ca CC20      		tst r12
 817 01cc 01F4      		brne .+2
 818 01ce 00C0      		rjmp .L145
 819               	.L58:
 160:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 820               		.loc 1 160 22 is_stmt 1 view .LVU187
 160:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 821               		.loc 1 160 26 is_stmt 0 view .LVU188
 822 01d0 DD86      		std Y+13,r13
 823 01d2 EE86      		std Y+14,r14
 824 01d4 8D85      		ldd r24,Y+13
 825 01d6 9E85      		ldd r25,Y+14
 826 01d8 0E94 0000 		call is_tap_key
 827               	.LVL52:
 160:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 828               		.loc 1 160 25 view .LVU189
 829 01dc 8823      		tst r24
 830 01de 01F0      		breq .L70
 160:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 831               		.loc 1 160 48 discriminator 1 view .LVU190
 832 01e0 CC20      		tst r12
 833 01e2 01F0      		breq .L70
 161:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 834               		.loc 1 161 21 is_stmt 1 view .LVU191
 161:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 835               		.loc 1 161 40 is_stmt 0 view .LVU192
 836 01e4 8091 0000 		lds r24,tapping_key+5
 161:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 837               		.loc 1 161 24 view .LVU193
 838 01e8 8032      		cpi r24,lo8(32)
 839 01ea 00F0      		brlo .L61
 162:./tmk_core/common/action_tapping.c ****                         // unregister key
 840               		.loc 1 162 87 is_stmt 1 view .LVU194
 164:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 841               		.loc 1 164 25 view .LVU195
 164:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 842               		.loc 1 164 54 is_stmt 0 view .LVU196
 843 01ec 2091 0000 		lds r18,tapping_key
 844 01f0 3091 0000 		lds r19,tapping_key+1
 845 01f4 3887      		std Y+8,r19
 846 01f6 2F83      		std Y+7,r18
 847 01f8 1986      		std Y+9,__zero_reg__
 848 01fa BB86      		std Y+11,r11
 849 01fc AA86      		std Y+10,r10
 850 01fe 8C87      		std Y+12,r24
 164:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 851               		.loc 1 164 25 view .LVU197
 852 0200 CE01      		movw r24,r28
 853 0202 0796      		adiw r24,7
 854               	.L138:
 164:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 855               		.loc 1 164 25 view .LVU198
 856 0204 0E94 0000 		call process_record
 857               	.LVL53:
 858               	.L61:
 171:./tmk_core/common/action_tapping.c ****                     }
 859               		.loc 1 171 69 is_stmt 1 view .LVU199
 173:./tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 860               		.loc 1 173 21 view .LVU200
 173:./tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 861               		.loc 1 173 33 is_stmt 0 view .LVU201
 862 0208 86E0      		ldi r24,lo8(6)
 863 020a F801      		movw r30,r16
 864 020c A0E0      		ldi r26,lo8(tapping_key)
 865 020e B0E0      		ldi r27,hi8(tapping_key)
 866               		0:
 867 0210 0190      		ld r0,Z+
 868 0212 0D92      		st X+,r0
 869 0214 8A95      		dec r24
 870 0216 01F4      		brne 0b
 174:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 871               		.loc 1 174 21 is_stmt 1 view .LVU202
 872 0218 0E94 0000 		call waiting_buffer_scan_tap
 873               	.LVL54:
 175:./tmk_core/common/action_tapping.c ****                     return true;
 874               		.loc 1 175 21 view .LVU203
 875 021c 0E94 0000 		call debug_tapping_key
 876               	.LVL55:
 176:./tmk_core/common/action_tapping.c ****                 }
 877               		.loc 1 176 21 view .LVU204
 878               	.L142:
 183:./tmk_core/common/action_tapping.c ****                 }
 879               		.loc 1 183 21 view .LVU205
 183:./tmk_core/common/action_tapping.c ****                 }
 880               		.loc 1 183 28 is_stmt 0 view .LVU206
 881 0220 FF24      		clr r15
 882 0222 F394      		inc r15
 883 0224 00C0      		rjmp .L35
 884               	.L70:
 179:./tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last tap(>0).\n");
 885               		.loc 1 179 21 is_stmt 1 view .LVU207
 180:./tmk_core/common/action_tapping.c ****                     }
 886               		.loc 1 180 74 view .LVU208
 182:./tmk_core/common/action_tapping.c ****                     return true;
 887               		.loc 1 182 21 view .LVU209
 888 0226 C801      		movw r24,r16
 889 0228 0E94 0000 		call process_record
 890               	.LVL56:
 891 022c 00C0      		rjmp .L142
 892               	.LVL57:
 893               	.L42:
 189:./tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 894               		.loc 1 189 13 view .LVU210
 189:./tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 895               		.loc 1 189 16 is_stmt 0 view .LVU211
 896 022e 9111      		cpse r25,__zero_reg__
 897 0230 00C0      		rjmp .L62
 190:./tmk_core/common/action_tapping.c ****                 debug_event(event); debug("\n");
 898               		.loc 1 190 61 is_stmt 1 view .LVU212
 191:./tmk_core/common/action_tapping.c ****                 process_record(&tapping_key);
 899               		.loc 1 191 17 view .LVU213
 191:./tmk_core/common/action_tapping.c ****                 process_record(&tapping_key);
 900               		.loc 1 191 17 is_stmt 0 view .LVU214
 901 0232 7A2D      		mov r23,r10
 902 0234 B98A      		std Y+17,r11
 903 0236 A88A      		std Y+16,r10
 904 0238 4D2D      		mov r20,r13
 905 023a 5E2D      		mov r21,r14
 906 023c 6C2D      		mov r22,r12
 907 023e 8989      		ldd r24,Y+17
 908 0240 0E94 0000 		call debug_event
 909               	.LVL58:
 191:./tmk_core/common/action_tapping.c ****                 process_record(&tapping_key);
 910               		.loc 1 191 48 is_stmt 1 view .LVU215
 192:./tmk_core/common/action_tapping.c ****                 tapping_key = (keyrecord_t){};
 911               		.loc 1 192 17 view .LVU216
 912 0244 80E0      		ldi r24,lo8(tapping_key)
 913 0246 90E0      		ldi r25,hi8(tapping_key)
 914 0248 0E94 0000 		call process_record
 915               	.LVL59:
 193:./tmk_core/common/action_tapping.c ****                 debug_tapping_key();
 916               		.loc 1 193 17 view .LVU217
 917               	.L146:
 273:./tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 918               		.loc 1 273 44 view .LVU218
 274:./tmk_core/common/action_tapping.c ****             debug_tapping_key();
 919               		.loc 1 274 13 view .LVU219
 274:./tmk_core/common/action_tapping.c ****             debug_tapping_key();
 920               		.loc 1 274 25 is_stmt 0 view .LVU220
 921 024c 86E0      		ldi r24,lo8(6)
 922 024e E0E0      		ldi r30,lo8(tapping_key)
 923 0250 F0E0      		ldi r31,hi8(tapping_key)
 924 0252 DF01      		movw r26,r30
 925               		0:
 926 0254 1D92      		st X+,__zero_reg__
 927 0256 8A95      		dec r24
 928 0258 01F4      		brne 0b
 275:./tmk_core/common/action_tapping.c ****             return false;
 929               		.loc 1 275 13 is_stmt 1 view .LVU221
 930 025a 00C0      		rjmp .L140
 931               	.L62:
 197:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 932               		.loc 1 197 17 discriminator 1 view .LVU222
 197:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 933               		.loc 1 197 21 is_stmt 0 discriminator 1 view .LVU223
 934 025c 3E11      		cpse r19,r14
 935 025e 00C0      		rjmp .L63
 197:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 936               		.loc 1 197 21 discriminator 2 view .LVU224
 937 0260 2D11      		cpse r18,r13
 938 0262 00C0      		rjmp .L63
 197:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 939               		.loc 1 197 47 discriminator 3 view .LVU225
 940 0264 C110      		cpse r12,__zero_reg__
 941 0266 00C0      		rjmp .L63
 198:./tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 942               		.loc 1 198 73 is_stmt 1 view .LVU226
 199:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 943               		.loc 1 199 21 view .LVU227
 199:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 944               		.loc 1 199 31 is_stmt 0 view .LVU228
 945 0268 F801      		movw r30,r16
 946 026a 8583      		std Z+5,r24
 200:./tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 947               		.loc 1 200 21 is_stmt 1 view .LVU229
 948 026c C801      		movw r24,r16
 949 026e 0E94 0000 		call process_record
 950               	.LVL60:
 201:./tmk_core/common/action_tapping.c ****                     return true;
 951               		.loc 1 201 21 view .LVU230
 201:./tmk_core/common/action_tapping.c ****                     return true;
 952               		.loc 1 201 33 is_stmt 0 view .LVU231
 953 0272 E0E0      		ldi r30,lo8(tapping_key)
 954 0274 F0E0      		ldi r31,hi8(tapping_key)
 955 0276 86E0      		ldi r24,lo8(6)
 956 0278 DF01      		movw r26,r30
 957               		0:
 958 027a 1D92      		st X+,__zero_reg__
 959 027c 8A95      		dec r24
 960 027e 01F4      		brne 0b
 202:./tmk_core/common/action_tapping.c ****                 }
 961               		.loc 1 202 21 is_stmt 1 view .LVU232
 202:./tmk_core/common/action_tapping.c ****                 }
 962               		.loc 1 202 28 is_stmt 0 view .LVU233
 963 0280 F92C      		mov r15,r9
 964 0282 00C0      		rjmp .L35
 965               	.L63:
 204:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 966               		.loc 1 204 22 is_stmt 1 view .LVU234
 204:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 967               		.loc 1 204 26 is_stmt 0 view .LVU235
 968 0284 DD86      		std Y+13,r13
 969 0286 EE86      		std Y+14,r14
 970 0288 8D85      		ldd r24,Y+13
 971 028a 9E85      		ldd r25,Y+14
 972 028c 0E94 0000 		call is_tap_key
 973               	.LVL61:
 204:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 974               		.loc 1 204 25 view .LVU236
 975 0290 8823      		tst r24
 976 0292 01F0      		breq .L70
 204:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 977               		.loc 1 204 48 discriminator 1 view .LVU237
 978 0294 CC20      		tst r12
 979 0296 01F0      		breq .L70
 205:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last timeout tap(>1).\n");
 980               		.loc 1 205 21 is_stmt 1 view .LVU238
 205:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last timeout tap(>1).\n");
 981               		.loc 1 205 40 is_stmt 0 view .LVU239
 982 0298 8091 0000 		lds r24,tapping_key+5
 205:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last timeout tap(>1).\n");
 983               		.loc 1 205 24 view .LVU240
 984 029c 8032      		cpi r24,lo8(32)
 985 029e 00F4      		brsh .+2
 986 02a0 00C0      		rjmp .L61
 206:./tmk_core/common/action_tapping.c ****                         // unregister key
 987               		.loc 1 206 95 is_stmt 1 view .LVU241
 208:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 988               		.loc 1 208 25 view .LVU242
 208:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 989               		.loc 1 208 54 is_stmt 0 view .LVU243
 990 02a2 2091 0000 		lds r18,tapping_key
 991 02a6 3091 0000 		lds r19,tapping_key+1
 992 02aa 3A83      		std Y+2,r19
 993 02ac 2983      		std Y+1,r18
 994 02ae 1B82      		std Y+3,__zero_reg__
 995 02b0 BD82      		std Y+5,r11
 996 02b2 AC82      		std Y+4,r10
 997 02b4 8E83      		std Y+6,r24
 208:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 998               		.loc 1 208 25 view .LVU244
 999 02b6 CE01      		movw r24,r28
 1000 02b8 0196      		adiw r24,1
 1001 02ba 00C0      		rjmp .L138
 1002               	.L37:
 231:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 1003               		.loc 1 231 12 is_stmt 1 discriminator 1 view .LVU245
 232:./tmk_core/common/action_tapping.c ****             if (event.pressed) {
 1004               		.loc 1 232 9 discriminator 1 view .LVU246
 232:./tmk_core/common/action_tapping.c ****             if (event.pressed) {
 1005               		.loc 1 232 13 is_stmt 0 discriminator 1 view .LVU247
 1006 02bc A816      		cp r10,r24
 1007 02be B906      		cpc r11,r25
 1008 02c0 00F0      		brlo .L65
 1009 02c2 F501      		movw r30,r10
 1010 02c4 E81B      		sub r30,r24
 1011 02c6 F90B      		sbc r31,r25
 1012 02c8 CF01      		movw r24,r30
 1013               	.L144:
 232:./tmk_core/common/action_tapping.c ****             if (event.pressed) {
 1014               		.loc 1 232 13 discriminator 2 view .LVU248
 1015 02ca F12C      		mov r15,__zero_reg__
 1016 02cc 8639      		cpi r24,-106
 1017 02ce 9105      		cpc r25,__zero_reg__
 1018 02d0 00F0      		brlo .+2
 1019 02d2 00C0      		rjmp .L69
 233:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 1020               		.loc 1 233 13 is_stmt 1 view .LVU249
 233:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 1021               		.loc 1 233 22 is_stmt 0 view .LVU250
 1022 02d4 FC2C      		mov r15,r12
 233:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 1023               		.loc 1 233 16 view .LVU251
 1024 02d6 CC20      		tst r12
 1025 02d8 01F4      		brne .+2
 1026 02da 00C0      		rjmp .L70
 234:./tmk_core/common/action_tapping.c **** #ifndef TAPPING_FORCE_HOLD
 1027               		.loc 1 234 17 is_stmt 1 discriminator 1 view .LVU252
 234:./tmk_core/common/action_tapping.c **** #ifndef TAPPING_FORCE_HOLD
 1028               		.loc 1 234 21 is_stmt 0 discriminator 1 view .LVU253
 1029 02dc 3E11      		cpse r19,r14
 1030 02de 00C0      		rjmp .L71
 234:./tmk_core/common/action_tapping.c **** #ifndef TAPPING_FORCE_HOLD
 1031               		.loc 1 234 21 discriminator 2 view .LVU254
 1032 02e0 2D11      		cpse r18,r13
 1033 02e2 00C0      		rjmp .L71
 236:./tmk_core/common/action_tapping.c ****                         // sequential tap.
 1034               		.loc 1 236 21 is_stmt 1 view .LVU255
 236:./tmk_core/common/action_tapping.c ****                         // sequential tap.
 1035               		.loc 1 236 41 is_stmt 0 view .LVU256
 1036 02e4 8091 0000 		lds r24,tapping_key+5
 236:./tmk_core/common/action_tapping.c ****                         // sequential tap.
 1037               		.loc 1 236 24 view .LVU257
 1038 02e8 80FD      		sbrc r24,0
 1039 02ea 00C0      		rjmp .L72
 236:./tmk_core/common/action_tapping.c ****                         // sequential tap.
 1040               		.loc 1 236 79 discriminator 1 view .LVU258
 1041 02ec 982F      		mov r25,r24
 1042 02ee 907F      		andi r25,lo8(-16)
 236:./tmk_core/common/action_tapping.c ****                         // sequential tap.
 1043               		.loc 1 236 54 discriminator 1 view .LVU259
 1044 02f0 01F0      		breq .L72
 238:./tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 1045               		.loc 1 238 25 is_stmt 1 view .LVU260
 238:./tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 1046               		.loc 1 238 35 is_stmt 0 view .LVU261
 1047 02f2 D801      		movw r26,r16
 1048 02f4 1596      		adiw r26,5
 1049 02f6 8C93      		st X,r24
 1050 02f8 1597      		sbiw r26,5
 239:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 1051               		.loc 1 239 25 is_stmt 1 view .LVU262
 239:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 1052               		.loc 1 239 28 is_stmt 0 view .LVU263
 1053 02fa 903F      		cpi r25,lo8(-16)
 1054 02fc 01F0      		breq .L73
 239:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 1055               		.loc 1 239 51 is_stmt 1 discriminator 1 view .LVU264
 239:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 1056               		.loc 1 239 67 is_stmt 0 discriminator 1 view .LVU265
 1057 02fe 982F      		mov r25,r24
 1058 0300 907F      		andi r25,lo8(-16)
 1059 0302 905F      		subi r25,lo8(-(16))
 1060 0304 8F70      		andi r24,lo8(15)
 1061 0306 892B      		or r24,r25
 1062               	.L145:
 239:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 1063               		.loc 1 239 67 discriminator 1 view .LVU266
 1064 0308 1596      		adiw r26,5
 1065 030a 8C93      		st X,r24
 1066               	.L73:
 240:./tmk_core/common/action_tapping.c ****                         process_record(keyp);
 1067               		.loc 1 240 53 is_stmt 1 view .LVU267
 240:./tmk_core/common/action_tapping.c ****                         process_record(keyp);
 1068               		.loc 1 240 81 view .LVU268
 240:./tmk_core/common/action_tapping.c ****                         process_record(keyp);
 1069               		.loc 1 240 95 view .LVU269
 241:./tmk_core/common/action_tapping.c ****                         tapping_key = *keyp;
 1070               		.loc 1 241 25 view .LVU270
 1071 030c C801      		movw r24,r16
 1072 030e 0E94 0000 		call process_record
 1073               	.LVL62:
 242:./tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 1074               		.loc 1 242 25 view .LVU271
 242:./tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 1075               		.loc 1 242 37 is_stmt 0 view .LVU272
 1076 0312 86E0      		ldi r24,lo8(6)
 1077 0314 F801      		movw r30,r16
 1078 0316 A0E0      		ldi r26,lo8(tapping_key)
 1079 0318 B0E0      		ldi r27,hi8(tapping_key)
 1080               		0:
 1081 031a 0190      		ld r0,Z+
 1082 031c 0D92      		st X+,r0
 1083 031e 8A95      		dec r24
 1084 0320 01F4      		brne 0b
 243:./tmk_core/common/action_tapping.c ****                         return true;
 1085               		.loc 1 243 25 is_stmt 1 view .LVU273
 1086               	.LVL63:
 1087               	.L140:
 286:./tmk_core/common/action_tapping.c ****             return true;
 1088               		.loc 1 286 13 view .LVU274
 1089 0322 0E94 0000 		call debug_tapping_key
 1090               	.LVL64:
 287:./tmk_core/common/action_tapping.c ****         } else {
 1091               		.loc 1 287 13 view .LVU275
 287:./tmk_core/common/action_tapping.c ****         } else {
 1092               		.loc 1 287 20 is_stmt 0 view .LVU276
 1093 0326 00C0      		rjmp .L35
 1094               	.LVL65:
 1095               	.L65:
 232:./tmk_core/common/action_tapping.c ****             if (event.pressed) {
 1096               		.loc 1 232 13 discriminator 2 view .LVU277
 1097 0328 8095      		com r24
 1098 032a 9095      		com r25
 1099 032c 8A0D      		add r24,r10
 1100 032e 9B1D      		adc r25,r11
 1101 0330 00C0      		rjmp .L144
 1102               	.L72:
 248:./tmk_core/common/action_tapping.c ****                     return true;
 1103               		.loc 1 248 21 is_stmt 1 view .LVU278
 248:./tmk_core/common/action_tapping.c ****                     return true;
 1104               		.loc 1 248 33 is_stmt 0 view .LVU279
 1105 0332 86E0      		ldi r24,lo8(6)
 1106 0334 F801      		movw r30,r16
 1107 0336 A0E0      		ldi r26,lo8(tapping_key)
 1108 0338 B0E0      		ldi r27,hi8(tapping_key)
 1109               		0:
 1110 033a 0190      		ld r0,Z+
 1111 033c 0D92      		st X+,r0
 1112 033e 8A95      		dec r24
 1113 0340 01F4      		brne 0b
 249:./tmk_core/common/action_tapping.c ****                 } else if (is_tap_key(event.key)) {
 1114               		.loc 1 249 21 is_stmt 1 view .LVU280
 249:./tmk_core/common/action_tapping.c ****                 } else if (is_tap_key(event.key)) {
 1115               		.loc 1 249 28 is_stmt 0 view .LVU281
 1116 0342 00C0      		rjmp .L35
 1117               	.L71:
 250:./tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 1118               		.loc 1 250 24 is_stmt 1 view .LVU282
 250:./tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 1119               		.loc 1 250 28 is_stmt 0 view .LVU283
 1120 0344 DD86      		std Y+13,r13
 1121 0346 EE86      		std Y+14,r14
 1122 0348 8D85      		ldd r24,Y+13
 1123 034a 9E85      		ldd r25,Y+14
 1124 034c 0E94 0000 		call is_tap_key
 1125               	.LVL66:
 250:./tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 1126               		.loc 1 250 27 view .LVU284
 1127 0350 8111      		cpse r24,__zero_reg__
 1128 0352 00C0      		rjmp .L61
 260:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 1129               		.loc 1 260 21 is_stmt 1 view .LVU285
 260:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 1130               		.loc 1 260 49 is_stmt 0 view .LVU286
 1131 0354 8091 0000 		lds r24,tapping_key+5
 1132 0358 8160      		ori r24,lo8(1<<0)
 1133 035a 8093 0000 		sts tapping_key+5,r24
 261:./tmk_core/common/action_tapping.c ****                     return true;
 1134               		.loc 1 261 21 is_stmt 1 view .LVU287
 1135 035e C801      		movw r24,r16
 1136 0360 0E94 0000 		call process_record
 1137               	.LVL67:
 262:./tmk_core/common/action_tapping.c ****                 }
 1138               		.loc 1 262 21 view .LVU288
 262:./tmk_core/common/action_tapping.c ****                 }
 1139               		.loc 1 262 28 is_stmt 0 view .LVU289
 1140 0364 00C0      		rjmp .L35
 1141               	.L69:
 272:./tmk_core/common/action_tapping.c ****             debug_event(event); debug("\n");
 1142               		.loc 1 272 70 is_stmt 1 view .LVU290
 273:./tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 1143               		.loc 1 273 13 view .LVU291
 273:./tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 1144               		.loc 1 273 13 is_stmt 0 view .LVU292
 1145 0366 7A2D      		mov r23,r10
 1146 0368 B98A      		std Y+17,r11
 1147 036a A88A      		std Y+16,r10
 1148 036c 4D2D      		mov r20,r13
 1149 036e 5E2D      		mov r21,r14
 1150 0370 6C2D      		mov r22,r12
 1151 0372 8989      		ldd r24,Y+17
 1152 0374 0E94 0000 		call debug_event
 1153               	.LVL68:
 1154 0378 00C0      		rjmp .L146
 1155               	.LVL69:
 1156               	.L36:
 281:./tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1157               		.loc 1 281 9 is_stmt 1 view .LVU293
 281:./tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1158               		.loc 1 281 12 is_stmt 0 view .LVU294
 1159 037a CC20      		tst r12
 1160 037c 01F4      		brne .+2
 1161 037e 00C0      		rjmp .L70
 281:./tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1162               		.loc 1 281 30 discriminator 1 view .LVU295
 1163 0380 DD86      		std Y+13,r13
 1164 0382 EE86      		std Y+14,r14
 1165 0384 8D85      		ldd r24,Y+13
 1166 0386 9E85      		ldd r25,Y+14
 1167 0388 0E94 0000 		call is_tap_key
 1168               	.LVL70:
 281:./tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1169               		.loc 1 281 30 discriminator 1 view .LVU296
 1170 038c F82E      		mov r15,r24
 281:./tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1171               		.loc 1 281 27 discriminator 1 view .LVU297
 1172 038e 8823      		tst r24
 1173 0390 01F4      		brne .+2
 1174 0392 00C0      		rjmp .L70
 282:./tmk_core/common/action_tapping.c ****             tapping_key = *keyp;
 1175               		.loc 1 282 54 is_stmt 1 view .LVU298
 283:./tmk_core/common/action_tapping.c ****             process_record_tap_hint(&tapping_key);
 1176               		.loc 1 283 13 view .LVU299
 283:./tmk_core/common/action_tapping.c ****             process_record_tap_hint(&tapping_key);
 1177               		.loc 1 283 25 is_stmt 0 view .LVU300
 1178 0394 86E0      		ldi r24,lo8(6)
 1179 0396 F801      		movw r30,r16
 1180 0398 A0E0      		ldi r26,lo8(tapping_key)
 1181 039a B0E0      		ldi r27,hi8(tapping_key)
 1182               		0:
 1183 039c 0190      		ld r0,Z+
 1184 039e 0D92      		st X+,r0
 1185 03a0 8A95      		dec r24
 1186 03a2 01F4      		brne 0b
 284:./tmk_core/common/action_tapping.c ****             waiting_buffer_scan_tap();
 1187               		.loc 1 284 13 is_stmt 1 view .LVU301
 1188 03a4 80E0      		ldi r24,lo8(tapping_key)
 1189 03a6 90E0      		ldi r25,hi8(tapping_key)
 1190 03a8 0E94 0000 		call process_record_tap_hint
 1191               	.LVL71:
 285:./tmk_core/common/action_tapping.c ****             debug_tapping_key();
 1192               		.loc 1 285 13 view .LVU302
 1193 03ac 0E94 0000 		call waiting_buffer_scan_tap
 1194               	.LVL72:
 1195 03b0 00C0      		rjmp .L140
 1196               	.LVL73:
 1197               	.L50:
 1198               	.LBB41:
 1199               	.LBB39:
 1200               		.loc 2 51 79 is_stmt 0 view .LVU303
 1201 03b2 81E0      		ldi r24,lo8(1)
 1202 03b4 8C25      		eor r24,r12
 1203 03b6 00C0      		rjmp .L49
 1204               	.LVL74:
 1205               	.L47:
 1206               		.loc 2 51 79 view .LVU304
 1207               	.LBE39:
 1208               	.LBE41:
 1209               	.LBB42:
 1210               	.LBB34:
 1211 03b8 81E0      		ldi r24,lo8(1)
 1212 03ba 8C25      		eor r24,r12
 1213 03bc 00C0      		rjmp .L46
 1214               	.LBE34:
 1215               	.LBE42:
 1216               		.cfi_endproc
 1217               	.LFE5:
 1219               		.section	.text.action_tapping_process,"ax",@progbits
 1220               	.global	action_tapping_process
 1222               	action_tapping_process:
 1223               	.LFB4:
  44:./tmk_core/common/action_tapping.c ****     if (process_tapping(&record)) {
 1224               		.loc 1 44 1 is_stmt 1 view -0
 1225               		.cfi_startproc
 1226 0000 1F93      		push r17
 1227               	.LCFI19:
 1228               		.cfi_def_cfa_offset 3
 1229               		.cfi_offset 17, -2
 1230 0002 CF93      		push r28
 1231               	.LCFI20:
 1232               		.cfi_def_cfa_offset 4
 1233               		.cfi_offset 28, -3
 1234 0004 DF93      		push r29
 1235               	.LCFI21:
 1236               		.cfi_def_cfa_offset 5
 1237               		.cfi_offset 29, -4
 1238 0006 CDB7      		in r28,__SP_L__
 1239 0008 DEB7      		in r29,__SP_H__
 1240               	.LCFI22:
 1241               		.cfi_def_cfa_register 28
 1242 000a 2C97      		sbiw r28,12
 1243               	.LCFI23:
 1244               		.cfi_def_cfa_offset 17
 1245 000c 0FB6      		in __tmp_reg__,__SREG__
 1246 000e F894      		cli
 1247 0010 DEBF      		out __SP_H__,r29
 1248 0012 0FBE      		out __SREG__,__tmp_reg__
 1249 0014 CDBF      		out __SP_L__,r28
 1250               	/* prologue: function */
 1251               	/* frame size = 12 */
 1252               	/* stack size = 15 */
 1253               	.L__stack_usage = 15
 1254 0016 4F83      		std Y+7,r20
 1255 0018 5887      		std Y+8,r21
 1256 001a 6987      		std Y+9,r22
 1257 001c 7A87      		std Y+10,r23
 1258 001e 8B87      		std Y+11,r24
 1259 0020 9C87      		std Y+12,r25
  45:./tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1260               		.loc 1 45 5 view .LVU306
  45:./tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1261               		.loc 1 45 9 is_stmt 0 view .LVU307
 1262 0022 CE01      		movw r24,r28
 1263 0024 0796      		adiw r24,7
 1264 0026 0E94 0000 		call process_tapping
 1265               	.LVL75:
  45:./tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1266               		.loc 1 45 8 view .LVU308
 1267 002a 8823      		tst r24
 1268 002c 01F0      		breq .L148
  46:./tmk_core/common/action_tapping.c ****             debug("processed: "); debug_record(record); debug("\n");
 1269               		.loc 1 46 9 is_stmt 1 view .LVU309
 1270               	.LBB51:
 1271               	.LBI51:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1272               		.loc 2 49 20 view .LVU310
 1273               	.LBB52:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1274               		.loc 2 49 51 view .LVU311
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1275               		.loc 2 49 74 is_stmt 0 view .LVU312
 1276 002e 8A85      		ldd r24,Y+10
 1277 0030 9B85      		ldd r25,Y+11
 1278 0032 892B      		or r24,r25
 1279 0034 01F0      		breq .L149
 1280 0036 4F81      		ldd r20,Y+7
 1281 0038 5885      		ldd r21,Y+8
 1282 003a 842F      		mov r24,r20
 1283 003c 8523      		and r24,r21
 1284 003e 8F3F      		cpi r24,lo8(-1)
 1285 0040 01F0      		breq .+2
 1286 0042 00C0      		rjmp .L171
 1287               	.L149:
 1288               	.LBE52:
 1289               	.LBE51:
  64:./tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
 1290               		.loc 1 64 13 discriminator 1 view .LVU313
 1291 0044 16E0      		ldi r17,lo8(6)
 1292 0046 00C0      		rjmp .L156
 1293               	.L148:
  50:./tmk_core/common/action_tapping.c ****             // clear all in case of overflow.
 1294               		.loc 1 50 9 is_stmt 1 view .LVU314
 1295 0048 86E0      		ldi r24,lo8(6)
 1296 004a FE01      		movw r30,r28
 1297 004c 3796      		adiw r30,7
 1298 004e DE01      		movw r26,r28
 1299 0050 1196      		adiw r26,1
 1300               		0:
 1301 0052 0190      		ld r0,Z+
 1302 0054 0D92      		st X+,r0
 1303 0056 8A95      		dec r24
 1304 0058 01F4      		brne 0b
 1305               	.LVL76:
 1306               	.LBB53:
 1307               	.LBI53:
 300:./tmk_core/common/action_tapping.c **** {
 1308               		.loc 1 300 6 view .LVU315
 1309               	.LBB54:
 302:./tmk_core/common/action_tapping.c ****         return true;
 1310               		.loc 1 302 5 view .LVU316
 1311               	.LBB55:
 1312               	.LBI55:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1313               		.loc 2 49 20 view .LVU317
 1314               	.LBB56:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1315               		.loc 2 49 51 view .LVU318
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1316               		.loc 2 49 74 is_stmt 0 view .LVU319
 1317 005a 8A85      		ldd r24,Y+10
 1318 005c 9B85      		ldd r25,Y+11
 1319 005e 892B      		or r24,r25
 1320 0060 01F0      		breq .L149
 1321 0062 8885      		ldd r24,Y+8
 1322 0064 9F81      		ldd r25,Y+7
 1323 0066 8923      		and r24,r25
 1324 0068 8F3F      		cpi r24,lo8(-1)
 1325 006a 01F0      		breq .L149
 1326               	.LBE56:
 1327               	.LBE55:
 306:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1328               		.loc 1 306 5 is_stmt 1 view .LVU320
 306:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1329               		.loc 1 306 30 is_stmt 0 view .LVU321
 1330 006c 2091 0000 		lds r18,waiting_buffer_head
 1331 0070 30E0      		ldi r19,0
 1332 0072 C901      		movw r24,r18
 1333 0074 0196      		adiw r24,1
 306:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1334               		.loc 1 306 35 view .LVU322
 1335 0076 8770      		andi r24,7
 1336 0078 9927      		clr r25
 306:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1337               		.loc 1 306 57 view .LVU323
 1338 007a 4091 0000 		lds r20,waiting_buffer_tail
 306:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1339               		.loc 1 306 8 view .LVU324
 1340 007e 4817      		cp r20,r24
 1341 0080 1906      		cpc __zero_reg__,r25
 1342 0082 01F4      		brne .L173
 1343               	.LVL77:
 306:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1344               		.loc 1 306 8 view .LVU325
 1345               	.LBE54:
 1346               	.LBE53:
  52:./tmk_core/common/action_tapping.c ****             clear_keyboard();
 1347               		.loc 1 52 50 is_stmt 1 view .LVU326
  53:./tmk_core/common/action_tapping.c ****             waiting_buffer_clear();
 1348               		.loc 1 53 13 view .LVU327
 1349 0084 0E94 0000 		call clear_keyboard
 1350               	.LVL78:
  54:./tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 1351               		.loc 1 54 13 view .LVU328
 1352               	.LBB58:
 1353               	.LBI58:
 322:./tmk_core/common/action_tapping.c **** {
 1354               		.loc 1 322 6 view .LVU329
 1355               	.LBB59:
 324:./tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 1356               		.loc 1 324 5 view .LVU330
 324:./tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 1357               		.loc 1 324 25 is_stmt 0 view .LVU331
 1358 0088 1092 0000 		sts waiting_buffer_head,__zero_reg__
 325:./tmk_core/common/action_tapping.c **** }
 1359               		.loc 1 325 5 is_stmt 1 view .LVU332
 325:./tmk_core/common/action_tapping.c **** }
 1360               		.loc 1 325 25 is_stmt 0 view .LVU333
 1361 008c 1092 0000 		sts waiting_buffer_tail,__zero_reg__
 1362               	.LBE59:
 1363               	.LBE58:
  55:./tmk_core/common/action_tapping.c ****         }
 1364               		.loc 1 55 13 is_stmt 1 view .LVU334
  55:./tmk_core/common/action_tapping.c ****         }
 1365               		.loc 1 55 25 is_stmt 0 view .LVU335
 1366 0090 86E0      		ldi r24,lo8(6)
 1367 0092 E0E0      		ldi r30,lo8(tapping_key)
 1368 0094 F0E0      		ldi r31,hi8(tapping_key)
 1369 0096 DF01      		movw r26,r30
 1370               		0:
 1371 0098 1D92      		st X+,__zero_reg__
 1372 009a 8A95      		dec r24
 1373 009c 01F4      		brne 0b
 1374 009e 00C0      		rjmp .L149
 1375               	.LVL79:
 1376               	.L173:
 1377               	.LBB60:
 1378               	.LBB57:
 311:./tmk_core/common/action_tapping.c ****     waiting_buffer_head = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 1379               		.loc 1 311 5 is_stmt 1 view .LVU336
 311:./tmk_core/common/action_tapping.c ****     waiting_buffer_head = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 1380               		.loc 1 311 41 is_stmt 0 view .LVU337
 1381 00a0 96E0      		ldi r25,lo8(6)
 1382               	.LVL80:
 311:./tmk_core/common/action_tapping.c ****     waiting_buffer_head = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 1383               		.loc 1 311 41 view .LVU338
 1384 00a2 929F      		mul r25,r18
 1385 00a4 D001      		movw r26,r0
 1386 00a6 939F      		mul r25,r19
 1387 00a8 B00D      		add r27,r0
 1388 00aa 1124      		clr __zero_reg__
 1389 00ac A050      		subi r26,lo8(-(waiting_buffer))
 1390 00ae B040      		sbci r27,hi8(-(waiting_buffer))
 1391 00b0 FE01      		movw r30,r28
 1392 00b2 3196      		adiw r30,1
 1393               		0:
 1394 00b4 0190      		ld r0,Z+
 1395 00b6 0D92      		st X+,r0
 1396 00b8 9A95      		dec r25
 1397 00ba 01F4      		brne 0b
 312:./tmk_core/common/action_tapping.c **** 
 1398               		.loc 1 312 5 is_stmt 1 view .LVU339
 312:./tmk_core/common/action_tapping.c **** 
 1399               		.loc 1 312 25 is_stmt 0 view .LVU340
 1400 00bc 8093 0000 		sts waiting_buffer_head,r24
 314:./tmk_core/common/action_tapping.c ****     return true;
 1401               		.loc 1 314 34 is_stmt 1 view .LVU341
 314:./tmk_core/common/action_tapping.c ****     return true;
 1402               		.loc 1 314 36 view .LVU342
 1403 00c0 0E94 0000 		call debug_waiting_buffer
 1404               	.LVL81:
 315:./tmk_core/common/action_tapping.c **** }
 1405               		.loc 1 315 5 view .LVU343
 315:./tmk_core/common/action_tapping.c **** }
 1406               		.loc 1 315 5 is_stmt 0 view .LVU344
 1407 00c4 00C0      		rjmp .L149
 1408               	.L154:
 315:./tmk_core/common/action_tapping.c **** }
 1409               		.loc 1 315 5 view .LVU345
 1410               	.LBE57:
 1411               	.LBE60:
  64:./tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
 1412               		.loc 1 64 9 is_stmt 1 view .LVU346
  64:./tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
 1413               		.loc 1 64 13 is_stmt 0 view .LVU347
 1414 00c6 819F      		mul r24,r17
 1415 00c8 C001      		movw r24,r0
 1416 00ca 1124      		clr __zero_reg__
 1417 00cc 8050      		subi r24,lo8(-(waiting_buffer))
 1418 00ce 9040      		sbci r25,hi8(-(waiting_buffer))
 1419 00d0 0E94 0000 		call process_tapping
 1420               	.LVL82:
  64:./tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
 1421               		.loc 1 64 12 view .LVU348
 1422 00d4 8823      		tst r24
 1423 00d6 01F0      		breq .L147
  65:./tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
 1424               		.loc 1 65 48 is_stmt 1 view .LVU349
  65:./tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
 1425               		.loc 1 65 80 view .LVU350
  65:./tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
 1426               		.loc 1 65 95 view .LVU351
  66:./tmk_core/common/action_tapping.c ****         } else {
 1427               		.loc 1 66 13 view .LVU352
 1428 00d8 E091 0000 		lds r30,waiting_buffer_tail
 1429 00dc 1E9F      		mul r17,r30
 1430 00de F001      		movw r30,r0
 1431 00e0 1124      		clr __zero_reg__
 1432 00e2 E050      		subi r30,lo8(-(waiting_buffer))
 1433 00e4 F040      		sbci r31,hi8(-(waiting_buffer))
 1434 00e6 4081      		ld r20,Z
 1435 00e8 5181      		ldd r21,Z+1
 1436 00ea 6281      		ldd r22,Z+2
 1437 00ec 7381      		ldd r23,Z+3
 1438 00ee 8481      		ldd r24,Z+4
 1439 00f0 9581      		ldd r25,Z+5
 1440 00f2 0E94 0000 		call debug_record
 1441               	.LVL83:
  66:./tmk_core/common/action_tapping.c ****         } else {
 1442               		.loc 1 66 77 view .LVU353
  63:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1443               		.loc 1 63 99 is_stmt 0 view .LVU354
 1444 00f6 8091 0000 		lds r24,waiting_buffer_tail
 1445 00fa 90E0      		ldi r25,0
 1446 00fc 0196      		adiw r24,1
  63:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1447               		.loc 1 63 104 view .LVU355
 1448 00fe 8770      		andi r24,7
 1449 0100 9927      		clr r25
  63:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1450               		.loc 1 63 76 view .LVU356
 1451 0102 8093 0000 		sts waiting_buffer_tail,r24
 1452               	.L156:
  63:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1453               		.loc 1 63 32 discriminator 1 view .LVU357
 1454 0106 8091 0000 		lds r24,waiting_buffer_tail
  63:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1455               		.loc 1 63 5 discriminator 1 view .LVU358
 1456 010a 9091 0000 		lds r25,waiting_buffer_head
 1457 010e 8913      		cpse r24,r25
 1458 0110 00C0      		rjmp .L154
 1459               	.L147:
 1460               	/* epilogue start */
  74:./tmk_core/common/action_tapping.c **** 
 1461               		.loc 1 74 1 view .LVU359
 1462 0112 2C96      		adiw r28,12
 1463 0114 0FB6      		in __tmp_reg__,__SREG__
 1464 0116 F894      		cli
 1465 0118 DEBF      		out __SP_H__,r29
 1466 011a 0FBE      		out __SREG__,__tmp_reg__
 1467 011c CDBF      		out __SP_L__,r28
 1468 011e DF91      		pop r29
 1469 0120 CF91      		pop r28
 1470 0122 1F91      		pop r17
 1471 0124 0895      		ret
 1472               	.L171:
  47:./tmk_core/common/action_tapping.c ****         }
 1473               		.loc 1 47 33 is_stmt 1 view .LVU360
  47:./tmk_core/common/action_tapping.c ****         }
 1474               		.loc 1 47 35 view .LVU361
 1475 0126 6985      		ldd r22,Y+9
 1476 0128 7A85      		ldd r23,Y+10
 1477 012a 8B85      		ldd r24,Y+11
 1478 012c 9C85      		ldd r25,Y+12
 1479 012e 0E94 0000 		call debug_record
 1480               	.LVL84:
 1481 0132 00C0      		rjmp .L149
 1482               		.cfi_endproc
 1483               	.LFE4:
 1485               		.section	.bss.waiting_buffer_tail,"aw",@nobits
 1488               	waiting_buffer_tail:
 1489 0000 00        		.zero	1
 1490               		.section	.bss.waiting_buffer_head,"aw",@nobits
 1493               	waiting_buffer_head:
 1494 0000 00        		.zero	1
 1495               		.section	.bss.waiting_buffer,"aw",@nobits
 1498               	waiting_buffer:
 1499 0000 0000 0000 		.zero	48
 1499      0000 0000 
 1499      0000 0000 
 1499      0000 0000 
 1499      0000 0000 
 1500               		.section	.bss.tapping_key,"aw",@nobits
 1503               	tapping_key:
 1504 0000 0000 0000 		.zero	6
 1504      0000 
 1505               		.text
 1506               	.Letext0:
 1507               		.file 3 "/usr/local/Cellar/avr-gcc@8/8.3.0_1/avr/include/stdint.h"
 1508               		.file 4 "./tmk_core/common/keycode.h"
 1509               		.file 5 "./tmk_core/common/action_code.h"
 1510               		.file 6 "./tmk_core/common/action.h"
 1511               		.file 7 "./tmk_core/common/action_layer.h"
 1512               		.file 8 "./tmk_core/common/timer.h"
 1513               		.file 9 "./tmk_core/common/avr/xprintf.h"
 1514               		.file 10 "./tmk_core/common/debug.h"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 action_tapping.c
/var/folders/3d/n9bt7hnj55x7z_fzmyrbdqym0000gp/T//ccnZMQW7.s:2      *ABS*:000000000000003e __SP_H__
/var/folders/3d/n9bt7hnj55x7z_fzmyrbdqym0000gp/T//ccnZMQW7.s:3      *ABS*:000000000000003d __SP_L__
/var/folders/3d/n9bt7hnj55x7z_fzmyrbdqym0000gp/T//ccnZMQW7.s:4      *ABS*:000000000000003f __SREG__
/var/folders/3d/n9bt7hnj55x7z_fzmyrbdqym0000gp/T//ccnZMQW7.s:5      *ABS*:0000000000000000 __tmp_reg__
/var/folders/3d/n9bt7hnj55x7z_fzmyrbdqym0000gp/T//ccnZMQW7.s:6      *ABS*:0000000000000001 __zero_reg__
/var/folders/3d/n9bt7hnj55x7z_fzmyrbdqym0000gp/T//ccnZMQW7.s:12     .text.debug_waiting_buffer:0000000000000000 debug_waiting_buffer
/var/folders/3d/n9bt7hnj55x7z_fzmyrbdqym0000gp/T//ccnZMQW7.s:1488   .bss.waiting_buffer_tail:0000000000000000 waiting_buffer_tail
/var/folders/3d/n9bt7hnj55x7z_fzmyrbdqym0000gp/T//ccnZMQW7.s:1493   .bss.waiting_buffer_head:0000000000000000 waiting_buffer_head
/var/folders/3d/n9bt7hnj55x7z_fzmyrbdqym0000gp/T//ccnZMQW7.s:1498   .bss.waiting_buffer:0000000000000000 waiting_buffer
/var/folders/3d/n9bt7hnj55x7z_fzmyrbdqym0000gp/T//ccnZMQW7.s:94     .text.debug_tapping_key:0000000000000000 debug_tapping_key
/var/folders/3d/n9bt7hnj55x7z_fzmyrbdqym0000gp/T//ccnZMQW7.s:1503   .bss.tapping_key:0000000000000000 tapping_key
/var/folders/3d/n9bt7hnj55x7z_fzmyrbdqym0000gp/T//ccnZMQW7.s:117    .text.waiting_buffer_typed.isra.1:0000000000000000 waiting_buffer_typed.isra.1
/var/folders/3d/n9bt7hnj55x7z_fzmyrbdqym0000gp/T//ccnZMQW7.s:190    .text.waiting_buffer_scan_tap:0000000000000000 waiting_buffer_scan_tap
/var/folders/3d/n9bt7hnj55x7z_fzmyrbdqym0000gp/T//ccnZMQW7.s:369    .text.process_tapping:0000000000000000 process_tapping
/var/folders/3d/n9bt7hnj55x7z_fzmyrbdqym0000gp/T//ccnZMQW7.s:1222   .text.action_tapping_process:0000000000000000 action_tapping_process

UNDEFINED SYMBOLS
debug_record
process_record
layer_switch_get_action
is_tap_key
debug_event
process_record_tap_hint
clear_keyboard
__do_clear_bss
