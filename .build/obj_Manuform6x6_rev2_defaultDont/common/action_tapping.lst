   1               		.file	"action_tapping.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__tmp_reg__ = 0
   6               	__zero_reg__ = 1
   7               		.text
   8               	.Ltext0:
   9               		.cfi_sections	.debug_frame
  10               		.section	.text.debug_waiting_buffer,"ax",@progbits
  12               	debug_waiting_buffer:
  13               	.LFB12:
  14               		.file 1 "./tmk_core/common/action_tapping.c"
   1:./tmk_core/common/action_tapping.c **** #include <stdint.h>
   2:./tmk_core/common/action_tapping.c **** #include <stdbool.h>
   3:./tmk_core/common/action_tapping.c **** #include "action.h"
   4:./tmk_core/common/action_tapping.c **** #include "action_layer.h"
   5:./tmk_core/common/action_tapping.c **** #include "action_tapping.h"
   6:./tmk_core/common/action_tapping.c **** #include "keycode.h"
   7:./tmk_core/common/action_tapping.c **** #include "timer.h"
   8:./tmk_core/common/action_tapping.c **** 
   9:./tmk_core/common/action_tapping.c **** #ifdef DEBUG_ACTION
  10:./tmk_core/common/action_tapping.c **** #include "debug.h"
  11:./tmk_core/common/action_tapping.c **** #else
  12:./tmk_core/common/action_tapping.c **** #include "nodebug.h"
  13:./tmk_core/common/action_tapping.c **** #endif
  14:./tmk_core/common/action_tapping.c **** 
  15:./tmk_core/common/action_tapping.c **** #ifndef NO_ACTION_TAPPING
  16:./tmk_core/common/action_tapping.c **** 
  17:./tmk_core/common/action_tapping.c **** #define IS_TAPPING()            !IS_NOEVENT(tapping_key.event)
  18:./tmk_core/common/action_tapping.c **** #define IS_TAPPING_PRESSED()    (IS_TAPPING() && tapping_key.event.pressed)
  19:./tmk_core/common/action_tapping.c **** #define IS_TAPPING_RELEASED()   (IS_TAPPING() && !tapping_key.event.pressed)
  20:./tmk_core/common/action_tapping.c **** #define IS_TAPPING_KEY(k)       (IS_TAPPING() && KEYEQ(tapping_key.event.key, (k)))
  21:./tmk_core/common/action_tapping.c **** #define WITHIN_TAPPING_TERM(e)  (TIMER_DIFF_16(e.time, tapping_key.event.time) < TAPPING_TERM)
  22:./tmk_core/common/action_tapping.c **** 
  23:./tmk_core/common/action_tapping.c **** 
  24:./tmk_core/common/action_tapping.c **** static keyrecord_t tapping_key = {};
  25:./tmk_core/common/action_tapping.c **** static keyrecord_t waiting_buffer[WAITING_BUFFER_SIZE] = {};
  26:./tmk_core/common/action_tapping.c **** static uint8_t waiting_buffer_head = 0;
  27:./tmk_core/common/action_tapping.c **** static uint8_t waiting_buffer_tail = 0;
  28:./tmk_core/common/action_tapping.c **** 
  29:./tmk_core/common/action_tapping.c **** static bool process_tapping(keyrecord_t *record);
  30:./tmk_core/common/action_tapping.c **** static bool waiting_buffer_enq(keyrecord_t record);
  31:./tmk_core/common/action_tapping.c **** static void waiting_buffer_clear(void);
  32:./tmk_core/common/action_tapping.c **** static bool waiting_buffer_typed(keyevent_t event);
  33:./tmk_core/common/action_tapping.c **** static bool waiting_buffer_has_anykey_pressed(void);
  34:./tmk_core/common/action_tapping.c **** static void waiting_buffer_scan_tap(void);
  35:./tmk_core/common/action_tapping.c **** static void debug_tapping_key(void);
  36:./tmk_core/common/action_tapping.c **** static void debug_waiting_buffer(void);
  37:./tmk_core/common/action_tapping.c **** 
  38:./tmk_core/common/action_tapping.c **** 
  39:./tmk_core/common/action_tapping.c **** /** \brief Action Tapping Process
  40:./tmk_core/common/action_tapping.c ****  *
  41:./tmk_core/common/action_tapping.c ****  * FIXME: Needs doc
  42:./tmk_core/common/action_tapping.c ****  */
  43:./tmk_core/common/action_tapping.c **** void action_tapping_process(keyrecord_t record)
  44:./tmk_core/common/action_tapping.c **** {
  45:./tmk_core/common/action_tapping.c ****     if (process_tapping(&record)) {
  46:./tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
  47:./tmk_core/common/action_tapping.c ****             debug("processed: "); debug_record(record); debug("\n");
  48:./tmk_core/common/action_tapping.c ****         }
  49:./tmk_core/common/action_tapping.c ****     } else {
  50:./tmk_core/common/action_tapping.c ****         if (!waiting_buffer_enq(record)) {
  51:./tmk_core/common/action_tapping.c ****             // clear all in case of overflow.
  52:./tmk_core/common/action_tapping.c ****             debug("OVERFLOW: CLEAR ALL STATES\n");
  53:./tmk_core/common/action_tapping.c ****             clear_keyboard();
  54:./tmk_core/common/action_tapping.c ****             waiting_buffer_clear();
  55:./tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
  56:./tmk_core/common/action_tapping.c ****         }
  57:./tmk_core/common/action_tapping.c ****     }
  58:./tmk_core/common/action_tapping.c **** 
  59:./tmk_core/common/action_tapping.c ****     // process waiting_buffer
  60:./tmk_core/common/action_tapping.c ****     if (!IS_NOEVENT(record.event) && waiting_buffer_head != waiting_buffer_tail) {
  61:./tmk_core/common/action_tapping.c ****         debug("---- action_exec: process waiting_buffer -----\n");
  62:./tmk_core/common/action_tapping.c ****     }
  63:./tmk_core/common/action_tapping.c ****     for (; waiting_buffer_tail != waiting_buffer_head; waiting_buffer_tail = (waiting_buffer_tail +
  64:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
  65:./tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
  66:./tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
  67:./tmk_core/common/action_tapping.c ****         } else {
  68:./tmk_core/common/action_tapping.c ****             break;
  69:./tmk_core/common/action_tapping.c ****         }
  70:./tmk_core/common/action_tapping.c ****     }
  71:./tmk_core/common/action_tapping.c ****     if (!IS_NOEVENT(record.event)) {
  72:./tmk_core/common/action_tapping.c ****         debug("\n");
  73:./tmk_core/common/action_tapping.c ****     }
  74:./tmk_core/common/action_tapping.c **** }
  75:./tmk_core/common/action_tapping.c **** 
  76:./tmk_core/common/action_tapping.c **** 
  77:./tmk_core/common/action_tapping.c **** /** \brief Tapping
  78:./tmk_core/common/action_tapping.c ****  *
  79:./tmk_core/common/action_tapping.c ****  * Rule: Tap key is typed(pressed and released) within TAPPING_TERM.
  80:./tmk_core/common/action_tapping.c ****  *       (without interfering by typing other key)
  81:./tmk_core/common/action_tapping.c ****  */
  82:./tmk_core/common/action_tapping.c **** /* return true when key event is processed or consumed. */
  83:./tmk_core/common/action_tapping.c **** bool process_tapping(keyrecord_t *keyp)
  84:./tmk_core/common/action_tapping.c **** {
  85:./tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
  86:./tmk_core/common/action_tapping.c **** 
  87:./tmk_core/common/action_tapping.c ****     // if tapping
  88:./tmk_core/common/action_tapping.c ****     if (IS_TAPPING_PRESSED()) {
  89:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
  90:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
  91:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
  92:./tmk_core/common/action_tapping.c ****                     // first tap!
  93:./tmk_core/common/action_tapping.c ****                     debug("Tapping: First tap(0->1).\n");
  94:./tmk_core/common/action_tapping.c ****                     tapping_key.tap.count = 1;
  95:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
  96:./tmk_core/common/action_tapping.c ****                     process_record(&tapping_key);
  97:./tmk_core/common/action_tapping.c **** 
  98:./tmk_core/common/action_tapping.c ****                     // copy tapping state
  99:./tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 100:./tmk_core/common/action_tapping.c ****                     // enqueue
 101:./tmk_core/common/action_tapping.c ****                     return false;
 102:./tmk_core/common/action_tapping.c ****                 }
 103:./tmk_core/common/action_tapping.c **** #if TAPPING_TERM >= 500 || defined PERMISSIVE_HOLD
 104:./tmk_core/common/action_tapping.c ****                 /* Process a key typed within TAPPING_TERM
 105:./tmk_core/common/action_tapping.c ****                  * This can register the key before settlement of tapping,
 106:./tmk_core/common/action_tapping.c ****                  * useful for long TAPPING_TERM but may prevent fast typing.
 107:./tmk_core/common/action_tapping.c ****                  */
 108:./tmk_core/common/action_tapping.c ****                 else if (IS_RELEASED(event) && waiting_buffer_typed(event)) {
 109:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. No tap. Interfered by typing key\n");
 110:./tmk_core/common/action_tapping.c ****                     process_record(&tapping_key);
 111:./tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 112:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 113:./tmk_core/common/action_tapping.c ****                     // enqueue
 114:./tmk_core/common/action_tapping.c ****                     return false;
 115:./tmk_core/common/action_tapping.c ****                 }
 116:./tmk_core/common/action_tapping.c **** #endif
 117:./tmk_core/common/action_tapping.c ****                 /* Process release event of a key pressed before tapping starts
 118:./tmk_core/common/action_tapping.c ****                  * Without this unexpected repeating will occur with having fast repeating setting
 119:./tmk_core/common/action_tapping.c ****                  * https://github.com/tmk/tmk_keyboard/issues/60
 120:./tmk_core/common/action_tapping.c ****                  */
 121:./tmk_core/common/action_tapping.c ****                 else if (IS_RELEASED(event) && !waiting_buffer_typed(event)) {
 122:./tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 123:./tmk_core/common/action_tapping.c ****                     action_t action = layer_switch_get_action(event.key);
 124:./tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 125:./tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 126:./tmk_core/common/action_tapping.c ****                         case ACT_RMODS:
 127:./tmk_core/common/action_tapping.c ****                             if (action.key.mods && !action.key.code) return false;
 128:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 129:./tmk_core/common/action_tapping.c ****                             break;
 130:./tmk_core/common/action_tapping.c ****                         case ACT_LMODS_TAP:
 131:./tmk_core/common/action_tapping.c ****                         case ACT_RMODS_TAP:
 132:./tmk_core/common/action_tapping.c ****                             if (action.key.mods && keyp->tap.count == 0) return false;
 133:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 134:./tmk_core/common/action_tapping.c ****                             break;
 135:./tmk_core/common/action_tapping.c ****                     }
 136:./tmk_core/common/action_tapping.c ****                     // Release of key should be process immediately.
 137:./tmk_core/common/action_tapping.c ****                     debug("Tapping: release event of a key pressed before tapping\n");
 138:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 139:./tmk_core/common/action_tapping.c ****                     return true;
 140:./tmk_core/common/action_tapping.c ****                 }
 141:./tmk_core/common/action_tapping.c ****                 else {
 142:./tmk_core/common/action_tapping.c ****                     // set interrupted flag when other key preesed during tapping
 143:./tmk_core/common/action_tapping.c ****                     if (event.pressed) {
 144:./tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 145:./tmk_core/common/action_tapping.c ****                     }
 146:./tmk_core/common/action_tapping.c ****                     // enqueue
 147:./tmk_core/common/action_tapping.c ****                     return false;
 148:./tmk_core/common/action_tapping.c ****                 }
 149:./tmk_core/common/action_tapping.c ****             }
 150:./tmk_core/common/action_tapping.c ****             // tap_count > 0
 151:./tmk_core/common/action_tapping.c ****             else {
 152:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 153:./tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 154:./tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 155:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 156:./tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 157:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 158:./tmk_core/common/action_tapping.c ****                     return true;
 159:./tmk_core/common/action_tapping.c ****                 }
 160:./tmk_core/common/action_tapping.c ****                 else if (is_tap_key(event.key) && event.pressed) {
 161:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 162:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 163:./tmk_core/common/action_tapping.c ****                         // unregister key
 164:./tmk_core/common/action_tapping.c ****                         process_record(&(keyrecord_t){
 165:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 166:./tmk_core/common/action_tapping.c ****                                 .event.key = tapping_key.event.key,
 167:./tmk_core/common/action_tapping.c ****                                 .event.time = event.time,
 168:./tmk_core/common/action_tapping.c ****                                 .event.pressed = false
 169:./tmk_core/common/action_tapping.c ****                         });
 170:./tmk_core/common/action_tapping.c ****                     } else {
 171:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start while last tap(1).\n");
 172:./tmk_core/common/action_tapping.c ****                     }
 173:./tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 174:./tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 175:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 176:./tmk_core/common/action_tapping.c ****                     return true;
 177:./tmk_core/common/action_tapping.c ****                 }
 178:./tmk_core/common/action_tapping.c ****                 else {
 179:./tmk_core/common/action_tapping.c ****                     if (!IS_NOEVENT(event)) {
 180:./tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last tap(>0).\n");
 181:./tmk_core/common/action_tapping.c ****                     }
 182:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 183:./tmk_core/common/action_tapping.c ****                     return true;
 184:./tmk_core/common/action_tapping.c ****                 }
 185:./tmk_core/common/action_tapping.c ****             }
 186:./tmk_core/common/action_tapping.c ****         }
 187:./tmk_core/common/action_tapping.c ****         // after TAPPING_TERM
 188:./tmk_core/common/action_tapping.c ****         else {
 189:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 190:./tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 191:./tmk_core/common/action_tapping.c ****                 debug_event(event); debug("\n");
 192:./tmk_core/common/action_tapping.c ****                 process_record(&tapping_key);
 193:./tmk_core/common/action_tapping.c ****                 tapping_key = (keyrecord_t){};
 194:./tmk_core/common/action_tapping.c ****                 debug_tapping_key();
 195:./tmk_core/common/action_tapping.c ****                 return false;
 196:./tmk_core/common/action_tapping.c ****             }  else {
 197:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 198:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 199:./tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 200:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 201:./tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 202:./tmk_core/common/action_tapping.c ****                     return true;
 203:./tmk_core/common/action_tapping.c ****                 }
 204:./tmk_core/common/action_tapping.c ****                 else if (is_tap_key(event.key) && event.pressed) {
 205:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 206:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last timeout tap(>1).\n");
 207:./tmk_core/common/action_tapping.c ****                         // unregister key
 208:./tmk_core/common/action_tapping.c ****                         process_record(&(keyrecord_t){
 209:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 210:./tmk_core/common/action_tapping.c ****                                 .event.key = tapping_key.event.key,
 211:./tmk_core/common/action_tapping.c ****                                 .event.time = event.time,
 212:./tmk_core/common/action_tapping.c ****                                 .event.pressed = false
 213:./tmk_core/common/action_tapping.c ****                         });
 214:./tmk_core/common/action_tapping.c ****                     } else {
 215:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start while last timeout tap(1).\n");
 216:./tmk_core/common/action_tapping.c ****                     }
 217:./tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 218:./tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 219:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 220:./tmk_core/common/action_tapping.c ****                     return true;
 221:./tmk_core/common/action_tapping.c ****                 }
 222:./tmk_core/common/action_tapping.c ****                 else {
 223:./tmk_core/common/action_tapping.c ****                     if (!IS_NOEVENT(event)) {
 224:./tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last timeout tap(>0).\n");
 225:./tmk_core/common/action_tapping.c ****                     }
 226:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 227:./tmk_core/common/action_tapping.c ****                     return true;
 228:./tmk_core/common/action_tapping.c ****                 }
 229:./tmk_core/common/action_tapping.c ****             }
 230:./tmk_core/common/action_tapping.c ****         }
 231:./tmk_core/common/action_tapping.c ****     } else if (IS_TAPPING_RELEASED()) {
 232:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 233:./tmk_core/common/action_tapping.c ****             if (event.pressed) {
 234:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 235:./tmk_core/common/action_tapping.c **** #ifndef TAPPING_FORCE_HOLD
 236:./tmk_core/common/action_tapping.c ****                     if (!tapping_key.tap.interrupted && tapping_key.tap.count > 0) {
 237:./tmk_core/common/action_tapping.c ****                         // sequential tap.
 238:./tmk_core/common/action_tapping.c ****                         keyp->tap = tapping_key.tap;
 239:./tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 240:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 241:./tmk_core/common/action_tapping.c ****                         process_record(keyp);
 242:./tmk_core/common/action_tapping.c ****                         tapping_key = *keyp;
 243:./tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 244:./tmk_core/common/action_tapping.c ****                         return true;
 245:./tmk_core/common/action_tapping.c ****                     }
 246:./tmk_core/common/action_tapping.c **** #endif
 247:./tmk_core/common/action_tapping.c ****                     // FIX: start new tap again
 248:./tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 249:./tmk_core/common/action_tapping.c ****                     return true;
 250:./tmk_core/common/action_tapping.c ****                 } else if (is_tap_key(event.key)) {
 251:./tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 252:./tmk_core/common/action_tapping.c ****                     debug("Tapping: Start with interfering other tap.\n");
 253:./tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 254:./tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 255:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 256:./tmk_core/common/action_tapping.c ****                     return true;
 257:./tmk_core/common/action_tapping.c ****                 } else {
 258:./tmk_core/common/action_tapping.c ****                     // should none in buffer
 259:./tmk_core/common/action_tapping.c ****                     // FIX: interrupted when other key is pressed
 260:./tmk_core/common/action_tapping.c ****                     tapping_key.tap.interrupted = true;
 261:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 262:./tmk_core/common/action_tapping.c ****                     return true;
 263:./tmk_core/common/action_tapping.c ****                 }
 264:./tmk_core/common/action_tapping.c ****             } else {
 265:./tmk_core/common/action_tapping.c ****                 if (!IS_NOEVENT(event)) debug("Tapping: other key just after tap.\n");
 266:./tmk_core/common/action_tapping.c ****                 process_record(keyp);
 267:./tmk_core/common/action_tapping.c ****                 return true;
 268:./tmk_core/common/action_tapping.c ****             }
 269:./tmk_core/common/action_tapping.c ****         } else {
 270:./tmk_core/common/action_tapping.c ****             // FIX: process_action here?
 271:./tmk_core/common/action_tapping.c ****             // timeout. no sequential tap.
 272:./tmk_core/common/action_tapping.c ****             debug("Tapping: End(Timeout after releasing last tap): ");
 273:./tmk_core/common/action_tapping.c ****             debug_event(event); debug("\n");
 274:./tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 275:./tmk_core/common/action_tapping.c ****             debug_tapping_key();
 276:./tmk_core/common/action_tapping.c ****             return false;
 277:./tmk_core/common/action_tapping.c ****         }
 278:./tmk_core/common/action_tapping.c ****     }
 279:./tmk_core/common/action_tapping.c ****     // not tapping state
 280:./tmk_core/common/action_tapping.c ****     else {
 281:./tmk_core/common/action_tapping.c ****         if (event.pressed && is_tap_key(event.key)) {
 282:./tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 283:./tmk_core/common/action_tapping.c ****             tapping_key = *keyp;
 284:./tmk_core/common/action_tapping.c ****             process_record_tap_hint(&tapping_key);
 285:./tmk_core/common/action_tapping.c ****             waiting_buffer_scan_tap();
 286:./tmk_core/common/action_tapping.c ****             debug_tapping_key();
 287:./tmk_core/common/action_tapping.c ****             return true;
 288:./tmk_core/common/action_tapping.c ****         } else {
 289:./tmk_core/common/action_tapping.c ****             process_record(keyp);
 290:./tmk_core/common/action_tapping.c ****             return true;
 291:./tmk_core/common/action_tapping.c ****         }
 292:./tmk_core/common/action_tapping.c ****     }
 293:./tmk_core/common/action_tapping.c **** }
 294:./tmk_core/common/action_tapping.c **** 
 295:./tmk_core/common/action_tapping.c **** 
 296:./tmk_core/common/action_tapping.c **** /** \brief Waiting buffer enq
 297:./tmk_core/common/action_tapping.c ****  *
 298:./tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 299:./tmk_core/common/action_tapping.c ****  */
 300:./tmk_core/common/action_tapping.c **** bool waiting_buffer_enq(keyrecord_t record)
 301:./tmk_core/common/action_tapping.c **** {
 302:./tmk_core/common/action_tapping.c ****     if (IS_NOEVENT(record.event)) {
 303:./tmk_core/common/action_tapping.c ****         return true;
 304:./tmk_core/common/action_tapping.c ****     }
 305:./tmk_core/common/action_tapping.c **** 
 306:./tmk_core/common/action_tapping.c ****     if ((waiting_buffer_head + 1) % WAITING_BUFFER_SIZE == waiting_buffer_tail) {
 307:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 308:./tmk_core/common/action_tapping.c ****         return false;
 309:./tmk_core/common/action_tapping.c ****     }
 310:./tmk_core/common/action_tapping.c **** 
 311:./tmk_core/common/action_tapping.c ****     waiting_buffer[waiting_buffer_head] = record;
 312:./tmk_core/common/action_tapping.c ****     waiting_buffer_head = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 313:./tmk_core/common/action_tapping.c **** 
 314:./tmk_core/common/action_tapping.c ****     debug("waiting_buffer_enq: "); debug_waiting_buffer();
 315:./tmk_core/common/action_tapping.c ****     return true;
 316:./tmk_core/common/action_tapping.c **** }
 317:./tmk_core/common/action_tapping.c **** 
 318:./tmk_core/common/action_tapping.c **** /** \brief Waiting buffer clear
 319:./tmk_core/common/action_tapping.c ****  *
 320:./tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 321:./tmk_core/common/action_tapping.c ****  */
 322:./tmk_core/common/action_tapping.c **** void waiting_buffer_clear(void)
 323:./tmk_core/common/action_tapping.c **** {
 324:./tmk_core/common/action_tapping.c ****     waiting_buffer_head = 0;
 325:./tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 326:./tmk_core/common/action_tapping.c **** }
 327:./tmk_core/common/action_tapping.c **** 
 328:./tmk_core/common/action_tapping.c **** /** \brief Waiting buffer typed
 329:./tmk_core/common/action_tapping.c ****  *
 330:./tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 331:./tmk_core/common/action_tapping.c ****  */
 332:./tmk_core/common/action_tapping.c **** bool waiting_buffer_typed(keyevent_t event)
 333:./tmk_core/common/action_tapping.c **** {
 334:./tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 335:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 336:./tmk_core/common/action_tapping.c ****             return true;
 337:./tmk_core/common/action_tapping.c ****         }
 338:./tmk_core/common/action_tapping.c ****     }
 339:./tmk_core/common/action_tapping.c ****     return false;
 340:./tmk_core/common/action_tapping.c **** }
 341:./tmk_core/common/action_tapping.c **** 
 342:./tmk_core/common/action_tapping.c **** /** \brief Waiting buffer has anykey pressed
 343:./tmk_core/common/action_tapping.c ****  *
 344:./tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 345:./tmk_core/common/action_tapping.c ****  */
 346:./tmk_core/common/action_tapping.c **** __attribute__((unused))
 347:./tmk_core/common/action_tapping.c **** bool waiting_buffer_has_anykey_pressed(void)
 348:./tmk_core/common/action_tapping.c **** {
 349:./tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 350:./tmk_core/common/action_tapping.c ****         if (waiting_buffer[i].event.pressed) return true;
 351:./tmk_core/common/action_tapping.c ****     }
 352:./tmk_core/common/action_tapping.c ****     return false;
 353:./tmk_core/common/action_tapping.c **** }
 354:./tmk_core/common/action_tapping.c **** 
 355:./tmk_core/common/action_tapping.c **** /** \brief Scan buffer for tapping
 356:./tmk_core/common/action_tapping.c ****  *
 357:./tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 358:./tmk_core/common/action_tapping.c ****  */
 359:./tmk_core/common/action_tapping.c **** void waiting_buffer_scan_tap(void)
 360:./tmk_core/common/action_tapping.c **** {
 361:./tmk_core/common/action_tapping.c ****     // tapping already is settled
 362:./tmk_core/common/action_tapping.c ****     if (tapping_key.tap.count > 0) return;
 363:./tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 364:./tmk_core/common/action_tapping.c ****     if (!tapping_key.event.pressed) return;
 365:./tmk_core/common/action_tapping.c **** 
 366:./tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 367:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 368:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 369:./tmk_core/common/action_tapping.c ****                 WITHIN_TAPPING_TERM(waiting_buffer[i].event)) {
 370:./tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 371:./tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 372:./tmk_core/common/action_tapping.c ****             process_record(&tapping_key);
 373:./tmk_core/common/action_tapping.c **** 
 374:./tmk_core/common/action_tapping.c ****             debug("waiting_buffer_scan_tap: found at ["); debug_dec(i); debug("]\n");
 375:./tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 376:./tmk_core/common/action_tapping.c ****             return;
 377:./tmk_core/common/action_tapping.c ****         }
 378:./tmk_core/common/action_tapping.c ****     }
 379:./tmk_core/common/action_tapping.c **** }
 380:./tmk_core/common/action_tapping.c **** 
 381:./tmk_core/common/action_tapping.c **** 
 382:./tmk_core/common/action_tapping.c **** /** \brief Tapping key debug print
 383:./tmk_core/common/action_tapping.c ****  *
 384:./tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 385:./tmk_core/common/action_tapping.c ****  */
 386:./tmk_core/common/action_tapping.c **** static void debug_tapping_key(void)
 387:./tmk_core/common/action_tapping.c **** {
 388:./tmk_core/common/action_tapping.c ****     debug("TAPPING_KEY="); debug_record(tapping_key); debug("\n");
 389:./tmk_core/common/action_tapping.c **** }
 390:./tmk_core/common/action_tapping.c **** 
 391:./tmk_core/common/action_tapping.c **** /** \brief Waiting buffer debug print
 392:./tmk_core/common/action_tapping.c ****  *
 393:./tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 394:./tmk_core/common/action_tapping.c ****  */
 395:./tmk_core/common/action_tapping.c **** static void debug_waiting_buffer(void)
 396:./tmk_core/common/action_tapping.c **** {
  15               		.loc 1 396 1 view -0
  16               		.cfi_startproc
  17 0000 1F93      		push r17
  18               	.LCFI0:
  19               		.cfi_def_cfa_offset 3
  20               		.cfi_offset 17, -2
  21 0002 CF93      		push r28
  22               	.LCFI1:
  23               		.cfi_def_cfa_offset 4
  24               		.cfi_offset 28, -3
  25 0004 DF93      		push r29
  26               	.LCFI2:
  27               		.cfi_def_cfa_offset 5
  28               		.cfi_offset 29, -4
  29               	/* prologue: function */
  30               	/* frame size = 0 */
  31               	/* stack size = 3 */
  32               	.L__stack_usage = 3
 397:./tmk_core/common/action_tapping.c ****     debug("{ ");
  33               		.loc 1 397 16 view .LVU1
 398:./tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
  34               		.loc 1 398 5 view .LVU2
  35               	.LBB3:
  36               		.loc 1 398 10 view .LVU3
  37               		.loc 1 398 18 is_stmt 0 view .LVU4
  38 0006 C091 0000 		lds r28,waiting_buffer_tail
  39               	.LVL0:
 399:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  40               		.loc 1 399 48 view .LVU5
  41 000a 16E0      		ldi r17,lo8(6)
  42               	.LVL1:
  43               	.L2:
 398:./tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
  44               		.loc 1 398 5 discriminator 1 view .LVU6
  45 000c 8091 0000 		lds r24,waiting_buffer_head
  46 0010 8C13      		cpse r24,r28
  47 0012 00C0      		rjmp .L3
  48               	/* epilogue start */
  49               	.LBE3:
 400:./tmk_core/common/action_tapping.c ****     }
 401:./tmk_core/common/action_tapping.c ****     debug("}\n");
 402:./tmk_core/common/action_tapping.c **** }
  50               		.loc 1 402 1 view .LVU7
  51 0014 DF91      		pop r29
  52 0016 CF91      		pop r28
  53               	.LVL2:
  54               		.loc 1 402 1 view .LVU8
  55 0018 1F91      		pop r17
  56 001a 0895      		ret
  57               	.LVL3:
  58               	.L3:
  59               	.LBB4:
 399:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  60               		.loc 1 399 19 is_stmt 1 discriminator 3 view .LVU9
 399:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  61               		.loc 1 399 33 discriminator 3 view .LVU10
 399:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  62               		.loc 1 399 46 discriminator 3 view .LVU11
 399:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  63               		.loc 1 399 48 discriminator 3 view .LVU12
  64 001c D0E0      		ldi r29,0
  65 001e 1C9F      		mul r17,r28
  66 0020 F001      		movw r30,r0
  67 0022 1D9F      		mul r17,r29
  68 0024 F00D      		add r31,r0
  69 0026 1124      		clr __zero_reg__
  70 0028 E050      		subi r30,lo8(-(waiting_buffer))
  71 002a F040      		sbci r31,hi8(-(waiting_buffer))
  72 002c 4081      		ld r20,Z
  73 002e 5181      		ldd r21,Z+1
  74 0030 6281      		ldd r22,Z+2
  75 0032 7381      		ldd r23,Z+3
  76 0034 8481      		ldd r24,Z+4
  77 0036 9581      		ldd r25,Z+5
  78 0038 0E94 0000 		call debug_record
  79               	.LVL4:
 399:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  80               		.loc 1 399 91 discriminator 3 view .LVU13
 398:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  81               		.loc 1 398 76 is_stmt 0 discriminator 3 view .LVU14
  82 003c 2196      		adiw r28,1
  83               	.LVL5:
 398:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  84               		.loc 1 398 71 discriminator 3 view .LVU15
  85 003e C770      		andi r28,lo8(7)
 398:./tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  86               		.loc 1 398 71 discriminator 3 view .LVU16
  87 0040 00C0      		rjmp .L2
  88               	.LBE4:
  89               		.cfi_endproc
  90               	.LFE12:
  92               		.section	.text.debug_tapping_key,"ax",@progbits
  94               	debug_tapping_key:
  95               	.LFB11:
 387:./tmk_core/common/action_tapping.c ****     debug("TAPPING_KEY="); debug_record(tapping_key); debug("\n");
  96               		.loc 1 387 1 is_stmt 1 view -0
  97               		.cfi_startproc
  98               	/* prologue: function */
  99               	/* frame size = 0 */
 100               	/* stack size = 0 */
 101               	.L__stack_usage = 0
 388:./tmk_core/common/action_tapping.c **** }
 102               		.loc 1 388 26 view .LVU18
 388:./tmk_core/common/action_tapping.c **** }
 103               		.loc 1 388 28 view .LVU19
 104 0000 4091 0000 		lds r20,tapping_key
 105 0004 5091 0000 		lds r21,tapping_key+1
 106 0008 6091 0000 		lds r22,tapping_key+2
 107 000c 7091 0000 		lds r23,tapping_key+3
 108 0010 8091 0000 		lds r24,tapping_key+4
 109 0014 9091 0000 		lds r25,tapping_key+5
 110 0018 0C94 0000 		jmp debug_record
 111               	.LVL6:
 112               		.cfi_endproc
 113               	.LFE11:
 115               		.section	.text.waiting_buffer_scan_tap,"ax",@progbits
 117               	waiting_buffer_scan_tap:
 118               	.LFB10:
 360:./tmk_core/common/action_tapping.c ****     // tapping already is settled
 119               		.loc 1 360 1 view -0
 120               		.cfi_startproc
 121 0000 1F93      		push r17
 122               	.LCFI3:
 123               		.cfi_def_cfa_offset 3
 124               		.cfi_offset 17, -2
 125 0002 CF93      		push r28
 126               	.LCFI4:
 127               		.cfi_def_cfa_offset 4
 128               		.cfi_offset 28, -3
 129 0004 DF93      		push r29
 130               	.LCFI5:
 131               		.cfi_def_cfa_offset 5
 132               		.cfi_offset 29, -4
 133               	/* prologue: function */
 134               	/* frame size = 0 */
 135               	/* stack size = 3 */
 136               	.L__stack_usage = 3
 362:./tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 137               		.loc 1 362 5 view .LVU21
 362:./tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 138               		.loc 1 362 31 is_stmt 0 view .LVU22
 139 0006 8091 0000 		lds r24,tapping_key+5
 140 000a 807F      		andi r24,lo8(-16)
 362:./tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 141               		.loc 1 362 8 view .LVU23
 142 000c 01F4      		brne .L5
 364:./tmk_core/common/action_tapping.c **** 
 143               		.loc 1 364 5 is_stmt 1 view .LVU24
 364:./tmk_core/common/action_tapping.c **** 
 144               		.loc 1 364 8 is_stmt 0 view .LVU25
 145 000e 8091 0000 		lds r24,tapping_key+2
 146 0012 8823      		tst r24
 147 0014 01F0      		breq .L5
 366:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 148               		.loc 1 366 5 is_stmt 1 view .LVU26
 149               	.LBB8:
 366:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 150               		.loc 1 366 10 view .LVU27
 366:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 151               		.loc 1 366 18 is_stmt 0 view .LVU28
 152 0016 8091 0000 		lds r24,waiting_buffer_tail
 153               	.LVL7:
 366:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 154               		.loc 1 366 45 view .LVU29
 155 001a C091 0000 		lds r28,waiting_buffer_head
 367:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 156               		.loc 1 367 13 view .LVU30
 157 001e 6091 0000 		lds r22,tapping_key
 158 0022 7091 0000 		lds r23,tapping_key+1
 159 0026 4091 0000 		lds r20,tapping_key+3
 160 002a 5091 0000 		lds r21,tapping_key+3+1
 161 002e D62F      		mov r29,r22
 162 0030 D723      		and r29,r23
 163 0032 DA01      		movw r26,r20
 164 0034 A095      		com r26
 165 0036 B095      		com r27
 166 0038 16E0      		ldi r17,lo8(6)
 167               	.LVL8:
 168               	.L7:
 366:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 169               		.loc 1 366 5 discriminator 1 view .LVU31
 170 003a C813      		cpse r28,r24
 171 003c 00C0      		rjmp .L14
 172               	.LVL9:
 173               	.L5:
 174               	/* epilogue start */
 366:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 175               		.loc 1 366 5 discriminator 1 view .LVU32
 176               	.LBE8:
 379:./tmk_core/common/action_tapping.c **** 
 177               		.loc 1 379 1 view .LVU33
 178 003e DF91      		pop r29
 179 0040 CF91      		pop r28
 180 0042 1F91      		pop r17
 181 0044 0895      		ret
 182               	.LVL10:
 183               	.L14:
 184               	.LBB11:
 367:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 185               		.loc 1 367 9 is_stmt 1 view .LVU34
 186               	.LBB9:
 187               	.LBI9:
 188               		.file 2 "./tmk_core/common/keyboard.h"
   1:./tmk_core/common/keyboard.h **** /*
   2:./tmk_core/common/keyboard.h **** Copyright 2011,2012,2013 Jun Wako <wakojun@gmail.com>
   3:./tmk_core/common/keyboard.h **** 
   4:./tmk_core/common/keyboard.h **** This program is free software: you can redistribute it and/or modify
   5:./tmk_core/common/keyboard.h **** it under the terms of the GNU General Public License as published by
   6:./tmk_core/common/keyboard.h **** the Free Software Foundation, either version 2 of the License, or
   7:./tmk_core/common/keyboard.h **** (at your option) any later version.
   8:./tmk_core/common/keyboard.h **** 
   9:./tmk_core/common/keyboard.h **** This program is distributed in the hope that it will be useful,
  10:./tmk_core/common/keyboard.h **** but WITHOUT ANY WARRANTY; without even the implied warranty of
  11:./tmk_core/common/keyboard.h **** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  12:./tmk_core/common/keyboard.h **** GNU General Public License for more details.
  13:./tmk_core/common/keyboard.h **** 
  14:./tmk_core/common/keyboard.h **** You should have received a copy of the GNU General Public License
  15:./tmk_core/common/keyboard.h **** along with this program.  If not, see <http://www.gnu.org/licenses/>.
  16:./tmk_core/common/keyboard.h **** */
  17:./tmk_core/common/keyboard.h **** 
  18:./tmk_core/common/keyboard.h **** #ifndef KEYBOARD_H
  19:./tmk_core/common/keyboard.h **** #define KEYBOARD_H
  20:./tmk_core/common/keyboard.h **** 
  21:./tmk_core/common/keyboard.h **** #include <stdbool.h>
  22:./tmk_core/common/keyboard.h **** #include <stdint.h>
  23:./tmk_core/common/keyboard.h **** 
  24:./tmk_core/common/keyboard.h **** 
  25:./tmk_core/common/keyboard.h **** #ifdef __cplusplus
  26:./tmk_core/common/keyboard.h **** extern "C" {
  27:./tmk_core/common/keyboard.h **** #endif
  28:./tmk_core/common/keyboard.h **** 
  29:./tmk_core/common/keyboard.h **** /* key matrix position */
  30:./tmk_core/common/keyboard.h **** typedef struct {
  31:./tmk_core/common/keyboard.h ****     uint8_t col;
  32:./tmk_core/common/keyboard.h ****     uint8_t row;
  33:./tmk_core/common/keyboard.h **** } keypos_t;
  34:./tmk_core/common/keyboard.h **** 
  35:./tmk_core/common/keyboard.h **** /* key event */
  36:./tmk_core/common/keyboard.h **** typedef struct {
  37:./tmk_core/common/keyboard.h ****     keypos_t key;
  38:./tmk_core/common/keyboard.h ****     bool     pressed;
  39:./tmk_core/common/keyboard.h ****     uint16_t time;
  40:./tmk_core/common/keyboard.h **** } keyevent_t;
  41:./tmk_core/common/keyboard.h **** 
  42:./tmk_core/common/keyboard.h **** /* equivalent test of keypos_t */
  43:./tmk_core/common/keyboard.h **** #define KEYEQ(keya, keyb)       ((keya).row == (keyb).row && (keya).col == (keyb).col)
  44:./tmk_core/common/keyboard.h **** 
  45:./tmk_core/common/keyboard.h **** /* Rules for No Event:
  46:./tmk_core/common/keyboard.h ****  * 1) (time == 0) to handle (keyevent_t){} as empty event
  47:./tmk_core/common/keyboard.h ****  * 2) Matrix(255, 255) to make TICK event available
  48:./tmk_core/common/keyboard.h ****  */
  49:./tmk_core/common/keyboard.h **** static inline bool IS_NOEVENT(keyevent_t event) { return event.time == 0 || (event.key.row == 255 &
 189               		.loc 2 49 20 view .LVU35
 190               	.LBB10:
 191               		.loc 2 49 51 view .LVU36
 192 0046 90E0      		ldi r25,0
 193               		.loc 2 49 74 is_stmt 0 view .LVU37
 194 0048 4115      		cp r20,__zero_reg__
 195 004a 5105      		cpc r21,__zero_reg__
 196 004c 01F0      		breq .L8
 197 004e DF3F      		cpi r29,lo8(-1)
 198 0050 01F4      		brne .L27
 199               	.L8:
 200               	.LBE10:
 201               	.LBE9:
 366:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 202               		.loc 1 366 76 discriminator 2 view .LVU38
 203 0052 0196      		adiw r24,1
 204               	.LVL11:
 366:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 205               		.loc 1 366 71 discriminator 2 view .LVU39
 206 0054 8770      		andi r24,lo8(7)
 366:./tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 207               		.loc 1 366 71 discriminator 2 view .LVU40
 208 0056 00C0      		rjmp .L7
 209               	.LVL12:
 210               	.L10:
 369:./tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 211               		.loc 1 369 17 discriminator 2 view .LVU41
 212 0058 2A0F      		add r18,r26
 213 005a 3B1F      		adc r19,r27
 214 005c 00C0      		rjmp .L28
 215               	.L27:
 367:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 216               		.loc 1 367 13 view .LVU42
 217 005e 189F      		mul r17,r24
 218 0060 F001      		movw r30,r0
 219 0062 199F      		mul r17,r25
 220 0064 F00D      		add r31,r0
 221 0066 1124      		clr __zero_reg__
 222 0068 E050      		subi r30,lo8(-(waiting_buffer))
 223 006a F040      		sbci r31,hi8(-(waiting_buffer))
 224 006c 2181      		ldd r18,Z+1
 225 006e 2713      		cpse r18,r23
 226 0070 00C0      		rjmp .L8
 367:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 227               		.loc 1 367 13 discriminator 2 view .LVU43
 228 0072 2081      		ld r18,Z
 229 0074 2613      		cpse r18,r22
 230 0076 00C0      		rjmp .L8
 367:./tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 231               		.loc 1 367 57 discriminator 3 view .LVU44
 232 0078 2281      		ldd r18,Z+2
 233 007a 2111      		cpse r18,__zero_reg__
 234 007c 00C0      		rjmp .L8
 369:./tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 235               		.loc 1 369 17 view .LVU45
 236 007e 2381      		ldd r18,Z+3
 237 0080 3481      		ldd r19,Z+4
 238 0082 2417      		cp r18,r20
 239 0084 3507      		cpc r19,r21
 240 0086 00F0      		brlo .L10
 369:./tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 241               		.loc 1 369 17 discriminator 1 view .LVU46
 242 0088 241B      		sub r18,r20
 243 008a 350B      		sbc r19,r21
 244               	.L28:
 369:./tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 245               		.loc 1 369 17 discriminator 2 view .LVU47
 246 008c 283C      		cpi r18,-56
 247 008e 3105      		cpc r19,__zero_reg__
 248 0090 00F4      		brsh .L8
 370:./tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 249               		.loc 1 370 13 is_stmt 1 view .LVU48
 370:./tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 250               		.loc 1 370 35 is_stmt 0 view .LVU49
 251 0092 2091 0000 		lds r18,tapping_key+5
 252 0096 2F70      		andi r18,lo8(15)
 253 0098 2061      		ori r18,lo8(16)
 254 009a 2093 0000 		sts tapping_key+5,r18
 371:./tmk_core/common/action_tapping.c ****             process_record(&tapping_key);
 255               		.loc 1 371 13 is_stmt 1 view .LVU50
 371:./tmk_core/common/action_tapping.c ****             process_record(&tapping_key);
 256               		.loc 1 371 41 is_stmt 0 view .LVU51
 257 009e 26E0      		ldi r18,lo8(6)
 258 00a0 289F      		mul r18,r24
 259 00a2 F001      		movw r30,r0
 260 00a4 299F      		mul r18,r25
 261 00a6 F00D      		add r31,r0
 262 00a8 1124      		clr __zero_reg__
 263 00aa E050      		subi r30,lo8(-(waiting_buffer+5))
 264 00ac F040      		sbci r31,hi8(-(waiting_buffer+5))
 265 00ae 8081      		ld r24,Z
 266               	.LVL13:
 371:./tmk_core/common/action_tapping.c ****             process_record(&tapping_key);
 267               		.loc 1 371 41 view .LVU52
 268 00b0 8F70      		andi r24,lo8(15)
 269 00b2 8061      		ori r24,lo8(16)
 270 00b4 8083      		st Z,r24
 372:./tmk_core/common/action_tapping.c **** 
 271               		.loc 1 372 13 is_stmt 1 view .LVU53
 272 00b6 80E0      		ldi r24,lo8(tapping_key)
 273 00b8 90E0      		ldi r25,hi8(tapping_key)
 274 00ba 0E94 0000 		call process_record
 275               	.LVL14:
 374:./tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 276               		.loc 1 374 57 view .LVU54
 374:./tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 277               		.loc 1 374 71 view .LVU55
 374:./tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 278               		.loc 1 374 85 view .LVU56
 375:./tmk_core/common/action_tapping.c ****             return;
 279               		.loc 1 375 13 view .LVU57
 280               	/* epilogue start */
 281               	.LBE11:
 379:./tmk_core/common/action_tapping.c **** 
 282               		.loc 1 379 1 is_stmt 0 view .LVU58
 283 00be DF91      		pop r29
 284 00c0 CF91      		pop r28
 285 00c2 1F91      		pop r17
 286               	.LBB12:
 375:./tmk_core/common/action_tapping.c ****             return;
 287               		.loc 1 375 13 view .LVU59
 288 00c4 0C94 0000 		jmp debug_waiting_buffer
 289               	.LVL15:
 290               	.LBE12:
 291               		.cfi_endproc
 292               	.LFE10:
 294               		.section	.text.process_tapping,"ax",@progbits
 296               	process_tapping:
 297               	.LVL16:
 298               	.LFB5:
  84:./tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
 299               		.loc 1 84 1 is_stmt 1 view -0
 300               		.cfi_startproc
  84:./tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
 301               		.loc 1 84 1 is_stmt 0 view .LVU61
 302 0000 BF92      		push r11
 303               	.LCFI6:
 304               		.cfi_def_cfa_offset 3
 305               		.cfi_offset 11, -2
 306 0002 CF92      		push r12
 307               	.LCFI7:
 308               		.cfi_def_cfa_offset 4
 309               		.cfi_offset 12, -3
 310 0004 DF92      		push r13
 311               	.LCFI8:
 312               		.cfi_def_cfa_offset 5
 313               		.cfi_offset 13, -4
 314 0006 EF92      		push r14
 315               	.LCFI9:
 316               		.cfi_def_cfa_offset 6
 317               		.cfi_offset 14, -5
 318 0008 FF92      		push r15
 319               	.LCFI10:
 320               		.cfi_def_cfa_offset 7
 321               		.cfi_offset 15, -6
 322 000a 0F93      		push r16
 323               	.LCFI11:
 324               		.cfi_def_cfa_offset 8
 325               		.cfi_offset 16, -7
 326 000c 1F93      		push r17
 327               	.LCFI12:
 328               		.cfi_def_cfa_offset 9
 329               		.cfi_offset 17, -8
 330 000e CF93      		push r28
 331               	.LCFI13:
 332               		.cfi_def_cfa_offset 10
 333               		.cfi_offset 28, -9
 334 0010 DF93      		push r29
 335               	.LCFI14:
 336               		.cfi_def_cfa_offset 11
 337               		.cfi_offset 29, -10
 338 0012 CDB7      		in r28,__SP_L__
 339 0014 DEB7      		in r29,__SP_H__
 340               	.LCFI15:
 341               		.cfi_def_cfa_register 28
 342 0016 6197      		sbiw r28,17
 343               	.LCFI16:
 344               		.cfi_def_cfa_offset 28
 345 0018 0FB6      		in __tmp_reg__,__SREG__
 346 001a F894      		cli
 347 001c DEBF      		out __SP_H__,r29
 348 001e 0FBE      		out __SREG__,__tmp_reg__
 349 0020 CDBF      		out __SP_L__,r28
 350               	/* prologue: function */
 351               	/* frame size = 17 */
 352               	/* stack size = 26 */
 353               	.L__stack_usage = 26
 354 0022 8C01      		movw r16,r24
  85:./tmk_core/common/action_tapping.c **** 
 355               		.loc 1 85 5 is_stmt 1 view .LVU62
  85:./tmk_core/common/action_tapping.c **** 
 356               		.loc 1 85 16 is_stmt 0 view .LVU63
 357 0024 85E0      		ldi r24,lo8(5)
 358               	.LVL17:
  85:./tmk_core/common/action_tapping.c **** 
 359               		.loc 1 85 16 view .LVU64
 360 0026 F801      		movw r30,r16
 361 0028 DE01      		movw r26,r28
 362 002a 1D96      		adiw r26,13
 363               		0:
 364 002c 0190      		ld r0,Z+
 365 002e 0D92      		st X+,r0
 366 0030 8A95      		dec r24
 367 0032 01F4      		brne 0b
 368 0034 D801      		movw r26,r16
 369 0036 4C91      		ld r20,X
 370               	.LVL18:
  85:./tmk_core/common/action_tapping.c **** 
 371               		.loc 1 85 16 view .LVU65
 372 0038 1196      		adiw r26,1
 373 003a 5C91      		ld r21,X
 374 003c 1197      		sbiw r26,1
 375               	.LVL19:
  85:./tmk_core/common/action_tapping.c **** 
 376               		.loc 1 85 16 view .LVU66
 377 003e 1296      		adiw r26,2
 378 0040 EC90      		ld r14,X
 379 0042 1297      		sbiw r26,2
 380               	.LVL20:
  88:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 381               		.loc 1 88 5 is_stmt 1 view .LVU67
  88:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 382               		.loc 1 88 9 is_stmt 0 view .LVU68
 383 0044 8091 0000 		lds r24,tapping_key+3
 384 0048 9091 0000 		lds r25,tapping_key+3+1
 385               	.LBB23:
 386               	.LBI23:
 387               		.loc 2 49 20 is_stmt 1 view .LVU69
 388               	.LBB24:
 389               		.loc 2 49 51 view .LVU70
 390               		.loc 2 49 74 is_stmt 0 view .LVU71
 391 004c 0097      		sbiw r24,0
 392 004e 01F4      		brne .+2
 393 0050 00C0      		rjmp .L30
 394               	.LBE24:
 395               	.LBE23:
  88:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 396               		.loc 1 88 9 view .LVU72
 397 0052 2091 0000 		lds r18,tapping_key
 398 0056 3091 0000 		lds r19,tapping_key+1
 399               	.LBB26:
 400               	.LBB25:
 401               		.loc 2 49 74 view .LVU73
 402 005a 622F      		mov r22,r18
 403 005c 6323      		and r22,r19
 404 005e 6F3F      		cpi r22,lo8(-1)
 405 0060 01F4      		brne .+2
 406 0062 00C0      		rjmp .L30
 407               	.LBE25:
 408               	.LBE26:
  85:./tmk_core/common/action_tapping.c **** 
 409               		.loc 1 85 16 discriminator 1 view .LVU74
 410 0064 1396      		adiw r26,3
 411 0066 CD90      		ld r12,X+
 412 0068 DC90      		ld r13,X
  88:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 413               		.loc 1 88 9 discriminator 1 view .LVU75
 414 006a B090 0000 		lds r11,tapping_key+2
 415 006e BB20      		tst r11
 416 0070 01F4      		brne .+2
 417 0072 00C0      		rjmp .L31
  89:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 418               		.loc 1 89 9 is_stmt 1 view .LVU76
  89:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 419               		.loc 1 89 13 is_stmt 0 view .LVU77
 420 0074 C816      		cp r12,r24
 421 0076 D906      		cpc r13,r25
 422 0078 00F0      		brlo .L32
  89:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 423               		.loc 1 89 13 discriminator 1 view .LVU78
 424 007a F601      		movw r30,r12
 425 007c E81B      		sub r30,r24
 426 007e F90B      		sbc r31,r25
 427 0080 CF01      		movw r24,r30
 428               	.L123:
  89:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 429               		.loc 1 89 13 discriminator 2 view .LVU79
 430 0082 FF24      		clr r15
 431 0084 F394      		inc r15
 432 0086 883C      		cpi r24,-56
 433 0088 9105      		cpc r25,__zero_reg__
 434 008a 00F0      		brlo .L34
 435 008c F12C      		mov r15,__zero_reg__
 436               	.L34:
 437 008e 8091 0000 		lds r24,tapping_key+5
 438 0092 982F      		mov r25,r24
 439 0094 907F      		andi r25,lo8(-16)
  89:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 440               		.loc 1 89 12 discriminator 4 view .LVU80
 441 0096 FF20      		tst r15
 442 0098 01F4      		brne .+2
 443 009a 00C0      		rjmp .L36
  90:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 444               		.loc 1 90 13 is_stmt 1 view .LVU81
  90:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 445               		.loc 1 90 16 is_stmt 0 view .LVU82
 446 009c 9111      		cpse r25,__zero_reg__
 447 009e 00C0      		rjmp .L37
  91:./tmk_core/common/action_tapping.c ****                     // first tap!
 448               		.loc 1 91 17 is_stmt 1 discriminator 1 view .LVU83
 449 00a0 FE2C      		mov r15,r14
  91:./tmk_core/common/action_tapping.c ****                     // first tap!
 450               		.loc 1 91 21 is_stmt 0 discriminator 1 view .LVU84
 451 00a2 3513      		cpse r19,r21
 452 00a4 00C0      		rjmp .L38
  91:./tmk_core/common/action_tapping.c ****                     // first tap!
 453               		.loc 1 91 21 discriminator 2 view .LVU85
 454 00a6 2413      		cpse r18,r20
 455 00a8 00C0      		rjmp .L38
  91:./tmk_core/common/action_tapping.c ****                     // first tap!
 456               		.loc 1 91 47 discriminator 3 view .LVU86
 457 00aa E110      		cpse r14,__zero_reg__
 458 00ac 00C0      		rjmp .L38
  93:./tmk_core/common/action_tapping.c ****                     tapping_key.tap.count = 1;
 459               		.loc 1 93 57 is_stmt 1 view .LVU87
  94:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 460               		.loc 1 94 21 view .LVU88
  94:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 461               		.loc 1 94 43 is_stmt 0 view .LVU89
 462 00ae 8F70      		andi r24,lo8(15)
 463 00b0 8061      		ori r24,lo8(16)
 464 00b2 8093 0000 		sts tapping_key+5,r24
 465               	.LVL21:
  95:./tmk_core/common/action_tapping.c ****                     process_record(&tapping_key);
 466               		.loc 1 95 21 is_stmt 1 view .LVU90
 467 00b6 0E94 0000 		call debug_tapping_key
 468               	.LVL22:
  96:./tmk_core/common/action_tapping.c **** 
 469               		.loc 1 96 21 view .LVU91
 470 00ba 80E0      		ldi r24,lo8(tapping_key)
 471 00bc 90E0      		ldi r25,hi8(tapping_key)
 472 00be 0E94 0000 		call process_record
 473               	.LVL23:
  99:./tmk_core/common/action_tapping.c ****                     // enqueue
 474               		.loc 1 99 21 view .LVU92
  99:./tmk_core/common/action_tapping.c ****                     // enqueue
 475               		.loc 1 99 31 is_stmt 0 view .LVU93
 476 00c2 8091 0000 		lds r24,tapping_key+5
 477 00c6 D801      		movw r26,r16
 478 00c8 1596      		adiw r26,5
 479 00ca 8C93      		st X,r24
 101:./tmk_core/common/action_tapping.c ****                 }
 480               		.loc 1 101 21 is_stmt 1 view .LVU94
 481               	.LVL24:
 482               	.L29:
 293:./tmk_core/common/action_tapping.c **** 
 483               		.loc 1 293 1 is_stmt 0 view .LVU95
 484 00cc 8F2D      		mov r24,r15
 485               	/* epilogue start */
 293:./tmk_core/common/action_tapping.c **** 
 486               		.loc 1 293 1 view .LVU96
 487 00ce 6196      		adiw r28,17
 488 00d0 0FB6      		in __tmp_reg__,__SREG__
 489 00d2 F894      		cli
 490 00d4 DEBF      		out __SP_H__,r29
 491 00d6 0FBE      		out __SREG__,__tmp_reg__
 492 00d8 CDBF      		out __SP_L__,r28
 493 00da DF91      		pop r29
 494 00dc CF91      		pop r28
 495 00de 1F91      		pop r17
 496 00e0 0F91      		pop r16
 497               	.LVL25:
 293:./tmk_core/common/action_tapping.c **** 
 498               		.loc 1 293 1 view .LVU97
 499 00e2 FF90      		pop r15
 500 00e4 EF90      		pop r14
 501               	.LVL26:
 293:./tmk_core/common/action_tapping.c **** 
 502               		.loc 1 293 1 view .LVU98
 503 00e6 DF90      		pop r13
 504 00e8 CF90      		pop r12
 505 00ea BF90      		pop r11
 506 00ec 0895      		ret
 507               	.LVL27:
 508               	.L32:
  89:./tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 509               		.loc 1 89 13 discriminator 2 view .LVU99
 510 00ee 8095      		com r24
 511 00f0 9095      		com r25
 512 00f2 8C0D      		add r24,r12
 513 00f4 9D1D      		adc r25,r13
 514 00f6 00C0      		rjmp .L123
 515               	.L38:
 121:./tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 516               		.loc 1 121 22 is_stmt 1 view .LVU100
 517               	.LVL28:
 518               	.LBB27:
 519               	.LBI27:
  50:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
  51:./tmk_core/common/keyboard.h **** static inline bool IS_RELEASED(keyevent_t event) { return (!IS_NOEVENT(event) && !event.pressed); }
 520               		.loc 2 51 20 view .LVU101
 521               	.LBB28:
 522               		.loc 2 51 52 view .LVU102
 523               	.LBB29:
 524               	.LBI29:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 525               		.loc 2 49 20 view .LVU103
 526               	.LBB30:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 527               		.loc 2 49 51 view .LVU104
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 528               		.loc 2 49 74 is_stmt 0 view .LVU105
 529 00f8 CD28      		or r12,r13
 530 00fa 01F0      		breq .L69
 531 00fc 852F      		mov r24,r21
 532 00fe 8423      		and r24,r20
 533 0100 8F3F      		cpi r24,lo8(-1)
 534 0102 01F0      		breq .+2
 535 0104 00C0      		rjmp .L41
 536               	.L69:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 537               		.loc 2 49 74 view .LVU106
 538               	.LBE30:
 539               	.LBE29:
 540               		.loc 2 51 79 view .LVU107
 541 0106 80E0      		ldi r24,0
 542               	.L40:
 543               	.LVL29:
 544               		.loc 2 51 79 view .LVU108
 545               	.LBE28:
 546               	.LBE27:
 121:./tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 547               		.loc 1 121 25 view .LVU109
 548 0108 B82F      		mov r27,r24
 549 010a B170      		andi r27,lo8(1)
 550 010c DB2E      		mov r13,r27
 551 010e 80FF      		sbrs r24,0
 552 0110 00C0      		rjmp .L42
 553               	.LBB32:
 554               	.LBI32:
 332:./tmk_core/common/action_tapping.c **** {
 555               		.loc 1 332 6 is_stmt 1 discriminator 1 view .LVU110
 556               	.LBE32:
 334:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 557               		.loc 1 334 5 discriminator 1 view .LVU111
 558               	.LBB35:
 559               	.LBB33:
 334:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 560               		.loc 1 334 10 discriminator 1 view .LVU112
 334:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 561               		.loc 1 334 18 is_stmt 0 discriminator 1 view .LVU113
 562 0112 8091 0000 		lds r24,waiting_buffer_tail
 563               	.LVL30:
 334:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 564               		.loc 1 334 45 discriminator 1 view .LVU114
 565 0116 2091 0000 		lds r18,waiting_buffer_head
 335:./tmk_core/common/action_tapping.c ****             return true;
 566               		.loc 1 335 13 discriminator 1 view .LVU115
 567 011a 36E0      		ldi r19,lo8(6)
 568               	.LVL31:
 569               	.L43:
 334:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 570               		.loc 1 334 5 view .LVU116
 571 011c 8213      		cpse r24,r18
 572 011e 00C0      		rjmp .L45
 573               	.LVL32:
 334:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 574               		.loc 1 334 5 view .LVU117
 575               	.LBE33:
 576               	.LBE35:
 577               	.LBB36:
 123:./tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 578               		.loc 1 123 21 is_stmt 1 view .LVU118
 123:./tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 579               		.loc 1 123 39 is_stmt 0 view .LVU119
 580 0120 4D87      		std Y+13,r20
 581 0122 5E87      		std Y+14,r21
 582 0124 8D85      		ldd r24,Y+13
 583 0126 9E85      		ldd r25,Y+14
 584 0128 0E94 0000 		call layer_switch_get_action
 585               	.LVL33:
 124:./tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 586               		.loc 1 124 21 is_stmt 1 view .LVU120
 124:./tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 587               		.loc 1 124 40 is_stmt 0 view .LVU121
 588 012c 292F      		mov r18,r25
 589 012e 2295      		swap r18
 590 0130 2F70      		andi r18,lo8(15)
 124:./tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 591               		.loc 1 124 21 view .LVU122
 592 0132 2230      		cpi r18,lo8(2)
 593 0134 00F0      		brlo .L67
 124:./tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 594               		.loc 1 124 21 view .LVU123
 595 0136 2430      		cpi r18,lo8(4)
 596 0138 00F4      		brsh .L49
 132:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 597               		.loc 1 132 29 is_stmt 1 view .LVU124
 132:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 598               		.loc 1 132 33 is_stmt 0 view .LVU125
 599 013a 9F70      		andi r25,lo8(15)
 600               	.LVL34:
 132:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 601               		.loc 1 132 32 view .LVU126
 602 013c 01F0      		breq .L50
 132:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 603               		.loc 1 132 68 discriminator 1 view .LVU127
 604 013e F801      		movw r30,r16
 605 0140 9581      		ldd r25,Z+5
 606 0142 907F      		andi r25,lo8(-16)
 132:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 607               		.loc 1 132 49 discriminator 1 view .LVU128
 608 0144 01F4      		brne .L50
 609               	.LVL35:
 610               	.L73:
 127:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 611               		.loc 1 127 77 view .LVU129
 612 0146 D12C      		mov r13,__zero_reg__
 613 0148 00C0      		rjmp .L48
 614               	.LVL36:
 615               	.L45:
 127:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 616               		.loc 1 127 77 view .LVU130
 617               	.LBE36:
 618               	.LBB37:
 619               	.LBB34:
 335:./tmk_core/common/action_tapping.c ****             return true;
 620               		.loc 1 335 9 is_stmt 1 view .LVU131
 335:./tmk_core/common/action_tapping.c ****             return true;
 621               		.loc 1 335 13 is_stmt 0 view .LVU132
 622 014a 90E0      		ldi r25,0
 623 014c 389F      		mul r19,r24
 624 014e F001      		movw r30,r0
 625 0150 399F      		mul r19,r25
 626 0152 F00D      		add r31,r0
 627 0154 1124      		clr __zero_reg__
 628 0156 E050      		subi r30,lo8(-(waiting_buffer))
 629 0158 F040      		sbci r31,hi8(-(waiting_buffer))
 335:./tmk_core/common/action_tapping.c ****             return true;
 630               		.loc 1 335 12 view .LVU133
 631 015a 6181      		ldd r22,Z+1
 632 015c 6513      		cpse r22,r21
 633 015e 00C0      		rjmp .L44
 335:./tmk_core/common/action_tapping.c ****             return true;
 634               		.loc 1 335 13 view .LVU134
 635 0160 6081      		ld r22,Z
 636 0162 6413      		cpse r22,r20
 637 0164 00C0      		rjmp .L44
 335:./tmk_core/common/action_tapping.c ****             return true;
 638               		.loc 1 335 59 view .LVU135
 639 0166 6281      		ldd r22,Z+2
 640 0168 E612      		cpse r14,r22
 641 016a 00C0      		rjmp .L42
 642               	.L44:
 334:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 643               		.loc 1 334 76 view .LVU136
 644 016c 0196      		adiw r24,1
 645               	.LVL37:
 334:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 646               		.loc 1 334 71 view .LVU137
 647 016e 8770      		andi r24,lo8(7)
 334:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 648               		.loc 1 334 71 view .LVU138
 649 0170 00C0      		rjmp .L43
 650               	.LVL38:
 651               	.L67:
 334:./tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 652               		.loc 1 334 71 view .LVU139
 653               	.LBE34:
 654               	.LBE37:
 655               	.LBB38:
 127:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 656               		.loc 1 127 29 is_stmt 1 view .LVU140
 127:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 657               		.loc 1 127 33 is_stmt 0 view .LVU141
 658 0172 9F70      		andi r25,lo8(15)
 659               	.LVL39:
 127:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 660               		.loc 1 127 32 view .LVU142
 661 0174 01F0      		breq .L50
 127:./tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 662               		.loc 1 127 49 discriminator 1 view .LVU143
 663 0176 8823      		tst r24
 664 0178 01F0      		breq .L73
 665               	.L50:
 133:./tmk_core/common/action_tapping.c ****                             break;
 666               		.loc 1 133 29 is_stmt 1 view .LVU144
 133:./tmk_core/common/action_tapping.c ****                             break;
 667               		.loc 1 133 33 is_stmt 0 view .LVU145
 668 017a 805E      		subi r24,lo8(-(32))
 669               	.LVL40:
 133:./tmk_core/common/action_tapping.c ****                             break;
 670               		.loc 1 133 32 view .LVU146
 671 017c 8830      		cpi r24,lo8(8)
 672 017e 00F0      		brlo .L73
 673               	.LVL41:
 674               	.L49:
 137:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 675               		.loc 1 137 86 is_stmt 1 view .LVU147
 138:./tmk_core/common/action_tapping.c ****                     return true;
 676               		.loc 1 138 21 view .LVU148
 677 0180 C801      		movw r24,r16
 678               	.LVL42:
 138:./tmk_core/common/action_tapping.c ****                     return true;
 679               		.loc 1 138 21 is_stmt 0 view .LVU149
 680 0182 0E94 0000 		call process_record
 681               	.LVL43:
 139:./tmk_core/common/action_tapping.c ****                 }
 682               		.loc 1 139 21 is_stmt 1 view .LVU150
 683               	.L48:
 139:./tmk_core/common/action_tapping.c ****                 }
 684               		.loc 1 139 21 is_stmt 0 view .LVU151
 685 0186 FD2C      		mov r15,r13
 686 0188 00C0      		rjmp .L29
 687               	.LVL44:
 688               	.L42:
 139:./tmk_core/common/action_tapping.c ****                 }
 689               		.loc 1 139 21 view .LVU152
 690               	.LBE38:
 143:./tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 691               		.loc 1 143 21 is_stmt 1 view .LVU153
 143:./tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 692               		.loc 1 143 24 is_stmt 0 view .LVU154
 693 018a EE20      		tst r14
 694 018c 01F4      		brne .+2
 695 018e 00C0      		rjmp .L29
 144:./tmk_core/common/action_tapping.c ****                     }
 696               		.loc 1 144 25 is_stmt 1 view .LVU155
 144:./tmk_core/common/action_tapping.c ****                     }
 697               		.loc 1 144 53 is_stmt 0 view .LVU156
 698 0190 8091 0000 		lds r24,tapping_key+5
 699 0194 8160      		ori r24,lo8(1<<0)
 700 0196 8093 0000 		sts tapping_key+5,r24
 147:./tmk_core/common/action_tapping.c ****                 }
 701               		.loc 1 147 28 view .LVU157
 702 019a F12C      		mov r15,__zero_reg__
 703 019c 00C0      		rjmp .L29
 704               	.LVL45:
 705               	.L37:
 152:./tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 706               		.loc 1 152 17 is_stmt 1 discriminator 1 view .LVU158
 152:./tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 707               		.loc 1 152 21 is_stmt 0 discriminator 1 view .LVU159
 708 019e 3513      		cpse r19,r21
 709 01a0 00C0      		rjmp .L51
 152:./tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 710               		.loc 1 152 21 discriminator 2 view .LVU160
 711 01a2 2413      		cpse r18,r20
 712 01a4 00C0      		rjmp .L51
 154:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 713               		.loc 1 154 31 discriminator 3 view .LVU161
 714 01a6 D801      		movw r26,r16
 152:./tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 715               		.loc 1 152 47 discriminator 3 view .LVU162
 716 01a8 EE20      		tst r14
 717 01aa 01F4      		brne .+2
 718 01ac 00C0      		rjmp .L130
 719               	.L51:
 160:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 720               		.loc 1 160 22 is_stmt 1 view .LVU163
 160:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 721               		.loc 1 160 26 is_stmt 0 view .LVU164
 722 01ae 4D87      		std Y+13,r20
 723 01b0 5E87      		std Y+14,r21
 724 01b2 8D85      		ldd r24,Y+13
 725 01b4 9E85      		ldd r25,Y+14
 726 01b6 0E94 0000 		call is_tap_key
 727               	.LVL46:
 160:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 728               		.loc 1 160 25 view .LVU165
 729 01ba 8823      		tst r24
 730 01bc 01F0      		breq .L63
 160:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 731               		.loc 1 160 48 discriminator 1 view .LVU166
 732 01be EE20      		tst r14
 733 01c0 01F0      		breq .L63
 161:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 734               		.loc 1 161 21 is_stmt 1 view .LVU167
 161:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 735               		.loc 1 161 40 is_stmt 0 view .LVU168
 736 01c2 8091 0000 		lds r24,tapping_key+5
 161:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 737               		.loc 1 161 24 view .LVU169
 738 01c6 8032      		cpi r24,lo8(32)
 739 01c8 00F0      		brlo .L54
 162:./tmk_core/common/action_tapping.c ****                         // unregister key
 740               		.loc 1 162 87 is_stmt 1 view .LVU170
 164:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 741               		.loc 1 164 25 view .LVU171
 164:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 742               		.loc 1 164 54 is_stmt 0 view .LVU172
 743 01ca 2091 0000 		lds r18,tapping_key
 744 01ce 3091 0000 		lds r19,tapping_key+1
 745 01d2 3887      		std Y+8,r19
 746 01d4 2F83      		std Y+7,r18
 747 01d6 1986      		std Y+9,__zero_reg__
 748 01d8 DB86      		std Y+11,r13
 749 01da CA86      		std Y+10,r12
 750 01dc 8C87      		std Y+12,r24
 164:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 751               		.loc 1 164 25 view .LVU173
 752 01de CE01      		movw r24,r28
 753 01e0 0796      		adiw r24,7
 754               	.L124:
 164:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 755               		.loc 1 164 25 view .LVU174
 756 01e2 0E94 0000 		call process_record
 757               	.LVL47:
 758               	.L54:
 171:./tmk_core/common/action_tapping.c ****                     }
 759               		.loc 1 171 69 is_stmt 1 view .LVU175
 173:./tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 760               		.loc 1 173 21 view .LVU176
 173:./tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 761               		.loc 1 173 33 is_stmt 0 view .LVU177
 762 01e6 86E0      		ldi r24,lo8(6)
 763 01e8 F801      		movw r30,r16
 764 01ea A0E0      		ldi r26,lo8(tapping_key)
 765 01ec B0E0      		ldi r27,hi8(tapping_key)
 766               		0:
 767 01ee 0190      		ld r0,Z+
 768 01f0 0D92      		st X+,r0
 769 01f2 8A95      		dec r24
 770 01f4 01F4      		brne 0b
 174:./tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 771               		.loc 1 174 21 is_stmt 1 view .LVU178
 772 01f6 0E94 0000 		call waiting_buffer_scan_tap
 773               	.LVL48:
 175:./tmk_core/common/action_tapping.c ****                     return true;
 774               		.loc 1 175 21 view .LVU179
 775 01fa 0E94 0000 		call debug_tapping_key
 776               	.LVL49:
 176:./tmk_core/common/action_tapping.c ****                 }
 777               		.loc 1 176 21 view .LVU180
 778               	.L127:
 183:./tmk_core/common/action_tapping.c ****                 }
 779               		.loc 1 183 21 view .LVU181
 183:./tmk_core/common/action_tapping.c ****                 }
 780               		.loc 1 183 28 is_stmt 0 view .LVU182
 781 01fe FF24      		clr r15
 782 0200 F394      		inc r15
 783 0202 00C0      		rjmp .L29
 784               	.L63:
 179:./tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last tap(>0).\n");
 785               		.loc 1 179 21 is_stmt 1 view .LVU183
 180:./tmk_core/common/action_tapping.c ****                     }
 786               		.loc 1 180 74 view .LVU184
 182:./tmk_core/common/action_tapping.c ****                     return true;
 787               		.loc 1 182 21 view .LVU185
 788 0204 C801      		movw r24,r16
 789 0206 0E94 0000 		call process_record
 790               	.LVL50:
 791 020a 00C0      		rjmp .L127
 792               	.LVL51:
 793               	.L36:
 189:./tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 794               		.loc 1 189 13 view .LVU186
 189:./tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 795               		.loc 1 189 16 is_stmt 0 view .LVU187
 796 020c 9111      		cpse r25,__zero_reg__
 797 020e 00C0      		rjmp .L55
 190:./tmk_core/common/action_tapping.c ****                 debug_event(event); debug("\n");
 798               		.loc 1 190 61 is_stmt 1 view .LVU188
 191:./tmk_core/common/action_tapping.c ****                 process_record(&tapping_key);
 799               		.loc 1 191 17 view .LVU189
 191:./tmk_core/common/action_tapping.c ****                 process_record(&tapping_key);
 800               		.loc 1 191 17 is_stmt 0 view .LVU190
 801 0210 7C2D      		mov r23,r12
 802 0212 D98A      		std Y+17,r13
 803 0214 C88A      		std Y+16,r12
 804 0216 6E2D      		mov r22,r14
 805 0218 8989      		ldd r24,Y+17
 806 021a 0E94 0000 		call debug_event
 807               	.LVL52:
 191:./tmk_core/common/action_tapping.c ****                 process_record(&tapping_key);
 808               		.loc 1 191 48 is_stmt 1 view .LVU191
 192:./tmk_core/common/action_tapping.c ****                 tapping_key = (keyrecord_t){};
 809               		.loc 1 192 17 view .LVU192
 810 021e 80E0      		ldi r24,lo8(tapping_key)
 811 0220 90E0      		ldi r25,hi8(tapping_key)
 812 0222 0E94 0000 		call process_record
 813               	.LVL53:
 193:./tmk_core/common/action_tapping.c ****                 debug_tapping_key();
 814               		.loc 1 193 17 view .LVU193
 815               	.L131:
 273:./tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 816               		.loc 1 273 44 view .LVU194
 274:./tmk_core/common/action_tapping.c ****             debug_tapping_key();
 817               		.loc 1 274 13 view .LVU195
 274:./tmk_core/common/action_tapping.c ****             debug_tapping_key();
 818               		.loc 1 274 25 is_stmt 0 view .LVU196
 819 0226 86E0      		ldi r24,lo8(6)
 820 0228 E0E0      		ldi r30,lo8(tapping_key)
 821 022a F0E0      		ldi r31,hi8(tapping_key)
 822 022c DF01      		movw r26,r30
 823               		0:
 824 022e 1D92      		st X+,__zero_reg__
 825 0230 8A95      		dec r24
 826 0232 01F4      		brne 0b
 275:./tmk_core/common/action_tapping.c ****             return false;
 827               		.loc 1 275 13 is_stmt 1 view .LVU197
 828 0234 00C0      		rjmp .L126
 829               	.LVL54:
 830               	.L55:
 197:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 831               		.loc 1 197 17 discriminator 1 view .LVU198
 197:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 832               		.loc 1 197 21 is_stmt 0 discriminator 1 view .LVU199
 833 0236 3513      		cpse r19,r21
 834 0238 00C0      		rjmp .L56
 197:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 835               		.loc 1 197 21 discriminator 2 view .LVU200
 836 023a 2413      		cpse r18,r20
 837 023c 00C0      		rjmp .L56
 197:./tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 838               		.loc 1 197 47 discriminator 3 view .LVU201
 839 023e E110      		cpse r14,__zero_reg__
 840 0240 00C0      		rjmp .L56
 198:./tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 841               		.loc 1 198 73 is_stmt 1 view .LVU202
 199:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 842               		.loc 1 199 21 view .LVU203
 199:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 843               		.loc 1 199 31 is_stmt 0 view .LVU204
 844 0242 F801      		movw r30,r16
 845 0244 8583      		std Z+5,r24
 200:./tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 846               		.loc 1 200 21 is_stmt 1 view .LVU205
 847 0246 C801      		movw r24,r16
 848 0248 0E94 0000 		call process_record
 849               	.LVL55:
 201:./tmk_core/common/action_tapping.c ****                     return true;
 850               		.loc 1 201 21 view .LVU206
 201:./tmk_core/common/action_tapping.c ****                     return true;
 851               		.loc 1 201 33 is_stmt 0 view .LVU207
 852 024c E0E0      		ldi r30,lo8(tapping_key)
 853 024e F0E0      		ldi r31,hi8(tapping_key)
 854 0250 86E0      		ldi r24,lo8(6)
 855 0252 DF01      		movw r26,r30
 856               		0:
 857 0254 1D92      		st X+,__zero_reg__
 858 0256 8A95      		dec r24
 859 0258 01F4      		brne 0b
 202:./tmk_core/common/action_tapping.c ****                 }
 860               		.loc 1 202 21 is_stmt 1 view .LVU208
 202:./tmk_core/common/action_tapping.c ****                 }
 861               		.loc 1 202 28 is_stmt 0 view .LVU209
 862 025a FB2C      		mov r15,r11
 863 025c 00C0      		rjmp .L29
 864               	.LVL56:
 865               	.L56:
 204:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 866               		.loc 1 204 22 is_stmt 1 view .LVU210
 204:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 867               		.loc 1 204 26 is_stmt 0 view .LVU211
 868 025e 4D87      		std Y+13,r20
 869 0260 5E87      		std Y+14,r21
 870 0262 8D85      		ldd r24,Y+13
 871 0264 9E85      		ldd r25,Y+14
 872 0266 0E94 0000 		call is_tap_key
 873               	.LVL57:
 204:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 874               		.loc 1 204 25 view .LVU212
 875 026a 8823      		tst r24
 876 026c 01F0      		breq .L63
 204:./tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 877               		.loc 1 204 48 discriminator 1 view .LVU213
 878 026e EE20      		tst r14
 879 0270 01F0      		breq .L63
 205:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last timeout tap(>1).\n");
 880               		.loc 1 205 21 is_stmt 1 view .LVU214
 205:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last timeout tap(>1).\n");
 881               		.loc 1 205 40 is_stmt 0 view .LVU215
 882 0272 8091 0000 		lds r24,tapping_key+5
 205:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last timeout tap(>1).\n");
 883               		.loc 1 205 24 view .LVU216
 884 0276 8032      		cpi r24,lo8(32)
 885 0278 00F4      		brsh .+2
 886 027a 00C0      		rjmp .L54
 206:./tmk_core/common/action_tapping.c ****                         // unregister key
 887               		.loc 1 206 95 is_stmt 1 view .LVU217
 208:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 888               		.loc 1 208 25 view .LVU218
 208:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 889               		.loc 1 208 54 is_stmt 0 view .LVU219
 890 027c 2091 0000 		lds r18,tapping_key
 891 0280 3091 0000 		lds r19,tapping_key+1
 892 0284 3A83      		std Y+2,r19
 893 0286 2983      		std Y+1,r18
 894 0288 1B82      		std Y+3,__zero_reg__
 895 028a DD82      		std Y+5,r13
 896 028c CC82      		std Y+4,r12
 897 028e 8E83      		std Y+6,r24
 208:./tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 898               		.loc 1 208 25 view .LVU220
 899 0290 CE01      		movw r24,r28
 900 0292 0196      		adiw r24,1
 901 0294 00C0      		rjmp .L124
 902               	.LVL58:
 903               	.L31:
 231:./tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 904               		.loc 1 231 12 is_stmt 1 discriminator 1 view .LVU221
 232:./tmk_core/common/action_tapping.c ****             if (event.pressed) {
 905               		.loc 1 232 9 discriminator 1 view .LVU222
 232:./tmk_core/common/action_tapping.c ****             if (event.pressed) {
 906               		.loc 1 232 13 is_stmt 0 discriminator 1 view .LVU223
 907 0296 C816      		cp r12,r24
 908 0298 D906      		cpc r13,r25
 909 029a 00F0      		brlo .L58
 910 029c F601      		movw r30,r12
 911 029e E81B      		sub r30,r24
 912 02a0 F90B      		sbc r31,r25
 913 02a2 CF01      		movw r24,r30
 914               	.L129:
 232:./tmk_core/common/action_tapping.c ****             if (event.pressed) {
 915               		.loc 1 232 13 discriminator 2 view .LVU224
 916 02a4 F12C      		mov r15,__zero_reg__
 917 02a6 883C      		cpi r24,-56
 918 02a8 9105      		cpc r25,__zero_reg__
 919 02aa 00F0      		brlo .+2
 920 02ac 00C0      		rjmp .L62
 233:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 921               		.loc 1 233 13 is_stmt 1 view .LVU225
 233:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 922               		.loc 1 233 22 is_stmt 0 view .LVU226
 923 02ae FE2C      		mov r15,r14
 233:./tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 924               		.loc 1 233 16 view .LVU227
 925 02b0 EE20      		tst r14
 926 02b2 01F4      		brne .+2
 927 02b4 00C0      		rjmp .L63
 234:./tmk_core/common/action_tapping.c **** #ifndef TAPPING_FORCE_HOLD
 928               		.loc 1 234 17 is_stmt 1 discriminator 1 view .LVU228
 234:./tmk_core/common/action_tapping.c **** #ifndef TAPPING_FORCE_HOLD
 929               		.loc 1 234 21 is_stmt 0 discriminator 1 view .LVU229
 930 02b6 3513      		cpse r19,r21
 931 02b8 00C0      		rjmp .L64
 234:./tmk_core/common/action_tapping.c **** #ifndef TAPPING_FORCE_HOLD
 932               		.loc 1 234 21 discriminator 2 view .LVU230
 933 02ba 2413      		cpse r18,r20
 934 02bc 00C0      		rjmp .L64
 236:./tmk_core/common/action_tapping.c ****                         // sequential tap.
 935               		.loc 1 236 21 is_stmt 1 view .LVU231
 236:./tmk_core/common/action_tapping.c ****                         // sequential tap.
 936               		.loc 1 236 41 is_stmt 0 view .LVU232
 937 02be 8091 0000 		lds r24,tapping_key+5
 236:./tmk_core/common/action_tapping.c ****                         // sequential tap.
 938               		.loc 1 236 24 view .LVU233
 939 02c2 80FD      		sbrc r24,0
 940 02c4 00C0      		rjmp .L65
 236:./tmk_core/common/action_tapping.c ****                         // sequential tap.
 941               		.loc 1 236 79 discriminator 1 view .LVU234
 942 02c6 982F      		mov r25,r24
 943 02c8 907F      		andi r25,lo8(-16)
 236:./tmk_core/common/action_tapping.c ****                         // sequential tap.
 944               		.loc 1 236 54 discriminator 1 view .LVU235
 945 02ca 01F0      		breq .L65
 238:./tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 946               		.loc 1 238 25 is_stmt 1 view .LVU236
 238:./tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 947               		.loc 1 238 35 is_stmt 0 view .LVU237
 948 02cc D801      		movw r26,r16
 949 02ce 1596      		adiw r26,5
 950 02d0 8C93      		st X,r24
 951 02d2 1597      		sbiw r26,5
 239:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 952               		.loc 1 239 25 is_stmt 1 view .LVU238
 239:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 953               		.loc 1 239 28 is_stmt 0 view .LVU239
 954 02d4 903F      		cpi r25,lo8(-16)
 955 02d6 01F0      		breq .L66
 239:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 956               		.loc 1 239 51 is_stmt 1 discriminator 1 view .LVU240
 239:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 957               		.loc 1 239 67 is_stmt 0 discriminator 1 view .LVU241
 958 02d8 982F      		mov r25,r24
 959 02da 907F      		andi r25,lo8(-16)
 960 02dc 905F      		subi r25,lo8(-(16))
 961 02de 8F70      		andi r24,lo8(15)
 962 02e0 892B      		or r24,r25
 963               	.L130:
 239:./tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 964               		.loc 1 239 67 discriminator 1 view .LVU242
 965 02e2 1596      		adiw r26,5
 966 02e4 8C93      		st X,r24
 967               	.L66:
 240:./tmk_core/common/action_tapping.c ****                         process_record(keyp);
 968               		.loc 1 240 53 is_stmt 1 view .LVU243
 240:./tmk_core/common/action_tapping.c ****                         process_record(keyp);
 969               		.loc 1 240 81 view .LVU244
 240:./tmk_core/common/action_tapping.c ****                         process_record(keyp);
 970               		.loc 1 240 95 view .LVU245
 241:./tmk_core/common/action_tapping.c ****                         tapping_key = *keyp;
 971               		.loc 1 241 25 view .LVU246
 972 02e6 C801      		movw r24,r16
 973 02e8 0E94 0000 		call process_record
 974               	.LVL59:
 242:./tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 975               		.loc 1 242 25 view .LVU247
 242:./tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 976               		.loc 1 242 37 is_stmt 0 view .LVU248
 977 02ec 86E0      		ldi r24,lo8(6)
 978 02ee F801      		movw r30,r16
 979 02f0 A0E0      		ldi r26,lo8(tapping_key)
 980 02f2 B0E0      		ldi r27,hi8(tapping_key)
 981               		0:
 982 02f4 0190      		ld r0,Z+
 983 02f6 0D92      		st X+,r0
 984 02f8 8A95      		dec r24
 985 02fa 01F4      		brne 0b
 243:./tmk_core/common/action_tapping.c ****                         return true;
 986               		.loc 1 243 25 is_stmt 1 view .LVU249
 987               	.LVL60:
 988               	.L126:
 286:./tmk_core/common/action_tapping.c ****             return true;
 989               		.loc 1 286 13 view .LVU250
 990 02fc 0E94 0000 		call debug_tapping_key
 991               	.LVL61:
 287:./tmk_core/common/action_tapping.c ****         } else {
 992               		.loc 1 287 13 view .LVU251
 287:./tmk_core/common/action_tapping.c ****         } else {
 993               		.loc 1 287 20 is_stmt 0 view .LVU252
 994 0300 00C0      		rjmp .L29
 995               	.LVL62:
 996               	.L58:
 232:./tmk_core/common/action_tapping.c ****             if (event.pressed) {
 997               		.loc 1 232 13 discriminator 2 view .LVU253
 998 0302 8095      		com r24
 999 0304 9095      		com r25
 1000 0306 8C0D      		add r24,r12
 1001 0308 9D1D      		adc r25,r13
 1002 030a 00C0      		rjmp .L129
 1003               	.L65:
 248:./tmk_core/common/action_tapping.c ****                     return true;
 1004               		.loc 1 248 21 is_stmt 1 view .LVU254
 248:./tmk_core/common/action_tapping.c ****                     return true;
 1005               		.loc 1 248 33 is_stmt 0 view .LVU255
 1006 030c 86E0      		ldi r24,lo8(6)
 1007 030e F801      		movw r30,r16
 1008 0310 A0E0      		ldi r26,lo8(tapping_key)
 1009 0312 B0E0      		ldi r27,hi8(tapping_key)
 1010               		0:
 1011 0314 0190      		ld r0,Z+
 1012 0316 0D92      		st X+,r0
 1013 0318 8A95      		dec r24
 1014 031a 01F4      		brne 0b
 249:./tmk_core/common/action_tapping.c ****                 } else if (is_tap_key(event.key)) {
 1015               		.loc 1 249 21 is_stmt 1 view .LVU256
 249:./tmk_core/common/action_tapping.c ****                 } else if (is_tap_key(event.key)) {
 1016               		.loc 1 249 28 is_stmt 0 view .LVU257
 1017 031c 00C0      		rjmp .L29
 1018               	.L64:
 250:./tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 1019               		.loc 1 250 24 is_stmt 1 view .LVU258
 250:./tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 1020               		.loc 1 250 28 is_stmt 0 view .LVU259
 1021 031e 4D87      		std Y+13,r20
 1022 0320 5E87      		std Y+14,r21
 1023 0322 8D85      		ldd r24,Y+13
 1024 0324 9E85      		ldd r25,Y+14
 1025 0326 0E94 0000 		call is_tap_key
 1026               	.LVL63:
 250:./tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 1027               		.loc 1 250 27 view .LVU260
 1028 032a 8111      		cpse r24,__zero_reg__
 1029 032c 00C0      		rjmp .L54
 260:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 1030               		.loc 1 260 21 is_stmt 1 view .LVU261
 260:./tmk_core/common/action_tapping.c ****                     process_record(keyp);
 1031               		.loc 1 260 49 is_stmt 0 view .LVU262
 1032 032e 8091 0000 		lds r24,tapping_key+5
 1033 0332 8160      		ori r24,lo8(1<<0)
 1034 0334 8093 0000 		sts tapping_key+5,r24
 261:./tmk_core/common/action_tapping.c ****                     return true;
 1035               		.loc 1 261 21 is_stmt 1 view .LVU263
 1036 0338 C801      		movw r24,r16
 1037 033a 0E94 0000 		call process_record
 1038               	.LVL64:
 262:./tmk_core/common/action_tapping.c ****                 }
 1039               		.loc 1 262 21 view .LVU264
 262:./tmk_core/common/action_tapping.c ****                 }
 1040               		.loc 1 262 28 is_stmt 0 view .LVU265
 1041 033e 00C0      		rjmp .L29
 1042               	.LVL65:
 1043               	.L62:
 272:./tmk_core/common/action_tapping.c ****             debug_event(event); debug("\n");
 1044               		.loc 1 272 70 is_stmt 1 view .LVU266
 273:./tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 1045               		.loc 1 273 13 view .LVU267
 273:./tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 1046               		.loc 1 273 13 is_stmt 0 view .LVU268
 1047 0340 7C2D      		mov r23,r12
 1048 0342 D98A      		std Y+17,r13
 1049 0344 C88A      		std Y+16,r12
 1050 0346 6E2D      		mov r22,r14
 1051 0348 8989      		ldd r24,Y+17
 1052 034a 0E94 0000 		call debug_event
 1053               	.LVL66:
 273:./tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 1054               		.loc 1 273 13 view .LVU269
 1055 034e 00C0      		rjmp .L131
 1056               	.LVL67:
 1057               	.L30:
 281:./tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1058               		.loc 1 281 9 is_stmt 1 view .LVU270
 281:./tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1059               		.loc 1 281 12 is_stmt 0 view .LVU271
 1060 0350 EE20      		tst r14
 1061 0352 01F4      		brne .+2
 1062 0354 00C0      		rjmp .L63
 281:./tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1063               		.loc 1 281 30 discriminator 1 view .LVU272
 1064 0356 4D87      		std Y+13,r20
 1065 0358 5E87      		std Y+14,r21
 1066 035a 8D85      		ldd r24,Y+13
 1067 035c 9E85      		ldd r25,Y+14
 1068 035e 0E94 0000 		call is_tap_key
 1069               	.LVL68:
 281:./tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1070               		.loc 1 281 30 discriminator 1 view .LVU273
 1071 0362 F82E      		mov r15,r24
 281:./tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1072               		.loc 1 281 27 discriminator 1 view .LVU274
 1073 0364 8823      		tst r24
 1074 0366 01F4      		brne .+2
 1075 0368 00C0      		rjmp .L63
 282:./tmk_core/common/action_tapping.c ****             tapping_key = *keyp;
 1076               		.loc 1 282 54 is_stmt 1 view .LVU275
 283:./tmk_core/common/action_tapping.c ****             process_record_tap_hint(&tapping_key);
 1077               		.loc 1 283 13 view .LVU276
 283:./tmk_core/common/action_tapping.c ****             process_record_tap_hint(&tapping_key);
 1078               		.loc 1 283 25 is_stmt 0 view .LVU277
 1079 036a 86E0      		ldi r24,lo8(6)
 1080 036c F801      		movw r30,r16
 1081 036e A0E0      		ldi r26,lo8(tapping_key)
 1082 0370 B0E0      		ldi r27,hi8(tapping_key)
 1083               		0:
 1084 0372 0190      		ld r0,Z+
 1085 0374 0D92      		st X+,r0
 1086 0376 8A95      		dec r24
 1087 0378 01F4      		brne 0b
 284:./tmk_core/common/action_tapping.c ****             waiting_buffer_scan_tap();
 1088               		.loc 1 284 13 is_stmt 1 view .LVU278
 1089 037a 80E0      		ldi r24,lo8(tapping_key)
 1090 037c 90E0      		ldi r25,hi8(tapping_key)
 1091 037e 0E94 0000 		call process_record_tap_hint
 1092               	.LVL69:
 285:./tmk_core/common/action_tapping.c ****             debug_tapping_key();
 1093               		.loc 1 285 13 view .LVU279
 1094 0382 0E94 0000 		call waiting_buffer_scan_tap
 1095               	.LVL70:
 1096 0386 00C0      		rjmp .L126
 1097               	.LVL71:
 1098               	.L41:
 1099               	.LBB39:
 1100               	.LBB31:
 1101               		.loc 2 51 79 is_stmt 0 view .LVU280
 1102 0388 81E0      		ldi r24,lo8(1)
 1103 038a 8E25      		eor r24,r14
 1104 038c 00C0      		rjmp .L40
 1105               	.LBE31:
 1106               	.LBE39:
 1107               		.cfi_endproc
 1108               	.LFE5:
 1110               		.section	.text.action_tapping_process,"ax",@progbits
 1111               	.global	action_tapping_process
 1113               	action_tapping_process:
 1114               	.LFB4:
  44:./tmk_core/common/action_tapping.c ****     if (process_tapping(&record)) {
 1115               		.loc 1 44 1 is_stmt 1 view -0
 1116               		.cfi_startproc
 1117 0000 1F93      		push r17
 1118               	.LCFI17:
 1119               		.cfi_def_cfa_offset 3
 1120               		.cfi_offset 17, -2
 1121 0002 CF93      		push r28
 1122               	.LCFI18:
 1123               		.cfi_def_cfa_offset 4
 1124               		.cfi_offset 28, -3
 1125 0004 DF93      		push r29
 1126               	.LCFI19:
 1127               		.cfi_def_cfa_offset 5
 1128               		.cfi_offset 29, -4
 1129 0006 CDB7      		in r28,__SP_L__
 1130 0008 DEB7      		in r29,__SP_H__
 1131               	.LCFI20:
 1132               		.cfi_def_cfa_register 28
 1133 000a 2C97      		sbiw r28,12
 1134               	.LCFI21:
 1135               		.cfi_def_cfa_offset 17
 1136 000c 0FB6      		in __tmp_reg__,__SREG__
 1137 000e F894      		cli
 1138 0010 DEBF      		out __SP_H__,r29
 1139 0012 0FBE      		out __SREG__,__tmp_reg__
 1140 0014 CDBF      		out __SP_L__,r28
 1141               	/* prologue: function */
 1142               	/* frame size = 12 */
 1143               	/* stack size = 15 */
 1144               	.L__stack_usage = 15
 1145 0016 4F83      		std Y+7,r20
 1146 0018 5887      		std Y+8,r21
 1147 001a 6987      		std Y+9,r22
 1148 001c 7A87      		std Y+10,r23
 1149 001e 8B87      		std Y+11,r24
 1150 0020 9C87      		std Y+12,r25
  45:./tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1151               		.loc 1 45 5 view .LVU282
  45:./tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1152               		.loc 1 45 9 is_stmt 0 view .LVU283
 1153 0022 CE01      		movw r24,r28
 1154 0024 0796      		adiw r24,7
 1155 0026 0E94 0000 		call process_tapping
 1156               	.LVL72:
  45:./tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1157               		.loc 1 45 8 view .LVU284
 1158 002a 8823      		tst r24
 1159 002c 01F0      		breq .L133
  46:./tmk_core/common/action_tapping.c ****             debug("processed: "); debug_record(record); debug("\n");
 1160               		.loc 1 46 9 is_stmt 1 view .LVU285
 1161               	.LBB48:
 1162               	.LBI48:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1163               		.loc 2 49 20 view .LVU286
 1164               	.LBB49:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1165               		.loc 2 49 51 view .LVU287
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1166               		.loc 2 49 74 is_stmt 0 view .LVU288
 1167 002e 8A85      		ldd r24,Y+10
 1168 0030 9B85      		ldd r25,Y+11
 1169 0032 892B      		or r24,r25
 1170 0034 01F0      		breq .L134
 1171 0036 4F81      		ldd r20,Y+7
 1172 0038 5885      		ldd r21,Y+8
 1173 003a 842F      		mov r24,r20
 1174 003c 8523      		and r24,r21
 1175 003e 8F3F      		cpi r24,lo8(-1)
 1176 0040 01F0      		breq .+2
 1177 0042 00C0      		rjmp .L156
 1178               	.L134:
 1179               	.LBE49:
 1180               	.LBE48:
  64:./tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
 1181               		.loc 1 64 13 discriminator 1 view .LVU289
 1182 0044 16E0      		ldi r17,lo8(6)
 1183 0046 00C0      		rjmp .L141
 1184               	.L133:
  50:./tmk_core/common/action_tapping.c ****             // clear all in case of overflow.
 1185               		.loc 1 50 9 is_stmt 1 view .LVU290
 1186 0048 86E0      		ldi r24,lo8(6)
 1187 004a FE01      		movw r30,r28
 1188 004c 3796      		adiw r30,7
 1189 004e DE01      		movw r26,r28
 1190 0050 1196      		adiw r26,1
 1191               		0:
 1192 0052 0190      		ld r0,Z+
 1193 0054 0D92      		st X+,r0
 1194 0056 8A95      		dec r24
 1195 0058 01F4      		brne 0b
 1196               	.LVL73:
 1197               	.LBB50:
 1198               	.LBI50:
 300:./tmk_core/common/action_tapping.c **** {
 1199               		.loc 1 300 6 view .LVU291
 1200               	.LBB51:
 302:./tmk_core/common/action_tapping.c ****         return true;
 1201               		.loc 1 302 5 view .LVU292
 1202               	.LBB52:
 1203               	.LBI52:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1204               		.loc 2 49 20 view .LVU293
 1205               	.LBB53:
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1206               		.loc 2 49 51 view .LVU294
  49:./tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1207               		.loc 2 49 74 is_stmt 0 view .LVU295
 1208 005a 8A85      		ldd r24,Y+10
 1209 005c 9B85      		ldd r25,Y+11
 1210 005e 892B      		or r24,r25
 1211 0060 01F0      		breq .L134
 1212 0062 8885      		ldd r24,Y+8
 1213 0064 9F81      		ldd r25,Y+7
 1214 0066 8923      		and r24,r25
 1215 0068 8F3F      		cpi r24,lo8(-1)
 1216 006a 01F0      		breq .L134
 1217               	.LBE53:
 1218               	.LBE52:
 306:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1219               		.loc 1 306 5 is_stmt 1 view .LVU296
 306:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1220               		.loc 1 306 30 is_stmt 0 view .LVU297
 1221 006c 2091 0000 		lds r18,waiting_buffer_head
 1222 0070 30E0      		ldi r19,0
 1223 0072 C901      		movw r24,r18
 1224 0074 0196      		adiw r24,1
 306:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1225               		.loc 1 306 35 view .LVU298
 1226 0076 8770      		andi r24,7
 1227 0078 9927      		clr r25
 306:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1228               		.loc 1 306 57 view .LVU299
 1229 007a 4091 0000 		lds r20,waiting_buffer_tail
 306:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1230               		.loc 1 306 8 view .LVU300
 1231 007e 4817      		cp r20,r24
 1232 0080 1906      		cpc __zero_reg__,r25
 1233 0082 01F4      		brne .L158
 1234               	.LVL74:
 306:./tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1235               		.loc 1 306 8 view .LVU301
 1236               	.LBE51:
 1237               	.LBE50:
  52:./tmk_core/common/action_tapping.c ****             clear_keyboard();
 1238               		.loc 1 52 50 is_stmt 1 view .LVU302
  53:./tmk_core/common/action_tapping.c ****             waiting_buffer_clear();
 1239               		.loc 1 53 13 view .LVU303
 1240 0084 0E94 0000 		call clear_keyboard
 1241               	.LVL75:
  54:./tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 1242               		.loc 1 54 13 view .LVU304
 1243               	.LBB55:
 1244               	.LBI55:
 322:./tmk_core/common/action_tapping.c **** {
 1245               		.loc 1 322 6 view .LVU305
 1246               	.LBB56:
 324:./tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 1247               		.loc 1 324 5 view .LVU306
 324:./tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 1248               		.loc 1 324 25 is_stmt 0 view .LVU307
 1249 0088 1092 0000 		sts waiting_buffer_head,__zero_reg__
 325:./tmk_core/common/action_tapping.c **** }
 1250               		.loc 1 325 5 is_stmt 1 view .LVU308
 325:./tmk_core/common/action_tapping.c **** }
 1251               		.loc 1 325 25 is_stmt 0 view .LVU309
 1252 008c 1092 0000 		sts waiting_buffer_tail,__zero_reg__
 1253               	.LBE56:
 1254               	.LBE55:
  55:./tmk_core/common/action_tapping.c ****         }
 1255               		.loc 1 55 13 is_stmt 1 view .LVU310
  55:./tmk_core/common/action_tapping.c ****         }
 1256               		.loc 1 55 25 is_stmt 0 view .LVU311
 1257 0090 86E0      		ldi r24,lo8(6)
 1258 0092 E0E0      		ldi r30,lo8(tapping_key)
 1259 0094 F0E0      		ldi r31,hi8(tapping_key)
 1260 0096 DF01      		movw r26,r30
 1261               		0:
 1262 0098 1D92      		st X+,__zero_reg__
 1263 009a 8A95      		dec r24
 1264 009c 01F4      		brne 0b
 1265 009e 00C0      		rjmp .L134
 1266               	.LVL76:
 1267               	.L158:
 1268               	.LBB57:
 1269               	.LBB54:
 311:./tmk_core/common/action_tapping.c ****     waiting_buffer_head = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 1270               		.loc 1 311 5 is_stmt 1 view .LVU312
 311:./tmk_core/common/action_tapping.c ****     waiting_buffer_head = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 1271               		.loc 1 311 41 is_stmt 0 view .LVU313
 1272 00a0 96E0      		ldi r25,lo8(6)
 1273               	.LVL77:
 311:./tmk_core/common/action_tapping.c ****     waiting_buffer_head = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 1274               		.loc 1 311 41 view .LVU314
 1275 00a2 929F      		mul r25,r18
 1276 00a4 D001      		movw r26,r0
 1277 00a6 939F      		mul r25,r19
 1278 00a8 B00D      		add r27,r0
 1279 00aa 1124      		clr __zero_reg__
 1280 00ac A050      		subi r26,lo8(-(waiting_buffer))
 1281 00ae B040      		sbci r27,hi8(-(waiting_buffer))
 1282 00b0 FE01      		movw r30,r28
 1283 00b2 3196      		adiw r30,1
 1284               		0:
 1285 00b4 0190      		ld r0,Z+
 1286 00b6 0D92      		st X+,r0
 1287 00b8 9A95      		dec r25
 1288 00ba 01F4      		brne 0b
 312:./tmk_core/common/action_tapping.c **** 
 1289               		.loc 1 312 5 is_stmt 1 view .LVU315
 312:./tmk_core/common/action_tapping.c **** 
 1290               		.loc 1 312 25 is_stmt 0 view .LVU316
 1291 00bc 8093 0000 		sts waiting_buffer_head,r24
 314:./tmk_core/common/action_tapping.c ****     return true;
 1292               		.loc 1 314 34 is_stmt 1 view .LVU317
 314:./tmk_core/common/action_tapping.c ****     return true;
 1293               		.loc 1 314 36 view .LVU318
 1294 00c0 0E94 0000 		call debug_waiting_buffer
 1295               	.LVL78:
 315:./tmk_core/common/action_tapping.c **** }
 1296               		.loc 1 315 5 view .LVU319
 315:./tmk_core/common/action_tapping.c **** }
 1297               		.loc 1 315 5 is_stmt 0 view .LVU320
 1298 00c4 00C0      		rjmp .L134
 1299               	.L139:
 315:./tmk_core/common/action_tapping.c **** }
 1300               		.loc 1 315 5 view .LVU321
 1301               	.LBE54:
 1302               	.LBE57:
  64:./tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
 1303               		.loc 1 64 9 is_stmt 1 view .LVU322
  64:./tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
 1304               		.loc 1 64 13 is_stmt 0 view .LVU323
 1305 00c6 819F      		mul r24,r17
 1306 00c8 C001      		movw r24,r0
 1307 00ca 1124      		clr __zero_reg__
 1308 00cc 8050      		subi r24,lo8(-(waiting_buffer))
 1309 00ce 9040      		sbci r25,hi8(-(waiting_buffer))
 1310 00d0 0E94 0000 		call process_tapping
 1311               	.LVL79:
  64:./tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
 1312               		.loc 1 64 12 view .LVU324
 1313 00d4 8823      		tst r24
 1314 00d6 01F0      		breq .L132
  65:./tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
 1315               		.loc 1 65 48 is_stmt 1 view .LVU325
  65:./tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
 1316               		.loc 1 65 80 view .LVU326
  65:./tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
 1317               		.loc 1 65 95 view .LVU327
  66:./tmk_core/common/action_tapping.c ****         } else {
 1318               		.loc 1 66 13 view .LVU328
 1319 00d8 E091 0000 		lds r30,waiting_buffer_tail
 1320 00dc 1E9F      		mul r17,r30
 1321 00de F001      		movw r30,r0
 1322 00e0 1124      		clr __zero_reg__
 1323 00e2 E050      		subi r30,lo8(-(waiting_buffer))
 1324 00e4 F040      		sbci r31,hi8(-(waiting_buffer))
 1325 00e6 4081      		ld r20,Z
 1326 00e8 5181      		ldd r21,Z+1
 1327 00ea 6281      		ldd r22,Z+2
 1328 00ec 7381      		ldd r23,Z+3
 1329 00ee 8481      		ldd r24,Z+4
 1330 00f0 9581      		ldd r25,Z+5
 1331 00f2 0E94 0000 		call debug_record
 1332               	.LVL80:
  66:./tmk_core/common/action_tapping.c ****         } else {
 1333               		.loc 1 66 77 view .LVU329
  63:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1334               		.loc 1 63 99 is_stmt 0 view .LVU330
 1335 00f6 8091 0000 		lds r24,waiting_buffer_tail
 1336 00fa 90E0      		ldi r25,0
 1337 00fc 0196      		adiw r24,1
  63:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1338               		.loc 1 63 104 view .LVU331
 1339 00fe 8770      		andi r24,7
 1340 0100 9927      		clr r25
  63:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1341               		.loc 1 63 76 view .LVU332
 1342 0102 8093 0000 		sts waiting_buffer_tail,r24
 1343               	.L141:
  63:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1344               		.loc 1 63 32 discriminator 1 view .LVU333
 1345 0106 8091 0000 		lds r24,waiting_buffer_tail
  63:./tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1346               		.loc 1 63 5 discriminator 1 view .LVU334
 1347 010a 9091 0000 		lds r25,waiting_buffer_head
 1348 010e 8913      		cpse r24,r25
 1349 0110 00C0      		rjmp .L139
 1350               	.L132:
 1351               	/* epilogue start */
  74:./tmk_core/common/action_tapping.c **** 
 1352               		.loc 1 74 1 view .LVU335
 1353 0112 2C96      		adiw r28,12
 1354 0114 0FB6      		in __tmp_reg__,__SREG__
 1355 0116 F894      		cli
 1356 0118 DEBF      		out __SP_H__,r29
 1357 011a 0FBE      		out __SREG__,__tmp_reg__
 1358 011c CDBF      		out __SP_L__,r28
 1359 011e DF91      		pop r29
 1360 0120 CF91      		pop r28
 1361 0122 1F91      		pop r17
 1362 0124 0895      		ret
 1363               	.L156:
  47:./tmk_core/common/action_tapping.c ****         }
 1364               		.loc 1 47 33 is_stmt 1 view .LVU336
  47:./tmk_core/common/action_tapping.c ****         }
 1365               		.loc 1 47 35 view .LVU337
 1366 0126 6985      		ldd r22,Y+9
 1367 0128 7A85      		ldd r23,Y+10
 1368 012a 8B85      		ldd r24,Y+11
 1369 012c 9C85      		ldd r25,Y+12
 1370 012e 0E94 0000 		call debug_record
 1371               	.LVL81:
 1372 0132 00C0      		rjmp .L134
 1373               		.cfi_endproc
 1374               	.LFE4:
 1376               		.section	.bss.waiting_buffer_tail,"aw",@nobits
 1379               	waiting_buffer_tail:
 1380 0000 00        		.zero	1
 1381               		.section	.bss.waiting_buffer_head,"aw",@nobits
 1384               	waiting_buffer_head:
 1385 0000 00        		.zero	1
 1386               		.section	.bss.waiting_buffer,"aw",@nobits
 1389               	waiting_buffer:
 1390 0000 0000 0000 		.zero	48
 1390      0000 0000 
 1390      0000 0000 
 1390      0000 0000 
 1390      0000 0000 
 1391               		.section	.bss.tapping_key,"aw",@nobits
 1394               	tapping_key:
 1395 0000 0000 0000 		.zero	6
 1395      0000 
 1396               		.text
 1397               	.Letext0:
 1398               		.file 3 "/usr/local/Cellar/avr-gcc@8/8.3.0_1/avr/include/stdint.h"
 1399               		.file 4 "./tmk_core/common/keycode.h"
 1400               		.file 5 "./tmk_core/common/action_code.h"
 1401               		.file 6 "./tmk_core/common/action.h"
 1402               		.file 7 "./tmk_core/common/action_layer.h"
 1403               		.file 8 "./tmk_core/common/timer.h"
 1404               		.file 9 "./tmk_core/common/debug.h"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 action_tapping.c
/var/folders/3d/n9bt7hnj55x7z_fzmyrbdqym0000gp/T//ccl9Kgr5.s:2      *ABS*:000000000000003e __SP_H__
/var/folders/3d/n9bt7hnj55x7z_fzmyrbdqym0000gp/T//ccl9Kgr5.s:3      *ABS*:000000000000003d __SP_L__
/var/folders/3d/n9bt7hnj55x7z_fzmyrbdqym0000gp/T//ccl9Kgr5.s:4      *ABS*:000000000000003f __SREG__
/var/folders/3d/n9bt7hnj55x7z_fzmyrbdqym0000gp/T//ccl9Kgr5.s:5      *ABS*:0000000000000000 __tmp_reg__
/var/folders/3d/n9bt7hnj55x7z_fzmyrbdqym0000gp/T//ccl9Kgr5.s:6      *ABS*:0000000000000001 __zero_reg__
/var/folders/3d/n9bt7hnj55x7z_fzmyrbdqym0000gp/T//ccl9Kgr5.s:12     .text.debug_waiting_buffer:0000000000000000 debug_waiting_buffer
/var/folders/3d/n9bt7hnj55x7z_fzmyrbdqym0000gp/T//ccl9Kgr5.s:1379   .bss.waiting_buffer_tail:0000000000000000 waiting_buffer_tail
/var/folders/3d/n9bt7hnj55x7z_fzmyrbdqym0000gp/T//ccl9Kgr5.s:1384   .bss.waiting_buffer_head:0000000000000000 waiting_buffer_head
/var/folders/3d/n9bt7hnj55x7z_fzmyrbdqym0000gp/T//ccl9Kgr5.s:1389   .bss.waiting_buffer:0000000000000000 waiting_buffer
/var/folders/3d/n9bt7hnj55x7z_fzmyrbdqym0000gp/T//ccl9Kgr5.s:94     .text.debug_tapping_key:0000000000000000 debug_tapping_key
/var/folders/3d/n9bt7hnj55x7z_fzmyrbdqym0000gp/T//ccl9Kgr5.s:1394   .bss.tapping_key:0000000000000000 tapping_key
/var/folders/3d/n9bt7hnj55x7z_fzmyrbdqym0000gp/T//ccl9Kgr5.s:117    .text.waiting_buffer_scan_tap:0000000000000000 waiting_buffer_scan_tap
/var/folders/3d/n9bt7hnj55x7z_fzmyrbdqym0000gp/T//ccl9Kgr5.s:296    .text.process_tapping:0000000000000000 process_tapping
/var/folders/3d/n9bt7hnj55x7z_fzmyrbdqym0000gp/T//ccl9Kgr5.s:1113   .text.action_tapping_process:0000000000000000 action_tapping_process

UNDEFINED SYMBOLS
debug_record
process_record
layer_switch_get_action
is_tap_key
debug_event
process_record_tap_hint
clear_keyboard
__do_clear_bss
